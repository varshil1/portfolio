{"ast":null,"code":"/**\r\n * Copyright (C) 2010-2021 Graham Breach\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n * \r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n */\n/**\r\n * jQuery.tagcanvas 2.11\r\n * For more information, please contact <graham@goat1000.com>\r\n */\n(function ($) {\n  \"use strict\";\n\n  var i,\n    j,\n    abs = Math.abs,\n    sin = Math.sin,\n    cos = Math.cos,\n    max = Math.max,\n    min = Math.min,\n    ceil = Math.ceil,\n    sqrt = Math.sqrt,\n    pow = Math.pow,\n    hexlookup3 = {},\n    hexlookup2 = {},\n    hexlookup1 = {\n      0: \"0,\",\n      1: \"17,\",\n      2: \"34,\",\n      3: \"51,\",\n      4: \"68,\",\n      5: \"85,\",\n      6: \"102,\",\n      7: \"119,\",\n      8: \"136,\",\n      9: \"153,\",\n      a: \"170,\",\n      A: \"170,\",\n      b: \"187,\",\n      B: \"187,\",\n      c: \"204,\",\n      C: \"204,\",\n      d: \"221,\",\n      D: \"221,\",\n      e: \"238,\",\n      E: \"238,\",\n      f: \"255,\",\n      F: \"255,\"\n    },\n    Oproto,\n    Tproto,\n    TCproto,\n    Mproto,\n    Vproto,\n    TSproto,\n    TCVproto,\n    doc = document,\n    ocanvas,\n    audio,\n    audioClick,\n    handlers = {};\n  for (i = 0; i < 256; ++i) {\n    j = i.toString(16);\n    if (i < 16) j = '0' + j;\n    hexlookup2[j] = hexlookup2[j.toUpperCase()] = i.toString() + ',';\n  }\n  function Defined(d) {\n    return typeof d != 'undefined';\n  }\n  function IsObject(o) {\n    return typeof o == 'object' && o != null;\n  }\n  function Clamp(v, mn, mx) {\n    return isNaN(v) ? mx : min(mx, max(mn, v));\n  }\n  function Nop() {\n    return false;\n  }\n  function TimeNow() {\n    return new Date().valueOf();\n  }\n  function SortList(l, f) {\n    var nl = [],\n      tl = l.length,\n      i;\n    for (i = 0; i < tl; ++i) nl.push(l[i]);\n    nl.sort(f);\n    return nl;\n  }\n  function Shuffle(a) {\n    var i = a.length - 1,\n      t,\n      p;\n    while (i) {\n      p = ~~(Math.random() * i);\n      t = a[i];\n      a[i] = a[p];\n      a[p] = t;\n      --i;\n    }\n  }\n  function SetupAudio() {\n    var ac = window.AudioContext || window.webkitAudioContext;\n    audio = new ac();\n    if (!audio) {\n      audio = 'off';\n      return;\n    }\n    return audio;\n  }\n  function AudioIcon(mute, c, size, offsetx, offsety, stroke, colour) {\n    var x = offsetx,\n      y = offsety,\n      s = size * 0.01,\n      w = 80 * s,\n      h = 100 * s,\n      d = 40 * s,\n      e = 30 * s;\n    var f = e / 2;\n    var x2 = x + w,\n      x1 = x2 - d;\n    var y3 = y + h,\n      y2 = y3 - e,\n      y1 = y + e,\n      y4 = y + h / 2;\n    c.setTransform(1, 0, 0, 1, 0, 0);\n    c.setLineDash([]);\n    c.globalAlpha = 1;\n    c.strokeStyle = colour;\n    c.lineWidth = stroke;\n    c.lineJoin = 'round';\n    c.beginPath();\n    c.moveTo(x1, y1);\n    c.lineTo(x1, y2);\n    c.moveTo(x2, y3);\n    c.lineTo(x1, y2);\n    c.lineTo(x, y2);\n    c.lineTo(x, y1);\n    c.lineTo(x1, y1);\n    c.lineTo(x2, y);\n    if (mute) {\n      c.lineTo(x2, y1);\n      c.moveTo(x2, y2);\n      c.lineTo(x2, y3);\n      c.moveTo(x2 - f, y4 - f);\n      c.lineTo(x2 + f, y4 + f);\n      c.moveTo(x2 + f, y4 - f);\n      c.lineTo(x2 - f, y4 + f);\n      c.stroke();\n      return;\n    }\n    c.closePath();\n    c.stroke();\n  }\n  function Vector(x, y, z) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n  }\n  Vproto = Vector.prototype;\n  Vproto.length = function () {\n    return sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n  };\n  Vproto.dot = function (v) {\n    return this.x * v.x + this.y * v.y + this.z * v.z;\n  };\n  Vproto.cross = function (v) {\n    var x = this.y * v.z - this.z * v.y,\n      y = this.z * v.x - this.x * v.z,\n      z = this.x * v.y - this.y * v.x;\n    return new Vector(x, y, z);\n  };\n  Vproto.angle = function (v) {\n    var dot = this.dot(v),\n      ac;\n    if (dot == 0) return Math.PI / 2.0;\n    ac = dot / (this.length() * v.length());\n    if (ac >= 1) return 0;\n    if (ac <= -1) return Math.PI;\n    return Math.acos(ac);\n  };\n  Vproto.unit = function () {\n    var l = this.length();\n    return new Vector(this.x / l, this.y / l, this.z / l);\n  };\n  function MakeVector(lg, lt) {\n    lt = lt * Math.PI / 180;\n    lg = lg * Math.PI / 180;\n    var x = sin(lg) * cos(lt),\n      y = -sin(lt),\n      z = -cos(lg) * cos(lt);\n    return new Vector(x, y, z);\n  }\n  function Matrix(a) {\n    this[1] = {\n      1: a[0],\n      2: a[1],\n      3: a[2]\n    };\n    this[2] = {\n      1: a[3],\n      2: a[4],\n      3: a[5]\n    };\n    this[3] = {\n      1: a[6],\n      2: a[7],\n      3: a[8]\n    };\n  }\n  Mproto = Matrix.prototype;\n  Matrix.Identity = function () {\n    return new Matrix([1, 0, 0, 0, 1, 0, 0, 0, 1]);\n  };\n  Matrix.Rotation = function (angle, u) {\n    var sina = sin(angle),\n      cosa = cos(angle),\n      mcos = 1 - cosa;\n    return new Matrix([cosa + pow(u.x, 2) * mcos, u.x * u.y * mcos - u.z * sina, u.x * u.z * mcos + u.y * sina, u.y * u.x * mcos + u.z * sina, cosa + pow(u.y, 2) * mcos, u.y * u.z * mcos - u.x * sina, u.z * u.x * mcos - u.y * sina, u.z * u.y * mcos + u.x * sina, cosa + pow(u.z, 2) * mcos]);\n  };\n  Mproto.mul = function (m) {\n    var a = [],\n      i,\n      j,\n      mmatrix = m.xform ? 1 : 0;\n    for (i = 1; i <= 3; ++i) for (j = 1; j <= 3; ++j) {\n      if (mmatrix) a.push(this[i][1] * m[1][j] + this[i][2] * m[2][j] + this[i][3] * m[3][j]);else a.push(this[i][j] * m);\n    }\n    return new Matrix(a);\n  };\n  Mproto.xform = function (p) {\n    var a = {},\n      x = p.x,\n      y = p.y,\n      z = p.z;\n    a.x = x * this[1][1] + y * this[2][1] + z * this[3][1];\n    a.y = x * this[1][2] + y * this[2][2] + z * this[3][2];\n    a.z = x * this[1][3] + y * this[2][3] + z * this[3][3];\n    return a;\n  };\n  function PointsOnSphere(n, xr, yr, zr, magic) {\n    var i,\n      y,\n      r,\n      phi,\n      pts = [],\n      off = 2 / n,\n      inc;\n    inc = Math.PI * (3 - sqrt(5) + (parseFloat(magic) ? parseFloat(magic) : 0));\n    for (i = 0; i < n; ++i) {\n      y = i * off - 1 + off / 2;\n      r = sqrt(1 - y * y);\n      phi = i * inc;\n      pts.push([cos(phi) * r * xr, y * yr, sin(phi) * r * zr]);\n    }\n    return pts;\n  }\n  function Cylinder(n, o, xr, yr, zr, magic) {\n    var phi,\n      pts = [],\n      off = 2 / n,\n      inc,\n      i,\n      j,\n      k,\n      l;\n    inc = Math.PI * (3 - sqrt(5) + (parseFloat(magic) ? parseFloat(magic) : 0));\n    for (i = 0; i < n; ++i) {\n      j = i * off - 1 + off / 2;\n      phi = i * inc;\n      k = cos(phi);\n      l = sin(phi);\n      pts.push(o ? [j * xr, k * yr, l * zr] : [k * xr, j * yr, l * zr]);\n    }\n    return pts;\n  }\n  function Ring(o, n, xr, yr, zr, j) {\n    var phi,\n      pts = [],\n      inc = Math.PI * 2 / n,\n      i,\n      k,\n      l;\n    for (i = 0; i < n; ++i) {\n      phi = i * inc;\n      k = cos(phi);\n      l = sin(phi);\n      pts.push(o ? [j * xr, k * yr, l * zr] : [k * xr, j * yr, l * zr]);\n    }\n    return pts;\n  }\n  function PointsOnCylinderV(n, xr, yr, zr, m) {\n    return Cylinder(n, 0, xr, yr, zr, m);\n  }\n  function PointsOnCylinderH(n, xr, yr, zr, m) {\n    return Cylinder(n, 1, xr, yr, zr, m);\n  }\n  function PointsOnRingV(n, xr, yr, zr, offset) {\n    offset = isNaN(offset) ? 0 : offset * 1;\n    return Ring(0, n, xr, yr, zr, offset);\n  }\n  function PointsOnRingH(n, xr, yr, zr, offset) {\n    offset = isNaN(offset) ? 0 : offset * 1;\n    return Ring(1, n, xr, yr, zr, offset);\n  }\n  function CentreImage(t) {\n    var i = new Image();\n    i.onload = function () {\n      var dx = i.width / 2,\n        dy = i.height / 2;\n      t.centreFunc = function (c, w, h, cx, cy) {\n        c.setTransform(1, 0, 0, 1, 0, 0);\n        c.globalAlpha = 1;\n        c.drawImage(i, cx - dx, cy - dy);\n      };\n    };\n    i.src = t.centreImage;\n  }\n  function SetAlpha(c, a) {\n    var d = c,\n      p1,\n      p2,\n      ae = (a * 1).toPrecision(3) + ')';\n    if (c[0] === '#') {\n      if (!hexlookup3[c]) if (c.length === 4) hexlookup3[c] = 'rgba(' + hexlookup1[c[1]] + hexlookup1[c[2]] + hexlookup1[c[3]];else hexlookup3[c] = 'rgba(' + hexlookup2[c.substr(1, 2)] + hexlookup2[c.substr(3, 2)] + hexlookup2[c.substr(5, 2)];\n      d = hexlookup3[c] + ae;\n    } else if (c.substr(0, 4) === 'rgb(' || c.substr(0, 4) === 'hsl(') {\n      d = c.replace('(', 'a(').replace(')', ',' + ae);\n    } else if (c.substr(0, 5) === 'rgba(' || c.substr(0, 5) === 'hsla(') {\n      p1 = c.lastIndexOf(',') + 1, p2 = c.indexOf(')');\n      a *= parseFloat(c.substring(p1, p2));\n      d = c.substr(0, p1) + a.toPrecision(3) + ')';\n    }\n    return d;\n  }\n  function NewCanvas(w, h) {\n    // if using excanvas, give up now\n    if (window.G_vmlCanvasManager) return null;\n    var c = doc.createElement('canvas');\n    c.width = w;\n    c.height = h;\n    return c;\n  }\n  // I think all browsers pass this test now...\n  function ShadowAlphaBroken() {\n    var cv = NewCanvas(3, 3),\n      c,\n      i;\n    if (!cv) return false;\n    c = cv.getContext('2d');\n    c.strokeStyle = '#000';\n    c.shadowColor = '#fff';\n    c.shadowBlur = 3;\n    c.globalAlpha = 0;\n    c.strokeRect(2, 2, 2, 2);\n    c.globalAlpha = 1;\n    i = c.getImageData(2, 2, 1, 1);\n    cv = null;\n    return i.data[0] > 0;\n  }\n  function SetGradient(c, l, o, g) {\n    var gd = c.createLinearGradient(0, 0, l, 0),\n      i;\n    for (i in g) gd.addColorStop(1 - i, g[i]);\n    c.fillStyle = gd;\n    c.fillRect(0, o, l, 1);\n  }\n  function FindGradientColour(tc, p, r) {\n    var l = 1024,\n      h = 1,\n      gl = tc.weightGradient,\n      cv,\n      c,\n      i,\n      d;\n    if (tc.gCanvas) {\n      c = tc.gCanvas.getContext('2d');\n      h = tc.gCanvas.height;\n    } else {\n      if (IsObject(gl[0])) h = gl.length;else gl = [gl];\n      tc.gCanvas = cv = NewCanvas(l, h);\n      if (!cv) return null;\n      c = cv.getContext('2d');\n      for (i = 0; i < h; ++i) SetGradient(c, l, i, gl[i]);\n    }\n    r = max(min(r || 0, h - 1), 0);\n    d = c.getImageData(~~((l - 1) * p), r, 1, 1).data;\n    return 'rgba(' + d[0] + ',' + d[1] + ',' + d[2] + ',' + d[3] / 255 + ')';\n  }\n  function TextSet(ctxt, font, colour, strings, padx, pady, shadowColour, shadowBlur, shadowOffsets, maxWidth, widths, align) {\n    var xo = padx + (shadowBlur || 0) + (shadowOffsets.length && shadowOffsets[0] < 0 ? abs(shadowOffsets[0]) : 0),\n      yo = pady + (shadowBlur || 0) + (shadowOffsets.length && shadowOffsets[1] < 0 ? abs(shadowOffsets[1]) : 0),\n      i,\n      xc;\n    ctxt.font = font;\n    ctxt.textBaseline = 'top';\n    ctxt.fillStyle = colour;\n    shadowColour && (ctxt.shadowColor = shadowColour);\n    shadowBlur && (ctxt.shadowBlur = shadowBlur);\n    shadowOffsets.length && (ctxt.shadowOffsetX = shadowOffsets[0], ctxt.shadowOffsetY = shadowOffsets[1]);\n    for (i = 0; i < strings.length; ++i) {\n      xc = 0;\n      if (widths) {\n        if ('right' == align) {\n          xc = maxWidth - widths[i];\n        } else if ('centre' == align) {\n          xc = (maxWidth - widths[i]) / 2;\n        }\n      }\n      ctxt.fillText(strings[i], xo + xc, yo);\n      yo += parseInt(font);\n    }\n  }\n  function RRect(c, x, y, w, h, r, s) {\n    if (r) {\n      c.beginPath();\n      c.moveTo(x, y + h - r);\n      c.arcTo(x, y, x + r, y, r);\n      c.arcTo(x + w, y, x + w, y + r, r);\n      c.arcTo(x + w, y + h, x + w - r, y + h, r);\n      c.arcTo(x, y + h, x, y + h - r, r);\n      c.closePath();\n      c[s ? 'stroke' : 'fill']();\n    } else {\n      c[s ? 'strokeRect' : 'fillRect'](x, y, w, h);\n    }\n  }\n  function TextCanvas(strings, font, w, h, maxWidth, stringWidths, align, valign, scale) {\n    this.strings = strings;\n    this.font = font;\n    this.width = w;\n    this.height = h;\n    this.maxWidth = maxWidth;\n    this.stringWidths = stringWidths;\n    this.align = align;\n    this.valign = valign;\n    this.scale = scale;\n  }\n  TCVproto = TextCanvas.prototype;\n  TCVproto.SetImage = function (image, w, h, position, padding, align, valign, scale) {\n    this.image = image;\n    this.iwidth = w * this.scale;\n    this.iheight = h * this.scale;\n    this.ipos = position;\n    this.ipad = padding * this.scale;\n    this.iscale = scale;\n    this.ialign = align;\n    this.ivalign = valign;\n  };\n  TCVproto.Align = function (size, space, a) {\n    var pos = 0;\n    if (a == 'right' || a == 'bottom') pos = space - size;else if (a != 'left' && a != 'top') pos = (space - size) / 2;\n    return pos;\n  };\n  TCVproto.Create = function (colour, bgColour, bgOutline, bgOutlineThickness, shadowColour, shadowBlur, shadowOffsets, padding, radius) {\n    var cv,\n      cw,\n      ch,\n      c,\n      x1,\n      x2,\n      y1,\n      y2,\n      offx,\n      offy,\n      ix,\n      iy,\n      iw,\n      ih,\n      rr,\n      sox = abs(shadowOffsets[0]),\n      soy = abs(shadowOffsets[1]),\n      shadowcv,\n      shadowc;\n    padding = max(padding, sox + shadowBlur, soy + shadowBlur);\n    x1 = 2 * (padding + bgOutlineThickness);\n    y1 = 2 * (padding + bgOutlineThickness);\n    cw = this.width + x1;\n    ch = this.height + y1;\n    offx = offy = padding + bgOutlineThickness;\n    if (this.image) {\n      ix = iy = padding + bgOutlineThickness;\n      iw = this.iwidth;\n      ih = this.iheight;\n      if (this.ipos == 'top' || this.ipos == 'bottom') {\n        if (iw < this.width) ix += this.Align(iw, this.width, this.ialign);else offx += this.Align(this.width, iw, this.align);\n        if (this.ipos == 'top') offy += ih + this.ipad;else iy += this.height + this.ipad;\n        cw = max(cw, iw + x1);\n        ch += ih + this.ipad;\n      } else {\n        if (ih < this.height) iy += this.Align(ih, this.height, this.ivalign);else offy += this.Align(this.height, ih, this.valign);\n        if (this.ipos == 'right') ix += this.width + this.ipad;else offx += iw + this.ipad;\n        cw += iw + this.ipad;\n        ch = max(ch, ih + y1);\n      }\n    }\n    cv = NewCanvas(cw, ch);\n    if (!cv) return null;\n    x1 = y1 = bgOutlineThickness / 2;\n    x2 = cw - bgOutlineThickness;\n    y2 = ch - bgOutlineThickness;\n    rr = min(radius, x2 / 2, y2 / 2);\n    c = cv.getContext('2d');\n    if (bgColour) {\n      c.fillStyle = bgColour;\n      RRect(c, x1, y1, x2, y2, rr);\n    }\n    if (bgOutlineThickness) {\n      c.strokeStyle = bgOutline;\n      c.lineWidth = bgOutlineThickness;\n      RRect(c, x1, y1, x2, y2, rr, true);\n    }\n    if (shadowBlur || sox || soy) {\n      // use a transparent canvas to draw on\n      shadowcv = NewCanvas(cw, ch);\n      if (shadowcv) {\n        shadowc = c;\n        c = shadowcv.getContext('2d');\n      }\n    }\n\n    // don't use TextSet shadow support because it adds space for shadow\n    TextSet(c, this.font, colour, this.strings, offx, offy, 0, 0, [], this.maxWidth, this.stringWidths, this.align);\n    if (this.image) c.drawImage(this.image, ix, iy, iw, ih);\n    if (shadowc) {\n      // draw the text and image with the added shadow\n      c = shadowc;\n      shadowColour && (c.shadowColor = shadowColour);\n      shadowBlur && (c.shadowBlur = shadowBlur);\n      c.shadowOffsetX = shadowOffsets[0];\n      c.shadowOffsetY = shadowOffsets[1];\n      c.drawImage(shadowcv, 0, 0);\n    }\n    return cv;\n  };\n  function ExpandImage(i, w, h) {\n    var cv = NewCanvas(w, h),\n      c;\n    if (!cv) return null;\n    c = cv.getContext('2d');\n    c.drawImage(i, (w - i.width) / 2, (h - i.height) / 2);\n    return cv;\n  }\n  function ScaleImage(i, w, h) {\n    var cv = NewCanvas(w, h),\n      c;\n    if (!cv) return null;\n    c = cv.getContext('2d');\n    c.drawImage(i, 0, 0, w, h);\n    return cv;\n  }\n  function AddBackgroundToImage(i, w, h, scale, colour, othickness, ocolour, padding, radius, ofill) {\n    var cw = w + (2 * padding + othickness) * scale,\n      ch = h + (2 * padding + othickness) * scale,\n      cv = NewCanvas(cw, ch),\n      c,\n      x1,\n      y1,\n      x2,\n      y2,\n      ocanvas,\n      cc,\n      rr;\n    if (!cv) return null;\n    othickness *= scale;\n    radius *= scale;\n    x1 = y1 = othickness / 2;\n    x2 = cw - othickness;\n    y2 = ch - othickness;\n    padding = padding * scale + x1; // add space for outline\n    c = cv.getContext('2d');\n    rr = min(radius, x2 / 2, y2 / 2);\n    if (colour) {\n      c.fillStyle = colour;\n      RRect(c, x1, y1, x2, y2, rr);\n    }\n    if (othickness) {\n      c.strokeStyle = ocolour;\n      c.lineWidth = othickness;\n      RRect(c, x1, y1, x2, y2, rr, true);\n    }\n    if (ofill) {\n      // use compositing to colour in the image and border\n      ocanvas = NewCanvas(cw, ch);\n      cc = ocanvas.getContext('2d');\n      cc.drawImage(i, padding, padding, w, h);\n      cc.globalCompositeOperation = 'source-in';\n      cc.fillStyle = ocolour;\n      cc.fillRect(0, 0, cw, ch);\n      cc.globalCompositeOperation = 'destination-over';\n      cc.drawImage(cv, 0, 0);\n      cc.globalCompositeOperation = 'source-over';\n      c.drawImage(ocanvas, 0, 0);\n    } else {\n      c.drawImage(i, padding, padding, i.width, i.height);\n    }\n    return {\n      image: cv,\n      width: cw / scale,\n      height: ch / scale\n    };\n  }\n  /**\r\n   * Rounds off the corners of an image\r\n   */\n  function RoundImage(i, r, iw, ih, s) {\n    var cv,\n      c,\n      r1 = parseFloat(r),\n      l = max(iw, ih);\n    cv = NewCanvas(iw, ih);\n    if (!cv) return null;\n    if (r.indexOf('%') > 0) r1 = l * r1 / 100;else r1 = r1 * s;\n    c = cv.getContext('2d');\n    c.globalCompositeOperation = 'source-over';\n    c.fillStyle = '#fff';\n    if (r1 >= l / 2) {\n      r1 = min(iw, ih) / 2;\n      c.beginPath();\n      c.moveTo(iw / 2, ih / 2);\n      c.arc(iw / 2, ih / 2, r1, 0, 2 * Math.PI, false);\n      c.fill();\n      c.closePath();\n    } else {\n      r1 = min(iw / 2, ih / 2, r1);\n      RRect(c, 0, 0, iw, ih, r1, true);\n      c.fill();\n    }\n    c.globalCompositeOperation = 'source-in';\n    c.drawImage(i, 0, 0, iw, ih);\n    return cv;\n  }\n  /**\r\n   * Creates a new canvas containing the image and its shadow\r\n   * Returns an object containing the image and its dimensions at z=0\r\n   */\n  function AddShadowToImage(i, w, h, scale, sc, sb, so) {\n    var sw = abs(so[0]),\n      sh = abs(so[1]),\n      cw = w + (sw > sb ? sw + sb : sb * 2) * scale,\n      ch = h + (sh > sb ? sh + sb : sb * 2) * scale,\n      xo = scale * ((sb || 0) + (so[0] < 0 ? sw : 0)),\n      yo = scale * ((sb || 0) + (so[1] < 0 ? sh : 0)),\n      cv,\n      c;\n    cv = NewCanvas(cw, ch);\n    if (!cv) return null;\n    c = cv.getContext('2d');\n    sc && (c.shadowColor = sc);\n    sb && (c.shadowBlur = sb * scale);\n    so && (c.shadowOffsetX = so[0] * scale, c.shadowOffsetY = so[1] * scale);\n    c.drawImage(i, xo, yo, w, h);\n    return {\n      image: cv,\n      width: cw / scale,\n      height: ch / scale\n    };\n  }\n  function FindTextBoundingBox(s, f, ht) {\n    var w = parseInt(s.toString().length * ht),\n      h = parseInt(ht * 2 * s.length),\n      cv = NewCanvas(w, h),\n      c,\n      idata,\n      w1,\n      h1,\n      x,\n      y,\n      i,\n      ex;\n    if (!cv) return null;\n    c = cv.getContext('2d');\n    c.fillStyle = '#000';\n    c.fillRect(0, 0, w, h);\n    TextSet(c, ht + 'px ' + f, '#fff', s, 0, 0, 0, 0, [], 'centre');\n    idata = c.getImageData(0, 0, w, h);\n    w1 = idata.width;\n    h1 = idata.height;\n    ex = {\n      min: {\n        x: w1,\n        y: h1\n      },\n      max: {\n        x: -1,\n        y: -1\n      }\n    };\n    for (y = 0; y < h1; ++y) {\n      for (x = 0; x < w1; ++x) {\n        i = (y * w1 + x) * 4;\n        if (idata.data[i + 1] > 0) {\n          if (x < ex.min.x) ex.min.x = x;\n          if (x > ex.max.x) ex.max.x = x;\n          if (y < ex.min.y) ex.min.y = y;\n          if (y > ex.max.y) ex.max.y = y;\n        }\n      }\n    }\n    // device pixels might not be css pixels\n    if (w1 != w) {\n      ex.min.x *= w / w1;\n      ex.max.x *= w / w1;\n    }\n    if (h1 != h) {\n      ex.min.y *= w / h1;\n      ex.max.y *= w / h1;\n    }\n    cv = null;\n    return ex;\n  }\n  function FixFont(f) {\n    return \"'\" + f.replace(/(\\'|\\\")/g, '').replace(/\\s*,\\s*/g, \"', '\") + \"'\";\n  }\n  function AddHandler(h, f, e) {\n    e = e || doc;\n    if (e.addEventListener) e.addEventListener(h, f, false);else e.attachEvent('on' + h, f);\n  }\n  function RemoveHandler(h, f, e) {\n    e = e || doc;\n    if (e.removeEventListener) e.removeEventListener(h, f);else e.detachEvent('on' + h, f);\n  }\n  function AddImage(i, o, alt, t, tc) {\n    var s = tc.imageScale,\n      mscale,\n      ic,\n      bc,\n      oc,\n      iw,\n      ih;\n    // image not loaded, wait for image onload\n    if (!o.complete) return AddHandler('load', function () {\n      AddImage(i, o, alt, t, tc);\n    }, o);\n    if (!i.complete) return AddHandler('load', function () {\n      AddImage(i, o, alt, t, tc);\n    }, i);\n    if (alt && !alt.complete) return AddHandler('load', function () {\n      AddImage(i, o, alt, t, tc);\n    }, alt);\n\n    // Yes, this does look like nonsense, but it makes sure that both the\n    // width and height are actually set and not just calculated. This is\n    // required to keep proportional sizes when the images are hidden, so\n    // the images can be used again for another cloud.\n    o.width = o.width;\n    o.height = o.height;\n    if (s) {\n      i.width = o.width * s;\n      i.height = o.height * s;\n    }\n    // the standard width of the image, with imageScale applied\n    t.iw = i.width;\n    t.ih = i.height;\n    if (tc.txtOpt) {\n      ic = i;\n      mscale = tc.zoomMax * tc.txtScale;\n      iw = t.iw * mscale;\n      ih = t.ih * mscale;\n      if (iw < o.naturalWidth || ih < o.naturalHeight) {\n        ic = ScaleImage(i, iw, ih);\n        if (ic) t.fimage = ic;\n      } else {\n        iw = t.iw;\n        ih = t.ih;\n        mscale = 1;\n      }\n      if (parseFloat(tc.imageRadius)) t.image = t.fimage = i = RoundImage(t.image, tc.imageRadius, iw, ih, mscale);\n      if (!t.HasText()) {\n        if (tc.shadow) {\n          ic = AddShadowToImage(t.image, iw, ih, mscale, tc.shadow, tc.shadowBlur, tc.shadowOffset);\n          if (ic) {\n            t.fimage = ic.image;\n            t.w = ic.width;\n            t.h = ic.height;\n          }\n        }\n        if (tc.bgColour || tc.bgOutlineThickness) {\n          bc = tc.bgColour == 'tag' ? GetProperty(t.a, 'background-color') : tc.bgColour;\n          oc = tc.bgOutline == 'tag' ? GetProperty(t.a, 'color') : tc.bgOutline || tc.textColour;\n          iw = t.fimage.width;\n          ih = t.fimage.height;\n          if (tc.outlineMethod == 'colour') {\n            // create the outline version first, using the current image state\n            ic = AddBackgroundToImage(t.fimage, iw, ih, mscale, bc, tc.bgOutlineThickness, t.outline.colour, tc.padding, tc.bgRadius, 1);\n            if (ic) t.oimage = ic.image;\n          }\n          ic = AddBackgroundToImage(t.fimage, iw, ih, mscale, bc, tc.bgOutlineThickness, oc, tc.padding, tc.bgRadius);\n          if (ic) {\n            t.fimage = ic.image;\n            t.w = ic.width;\n            t.h = ic.height;\n          }\n        }\n        if (tc.outlineMethod == 'size') {\n          if (tc.outlineIncrease > 0) {\n            t.iw += 2 * tc.outlineIncrease;\n            t.ih += 2 * tc.outlineIncrease;\n            iw = mscale * t.iw;\n            ih = mscale * t.ih;\n            ic = ScaleImage(t.fimage, iw, ih);\n            t.oimage = ic;\n            t.fimage = ExpandImage(t.fimage, t.oimage.width, t.oimage.height);\n          } else {\n            iw = mscale * (t.iw + 2 * tc.outlineIncrease);\n            ih = mscale * (t.ih + 2 * tc.outlineIncrease);\n            ic = ScaleImage(t.fimage, iw, ih);\n            t.oimage = ExpandImage(ic, t.fimage.width, t.fimage.height);\n          }\n        }\n      }\n    }\n    t.alt = alt;\n    t.Init();\n  }\n  function GetProperty(e, p) {\n    var dv = doc.defaultView,\n      pc = p.replace(/\\-([a-z])/g, function (a) {\n        return a.charAt(1).toUpperCase();\n      });\n    return dv && dv.getComputedStyle && dv.getComputedStyle(e, null).getPropertyValue(p) || e.currentStyle && e.currentStyle[pc];\n  }\n  function FindWeight(a, wFrom, tHeight) {\n    var w = 1,\n      p;\n    if (wFrom) {\n      w = 1 * (a.getAttribute(wFrom) || tHeight);\n    } else if (p = GetProperty(a, 'font-size')) {\n      w = p.indexOf('px') > -1 && p.replace('px', '') * 1 || p.indexOf('pt') > -1 && p.replace('pt', '') * 1.25 || p * 3.3;\n    }\n    return w;\n  }\n  function EventToCanvasId(e) {\n    return e.target && Defined(e.target.id) ? e.target.id : e.srcElement.parentNode.id;\n  }\n  function EventXY(e, c) {\n    var xy,\n      p,\n      xmul = parseInt(GetProperty(c, 'width')) / c.width,\n      ymul = parseInt(GetProperty(c, 'height')) / c.height;\n    if (Defined(e.offsetX)) {\n      xy = {\n        x: e.offsetX,\n        y: e.offsetY\n      };\n    } else {\n      p = AbsPos(c.id);\n      if (Defined(e.changedTouches)) e = e.changedTouches[0];\n      if (e.pageX) xy = {\n        x: e.pageX - p.x,\n        y: e.pageY - p.y\n      };\n    }\n    if (xy && xmul && ymul) {\n      xy.x /= xmul;\n      xy.y /= ymul;\n    }\n    return xy;\n  }\n  function MouseOut(e) {\n    var cv = e.target || e.fromElement.parentNode,\n      tc = TagCanvas.tc[cv.id];\n    if (tc) {\n      tc.mx = tc.my = -1;\n      tc.UnFreeze();\n      tc.EndDrag();\n    }\n  }\n  function MouseMove(e) {\n    var i,\n      t = TagCanvas,\n      tc,\n      p,\n      tg = EventToCanvasId(e);\n    for (i in t.tc) {\n      tc = t.tc[i];\n      if (tc.tttimer) {\n        clearTimeout(tc.tttimer);\n        tc.tttimer = null;\n      }\n    }\n    if (tg && t.tc[tg]) {\n      tc = t.tc[tg];\n      if (p = EventXY(e, tc.canvas)) {\n        tc.mx = p.x;\n        tc.my = p.y;\n        tc.Drag(e, p);\n      }\n      tc.drawn = 0;\n    }\n  }\n  function MouseDown(e) {\n    var t = TagCanvas,\n      cb = doc.addEventListener ? 0 : 1,\n      tg = EventToCanvasId(e);\n    if (tg && e.button == cb && t.tc[tg]) {\n      t.tc[tg].BeginDrag(e);\n    }\n  }\n  function MouseUp(e) {\n    var t = TagCanvas,\n      cb = doc.addEventListener ? 0 : 1,\n      tg = EventToCanvasId(e),\n      tc;\n    if (tg && e.button == cb && t.tc[tg]) {\n      tc = t.tc[tg];\n      MouseMove(e);\n      if (!tc.EndDrag() && !tc.touchState) tc.Clicked(e);\n    }\n  }\n  function TouchDown(e) {\n    var tg = EventToCanvasId(e),\n      tc = tg && TagCanvas.tc[tg],\n      p;\n    if (tc && e.changedTouches) {\n      if (e.touches.length == 1 && tc.touchState == 0) {\n        tc.touchState = 1;\n        tc.BeginDrag(e);\n        if (p = EventXY(e, tc.canvas)) {\n          tc.mx = p.x;\n          tc.my = p.y;\n          tc.drawn = 0;\n        }\n      } else if (e.targetTouches.length == 2 && tc.pinchZoom) {\n        tc.touchState = 3;\n        tc.EndDrag();\n        tc.BeginPinch(e);\n      } else {\n        tc.EndDrag();\n        tc.EndPinch();\n        tc.touchState = 0;\n      }\n    }\n  }\n  function TouchUp(e) {\n    var tg = EventToCanvasId(e),\n      tc = tg && TagCanvas.tc[tg];\n    if (tc && e.changedTouches) {\n      switch (tc.touchState) {\n        case 1:\n          tc.Draw();\n          tc.Clicked();\n          break;\n        case 2:\n          tc.EndDrag();\n          break;\n        case 3:\n          tc.EndPinch();\n      }\n      tc.touchState = 0;\n    }\n  }\n  function TouchMove(e) {\n    var i,\n      t = TagCanvas,\n      tc,\n      p,\n      tg = EventToCanvasId(e);\n    for (i in t.tc) {\n      tc = t.tc[i];\n      if (tc.tttimer) {\n        clearTimeout(tc.tttimer);\n        tc.tttimer = null;\n      }\n    }\n    tc = tg && t.tc[tg];\n    if (tc && e.changedTouches && tc.touchState) {\n      switch (tc.touchState) {\n        case 1:\n        case 2:\n          if (p = EventXY(e, tc.canvas)) {\n            tc.mx = p.x;\n            tc.my = p.y;\n            if (tc.Drag(e, p)) tc.touchState = 2;\n          }\n          break;\n        case 3:\n          tc.Pinch(e);\n      }\n      tc.drawn = 0;\n    }\n  }\n  function MouseWheel(e) {\n    var t = TagCanvas,\n      tg = EventToCanvasId(e);\n    if (tg && t.tc[tg]) {\n      e.cancelBubble = true;\n      e.returnValue = false;\n      e.preventDefault && e.preventDefault();\n      t.tc[tg].Wheel((e.wheelDelta || e.detail) > 0);\n    }\n  }\n  function Scroll(e) {\n    var i,\n      t = TagCanvas;\n    clearTimeout(t.scrollTimer);\n    for (i in t.tc) {\n      t.tc[i].Pause();\n    }\n    t.scrollTimer = setTimeout(function () {\n      var i,\n        t = TagCanvas;\n      for (i in t.tc) {\n        t.tc[i].Resume();\n      }\n    }, t.scrollPause);\n  }\n  function DrawCanvas() {\n    DrawCanvasRAF(TimeNow());\n  }\n  function DrawCanvasRAF(t) {\n    var tc = TagCanvas.tc,\n      i;\n    TagCanvas.NextFrame(TagCanvas.interval);\n    t = t || TimeNow();\n    for (i in tc) tc[i].Draw(t);\n  }\n  function NextFrameRAF() {\n    requestAnimationFrame(DrawCanvasRAF);\n  }\n  ;\n  function NextFrameTimeout(iv) {\n    setTimeout(DrawCanvas, iv);\n  }\n  ;\n  function AbsPos(id) {\n    var e = doc.getElementById(id),\n      r = e.getBoundingClientRect(),\n      dd = doc.documentElement,\n      b = doc.body,\n      w = window,\n      xs = w.pageXOffset || dd.scrollLeft,\n      ys = w.pageYOffset || dd.scrollTop,\n      xo = dd.clientLeft || b.clientLeft,\n      yo = dd.clientTop || b.clientTop;\n    return {\n      x: r.left + xs - xo,\n      y: r.top + ys - yo\n    };\n  }\n  function Project(tc, p1, sx, sy) {\n    var m = tc.radius * tc.z1 / (tc.z1 + tc.z2 + p1.z);\n    return {\n      x: p1.x * m * sx,\n      y: p1.y * m * sy,\n      z: p1.z,\n      w: (tc.z1 - p1.z) / tc.z2\n    };\n  }\n  /**\r\n   * @constructor\r\n   * for recursively splitting tag contents on <br> tags\r\n   */\n  function TextSplitter(e) {\n    this.e = e;\n    this.br = 0;\n    this.line = [];\n    this.text = [];\n    this.original = e.innerText || e.textContent;\n  }\n  TSproto = TextSplitter.prototype;\n  TSproto.Empty = function () {\n    for (var i = 0; i < this.text.length; ++i) if (this.text[i].length) return false;\n    return true;\n  };\n  TSproto.Lines = function (e) {\n    var r = e ? 1 : 0,\n      cn,\n      cl,\n      i;\n    e = e || this.e;\n    cn = e.childNodes;\n    cl = cn.length;\n    for (i = 0; i < cl; ++i) {\n      if (cn[i].nodeName == 'BR') {\n        this.text.push(this.line.join(' '));\n        this.br = 1;\n      } else if (cn[i].nodeType == 3) {\n        if (this.br) {\n          this.line = [cn[i].nodeValue];\n          this.br = 0;\n        } else {\n          this.line.push(cn[i].nodeValue);\n        }\n      } else {\n        this.Lines(cn[i]);\n      }\n    }\n    r || this.br || this.text.push(this.line.join(' '));\n    return this.text;\n  };\n  TSproto.SplitWidth = function (w, c, f, h) {\n    var i,\n      j,\n      words,\n      text = [];\n    c.font = h + 'px ' + f;\n    for (i = 0; i < this.text.length; ++i) {\n      words = this.text[i].split(/\\s+/);\n      this.line = [words[0]];\n      for (j = 1; j < words.length; ++j) {\n        if (c.measureText(this.line.join(' ') + ' ' + words[j]).width > w) {\n          text.push(this.line.join(' '));\n          this.line = [words[j]];\n        } else {\n          this.line.push(words[j]);\n        }\n      }\n      text.push(this.line.join(' '));\n    }\n    return this.text = text;\n  };\n  /**\r\n   * @constructor\r\n   */\n  function Outline(tc, t) {\n    this.ts = null;\n    this.tc = tc;\n    this.tag = t;\n    this.x = this.y = this.w = this.h = this.sc = 1;\n    this.z = 0;\n    this.pulse = 1;\n    this.pulsate = tc.pulsateTo < 1;\n    this.colour = tc.outlineColour;\n    this.adash = ~~tc.outlineDash;\n    this.agap = ~~tc.outlineDashSpace || this.adash;\n    this.aspeed = tc.outlineDashSpeed * 1;\n    if (this.colour == 'tag') this.colour = GetProperty(t.a, 'color');else if (this.colour == 'tagbg') this.colour = GetProperty(t.a, 'background-color');\n    this.Draw = this.pulsate ? this.DrawPulsate : this.DrawSimple;\n    this.radius = tc.outlineRadius | 0;\n    this.SetMethod(tc.outlineMethod, tc.altImage);\n  }\n  Oproto = Outline.prototype;\n  Oproto.SetMethod = function (om, alt) {\n    var methods = {\n        block: ['PreDraw', 'DrawBlock'],\n        colour: ['PreDraw', 'DrawColour'],\n        outline: ['PostDraw', 'DrawOutline'],\n        classic: ['LastDraw', 'DrawOutline'],\n        size: ['PreDraw', 'DrawSize'],\n        none: ['LastDraw']\n      },\n      funcs = methods[om] || methods.outline;\n    if (om == 'none') {\n      this.Draw = function () {\n        return 1;\n      };\n    } else {\n      this.drawFunc = this[funcs[1]];\n    }\n    this[funcs[0]] = this.Draw;\n    if (alt) {\n      this.RealPreDraw = this.PreDraw;\n      this.PreDraw = this.DrawAlt;\n    }\n  };\n  Oproto.Update = function (x, y, w, h, sc, z, xo, yo) {\n    var o = this.tc.outlineOffset,\n      o2 = 2 * o;\n    this.x = sc * x + xo - o;\n    this.y = sc * y + yo - o;\n    this.w = sc * w + o2;\n    this.h = sc * h + o2;\n    this.sc = sc; // used to determine frontmost\n    this.z = z;\n  };\n  Oproto.Ants = function (c) {\n    if (!this.adash) return;\n    var l = this.adash,\n      g = this.agap,\n      s = this.aspeed,\n      length = l + g,\n      l1 = 0,\n      l2 = l,\n      g1 = g,\n      g2 = 0,\n      seq = 0,\n      ants;\n    if (s) {\n      seq = abs(s) * (TimeNow() - this.ts) / 50;\n      if (s < 0) seq = 8.64e6 - seq;\n      s = ~~seq % length;\n    }\n    if (s) {\n      if (l >= s) {\n        l1 = l - s;\n        l2 = s;\n      } else {\n        g1 = length - s;\n        g2 = g - g1;\n      }\n      ants = [l1, g1, l2, g2];\n    } else {\n      ants = [l, g];\n    }\n    c.setLineDash(ants);\n  };\n  Oproto.DrawOutline = function (c, x, y, w, h, colour) {\n    var r = min(this.radius, h / 2, w / 2);\n    c.strokeStyle = colour;\n    this.Ants(c);\n    RRect(c, x, y, w, h, r, true);\n  };\n  Oproto.DrawSize = function (c, x, y, w, h, colour, tag, x1, y1) {\n    var tw = tag.w,\n      th = tag.h,\n      m,\n      i,\n      sc;\n    if (this.pulsate) {\n      if (tag.image) sc = (tag.image.height + this.tc.outlineIncrease) / tag.image.height;else sc = tag.oscale;\n      i = tag.fimage || tag.image;\n      m = 1 + (sc - 1) * (1 - this.pulse);\n      tag.h *= m;\n      tag.w *= m;\n    } else {\n      i = tag.oimage;\n    }\n    tag.alpha = 1;\n    tag.Draw(c, x1, y1, i);\n    tag.h = th;\n    tag.w = tw;\n    return 1;\n  };\n  Oproto.DrawColour = function (c, x, y, w, h, colour, tag, x1, y1) {\n    if (tag.oimage) {\n      if (this.pulse < 1) {\n        tag.alpha = 1 - pow(this.pulse, 2);\n        tag.Draw(c, x1, y1, tag.fimage);\n        tag.alpha = this.pulse;\n      } else {\n        tag.alpha = 1;\n      }\n      tag.Draw(c, x1, y1, tag.oimage);\n      return 1;\n    }\n    return this[tag.image ? 'DrawColourImage' : 'DrawColourText'](c, x, y, w, h, colour, tag, x1, y1);\n  };\n  Oproto.DrawColourText = function (c, x, y, w, h, colour, tag, x1, y1) {\n    var normal = tag.colour;\n    tag.colour = colour;\n    tag.alpha = 1;\n    tag.Draw(c, x1, y1);\n    tag.colour = normal;\n    return 1;\n  };\n  Oproto.DrawColourImage = function (c, x, y, w, h, colour, tag, x1, y1) {\n    var ccanvas = c.canvas,\n      fx = ~~max(x, 0),\n      fy = ~~max(y, 0),\n      fw = min(ccanvas.width - fx, w) + .5 | 0,\n      fh = min(ccanvas.height - fy, h) + .5 | 0,\n      cc;\n    if (ocanvas) ocanvas.width = fw, ocanvas.height = fh;else ocanvas = NewCanvas(fw, fh);\n    if (!ocanvas) return this.SetMethod('outline'); // if using IE and images, give up!\n    cc = ocanvas.getContext('2d');\n    cc.drawImage(ccanvas, fx, fy, fw, fh, 0, 0, fw, fh);\n    c.clearRect(fx, fy, fw, fh);\n    if (this.pulsate) {\n      tag.alpha = 1 - pow(this.pulse, 2);\n    } else {\n      tag.alpha = 1;\n    }\n    tag.Draw(c, x1, y1);\n    c.setTransform(1, 0, 0, 1, 0, 0);\n    c.save();\n    c.beginPath();\n    c.rect(fx, fy, fw, fh);\n    c.clip();\n    c.globalCompositeOperation = 'source-in';\n    c.fillStyle = colour;\n    c.fillRect(fx, fy, fw, fh);\n    c.restore();\n    c.globalAlpha = 1;\n    c.globalCompositeOperation = 'destination-over';\n    c.drawImage(ocanvas, 0, 0, fw, fh, fx, fy, fw, fh);\n    c.globalCompositeOperation = 'source-over';\n    return 1;\n  };\n  Oproto.DrawAlt = function (c, tag, x1, y1, ga, useGa) {\n    var r = this.RealPreDraw(c, tag, x1, y1, ga, useGa);\n    if (tag.alt) {\n      tag.DrawImage(c, x1, y1, tag.alt);\n      r = 1;\n    }\n    return r;\n  };\n  Oproto.DrawBlock = function (c, x, y, w, h, colour) {\n    var r = min(this.radius, h / 2, w / 2);\n    c.fillStyle = colour;\n    RRect(c, x, y, w, h, r);\n  };\n  Oproto.DrawSimple = function (c, tag, x1, y1, ga, useGa) {\n    var t = this.tc;\n    c.setTransform(1, 0, 0, 1, 0, 0);\n    c.strokeStyle = this.colour;\n    c.lineWidth = t.outlineThickness;\n    c.shadowBlur = c.shadowOffsetX = c.shadowOffsetY = 0;\n    c.globalAlpha = useGa ? ga : 1;\n    return this.drawFunc(c, this.x, this.y, this.w, this.h, this.colour, tag, x1, y1);\n  };\n  Oproto.DrawPulsate = function (c, tag, x1, y1) {\n    var diff = TimeNow() - this.ts,\n      t = this.tc,\n      ga = t.pulsateTo + (1 - t.pulsateTo) * (0.5 + cos(2 * Math.PI * diff / (1000 * t.pulsateTime)) / 2);\n    this.pulse = ga = TagCanvas.Smooth(1, ga);\n    return this.DrawSimple(c, tag, x1, y1, ga, 1);\n  };\n  Oproto.Active = function (c, x, y) {\n    var a = x >= this.x && y >= this.y && x <= this.x + this.w && y <= this.y + this.h;\n    if (a) {\n      this.ts = this.ts || TimeNow();\n    } else {\n      this.ts = null;\n    }\n    return a;\n  };\n  Oproto.PreDraw = Oproto.PostDraw = Oproto.LastDraw = Nop;\n  /**\r\n   * @constructor\r\n   */\n  function Tag(tc, text, a, v, w, h, col, bcol, bradius, boutline, bothickness, font, padding, original) {\n    this.tc = tc;\n    this.image = null;\n    this.text = text;\n    this.text_original = original;\n    this.line_widths = [];\n    this.title = a.title || null;\n    this.a = a;\n    this.position = new Vector(v[0], v[1], v[2]);\n    this.x = this.y = this.z = 0;\n    this.w = w;\n    this.h = h;\n    this.colour = col || tc.textColour;\n    this.bgColour = bcol || tc.bgColour;\n    this.bgRadius = bradius | 0;\n    this.bgOutline = boutline || this.colour;\n    this.bgOutlineThickness = bothickness | 0;\n    this.textFont = font || tc.textFont;\n    this.padding = padding | 0;\n    this.sc = this.alpha = 1;\n    this.weighted = !tc.weight;\n    this.outline = new Outline(tc, this);\n    this.audio = null;\n  }\n  Tproto = Tag.prototype;\n  Tproto.Init = function (e) {\n    var tc = this.tc;\n    this.textHeight = tc.textHeight;\n    if (this.HasText()) {\n      this.Measure(tc.ctxt, tc);\n    } else {\n      this.w = this.iw;\n      this.h = this.ih;\n    }\n    this.SetShadowColour = tc.shadowAlpha ? this.SetShadowColourAlpha : this.SetShadowColourFixed;\n    this.SetDraw(tc);\n  };\n  Tproto.Draw = Nop;\n  Tproto.HasText = function () {\n    return this.text && this.text[0].length > 0;\n  };\n  Tproto.EqualTo = function (e) {\n    var i = e.getElementsByTagName('img');\n    if (this.a.href != e.href) return 0;\n    if (i.length) return this.image.src == i[0].src;\n    return (e.innerText || e.textContent) == this.text_original;\n  };\n  Tproto.SetImage = function (i) {\n    this.image = this.fimage = i;\n  };\n  Tproto.SetAudio = function (a) {\n    this.audio = a;\n    this.audio.load();\n  };\n  Tproto.SetDraw = function (t) {\n    this.Draw = this.fimage ? t.ie > 7 ? this.DrawImageIE : this.DrawImage : this.DrawText;\n    t.noSelect && (this.CheckActive = Nop);\n  };\n  Tproto.MeasureText = function (c) {\n    var i,\n      l = this.text.length,\n      w = 0,\n      wl;\n    for (i = 0; i < l; ++i) {\n      this.line_widths[i] = wl = c.measureText(this.text[i]).width;\n      w = max(w, wl);\n    }\n    return w;\n  };\n  Tproto.Measure = function (c, t) {\n    var extents = FindTextBoundingBox(this.text, this.textFont, this.textHeight),\n      s,\n      th,\n      f,\n      soff,\n      cw,\n      twidth,\n      theight,\n      img,\n      tcv;\n    // add the gap at the top to the height to make equal gap at bottom\n    theight = extents ? extents.max.y + extents.min.y : this.textHeight;\n    c.font = this.font = this.textHeight + 'px ' + this.textFont;\n    twidth = this.MeasureText(c);\n    if (t.txtOpt) {\n      s = t.txtScale;\n      th = s * this.textHeight;\n      f = th + 'px ' + this.textFont;\n      soff = [s * t.shadowOffset[0], s * t.shadowOffset[1]];\n      c.font = f;\n      cw = this.MeasureText(c);\n      tcv = new TextCanvas(this.text, f, cw + s, s * theight + s, cw, this.line_widths, t.textAlign, t.textVAlign, s);\n      if (this.image) tcv.SetImage(this.image, this.iw, this.ih, t.imagePosition, t.imagePadding, t.imageAlign, t.imageVAlign, t.imageScale);\n      img = tcv.Create(this.colour, this.bgColour, this.bgOutline, s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff, s * this.padding, s * this.bgRadius);\n\n      // add outline image using highlight colour\n      if (t.outlineMethod == 'colour') {\n        this.oimage = tcv.Create(this.outline.colour, this.bgColour, this.outline.colour, s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff, s * this.padding, s * this.bgRadius);\n      } else if (t.outlineMethod == 'size') {\n        extents = FindTextBoundingBox(this.text, this.textFont, this.textHeight + t.outlineIncrease);\n        th = extents.max.y + extents.min.y;\n        f = s * (this.textHeight + t.outlineIncrease) + 'px ' + this.textFont;\n        c.font = f;\n        cw = this.MeasureText(c);\n        tcv = new TextCanvas(this.text, f, cw + s, s * th + s, cw, this.line_widths, t.textAlign, t.textVAlign, s);\n        if (this.image) tcv.SetImage(this.image, this.iw + t.outlineIncrease, this.ih + t.outlineIncrease, t.imagePosition, t.imagePadding, t.imageAlign, t.imageVAlign, t.imageScale);\n        this.oimage = tcv.Create(this.colour, this.bgColour, this.bgOutline, s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff, s * this.padding, s * this.bgRadius);\n        this.oscale = this.oimage.width / img.width;\n        if (t.outlineIncrease > 0) img = ExpandImage(img, this.oimage.width, this.oimage.height);else this.oimage = ExpandImage(this.oimage, img.width, img.height);\n      }\n      if (img) {\n        this.fimage = img;\n        twidth = this.fimage.width / s;\n        theight = this.fimage.height / s;\n      }\n      this.SetDraw(t);\n      t.txtOpt = !!this.fimage;\n    }\n    this.h = theight;\n    this.w = twidth;\n  };\n  Tproto.SetFont = function (f, c, bc, boc) {\n    this.textFont = f;\n    this.colour = c;\n    this.bgColour = bc;\n    this.bgOutline = boc;\n    this.Measure(this.tc.ctxt, this.tc);\n  };\n  Tproto.SetWeight = function (w) {\n    var tc = this.tc,\n      modes = tc.weightMode.split(/[, ]/),\n      m,\n      s,\n      wl = w.length;\n    if (!this.HasText()) return;\n    this.weighted = true;\n    for (s = 0; s < wl; ++s) {\n      m = modes[s] || 'size';\n      if ('both' == m) {\n        this.Weight(w[s], tc.ctxt, tc, 'size', tc.min_weight[s], tc.max_weight[s], s);\n        this.Weight(w[s], tc.ctxt, tc, 'colour', tc.min_weight[s], tc.max_weight[s], s);\n      } else {\n        this.Weight(w[s], tc.ctxt, tc, m, tc.min_weight[s], tc.max_weight[s], s);\n      }\n    }\n    this.Measure(tc.ctxt, tc);\n  };\n  Tproto.Weight = function (w, c, t, m, wmin, wmax, wnum) {\n    w = isNaN(w) ? 1 : w;\n    var nweight = (w - wmin) / (wmax - wmin);\n    if ('colour' == m) this.colour = FindGradientColour(t, nweight, wnum);else if ('bgcolour' == m) this.bgColour = FindGradientColour(t, nweight, wnum);else if ('bgoutline' == m) this.bgOutline = FindGradientColour(t, nweight, wnum);else if ('outline' == m) this.outline.colour = FindGradientColour(t, nweight, wnum);else if ('size' == m) {\n      if (t.weightSizeMin > 0 && t.weightSizeMax > t.weightSizeMin) {\n        this.textHeight = t.weightSize * (t.weightSizeMin + (t.weightSizeMax - t.weightSizeMin) * nweight);\n      } else {\n        // min textHeight of 1\n        this.textHeight = max(1, w * t.weightSize);\n      }\n    }\n  };\n  Tproto.SetShadowColourFixed = function (c, s, a) {\n    c.shadowColor = s;\n  };\n  Tproto.SetShadowColourAlpha = function (c, s, a) {\n    c.shadowColor = SetAlpha(s, a);\n  };\n  Tproto.DrawText = function (c, xoff, yoff) {\n    var t = this.tc,\n      x = this.x,\n      y = this.y,\n      s = this.sc,\n      i,\n      xl;\n    c.globalAlpha = this.alpha;\n    c.fillStyle = this.colour;\n    t.shadow && this.SetShadowColour(c, t.shadow, this.alpha);\n    c.font = this.font;\n    x += xoff / s;\n    y += yoff / s - this.h / 2;\n    for (i = 0; i < this.text.length; ++i) {\n      xl = x;\n      if ('right' == t.textAlign) {\n        xl += this.w / 2 - this.line_widths[i];\n      } else if ('centre' == t.textAlign) {\n        xl -= this.line_widths[i] / 2;\n      } else {\n        xl -= this.w / 2;\n      }\n      c.setTransform(s, 0, 0, s, s * xl, s * y);\n      c.fillText(this.text[i], 0, 0);\n      y += this.textHeight;\n    }\n  };\n  Tproto.DrawImage = function (c, xoff, yoff, im) {\n    var x = this.x,\n      y = this.y,\n      s = this.sc,\n      i = im || this.fimage,\n      w = this.w,\n      h = this.h,\n      a = this.alpha,\n      shadow = this.shadow;\n    c.globalAlpha = a;\n    shadow && this.SetShadowColour(c, shadow, a);\n    x += xoff / s - w / 2;\n    y += yoff / s - h / 2;\n    c.setTransform(s, 0, 0, s, s * x, s * y);\n    c.drawImage(i, 0, 0, w, h);\n  };\n  Tproto.DrawImageIE = function (c, xoff, yoff) {\n    var i = this.fimage,\n      s = this.sc,\n      w = i.width = this.w * s,\n      h = i.height = this.h * s,\n      x = this.x * s + xoff - w / 2,\n      y = this.y * s + yoff - h / 2;\n    c.setTransform(1, 0, 0, 1, 0, 0);\n    c.globalAlpha = this.alpha;\n    c.drawImage(i, x, y);\n  };\n  Tproto.Calc = function (m, a) {\n    var pp,\n      t = this.tc,\n      mnb = t.minBrightness,\n      mxb = t.maxBrightness,\n      r = t.max_radius;\n    pp = m.xform(this.position);\n    this.xformed = pp;\n    pp = Project(t, pp, t.stretchX, t.stretchY);\n    this.x = pp.x;\n    this.y = pp.y;\n    this.z = pp.z;\n    this.sc = pp.w;\n    this.alpha = a * Clamp(mnb + (mxb - mnb) * (r - this.z) / (2 * r), 0, 1);\n    return this.xformed;\n  };\n  Tproto.UpdateActive = function (c, xoff, yoff) {\n    var o = this.outline,\n      w = this.w,\n      h = this.h,\n      x = this.x - w / 2,\n      y = this.y - h / 2;\n    o.Update(x, y, w, h, this.sc, this.z, xoff, yoff);\n    return o;\n  };\n  Tproto.CheckActive = function (c, xoff, yoff) {\n    var t = this.tc,\n      o = this.UpdateActive(c, xoff, yoff);\n    return o.Active(c, t.mx, t.my) ? o : null;\n  };\n  Tproto.Clicked = function (e) {\n    var a = this.a,\n      t = a.target,\n      h = a.href,\n      evt;\n    if (t != '' && t != '_self') {\n      if (self.frames[t]) {\n        self.frames[t].document.location = h;\n      } else {\n        try {\n          if (top.frames[t]) {\n            top.frames[t].document.location = h;\n            return;\n          }\n        } catch (err) {\n          // different domain/port/protocol?\n        }\n        window.open(h, t);\n      }\n      return;\n    }\n    if (doc.createEvent) {\n      evt = doc.createEvent('MouseEvents');\n      evt.initMouseEvent('click', 1, 1, window, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, null);\n      if (!a.dispatchEvent(evt)) return;\n    } else if (a.fireEvent) {\n      if (!a.fireEvent('onclick')) return;\n    }\n    doc.location = h;\n  };\n  Tproto.StopAudio = function () {\n    this.audio && this.playing && this.audio.pause();\n    this.stopped = 1;\n    this.playing = 0;\n  };\n  Tproto.PlayAudio = function () {\n    if (audio === 'off' || this.tc.audioOff) return;\n    if (!audio && !SetupAudio()) return;\n    var a = this.tc.audio,\n      g = this.tc.gain,\n      sus = 'suspended',\n      p;\n    if (this.audio) {\n      if (!this.track) {\n        this.track = audio.createMediaElementSource(this.audio);\n        this.gain = audio.createGain();\n        this.track.connect(this.gain);\n        this.gain.connect(audio.destination);\n      }\n      a = this.audio;\n      g = this.gain;\n      if (!a.paused) return 1;\n    }\n    if (a) {\n      if (audio.state == sus) audio.resume();\n      if (audio.state == sus) return;\n      g.gain.value = min(2, max(0, this.tc.audioVolume * 1));\n      a.currentTime = 0;\n      this.stopped = 0;\n      p = a.play();\n      if (p !== undefined) {\n        p.then(r => {\n          this.stopped ? this.audio.pause() : this.playing = 1;\n        });\n      }\n      return 1;\n    }\n  };\n  /**\r\n   * @constructor\r\n   */\n  function TagCanvas(cid, lctr, opt) {\n    var i,\n      p,\n      c = doc.getElementById(cid),\n      cp = ['id', 'class', 'innerHTML'];\n    if (!c) throw 0;\n    if (Defined(window.G_vmlCanvasManager)) {\n      c = window.G_vmlCanvasManager.initElement(c);\n      this.ie = parseFloat(navigator.appVersion.split('MSIE')[1]);\n    }\n    if (c && (!c.getContext || !c.getContext('2d').fillText)) {\n      p = doc.createElement('DIV');\n      for (i = 0; i < cp.length; ++i) p[cp[i]] = c[cp[i]];\n      c.parentNode.insertBefore(p, c);\n      c.parentNode.removeChild(c);\n      throw 0;\n    }\n    for (i in TagCanvas.options) this[i] = opt && Defined(opt[i]) ? opt[i] : Defined(TagCanvas[i]) ? TagCanvas[i] : TagCanvas.options[i];\n    this.canvas = c;\n    this.ctxt = c.getContext('2d');\n    this.z1 = 250 / max(this.depth, 0.001);\n    this.z2 = this.z1 / this.zoom;\n    this.radius = min(c.height, c.width) * 0.0075; // fits radius of 100 in canvas\n    this.max_radius = 100;\n    this.max_weight = [];\n    this.min_weight = [];\n    this.textFont = this.textFont && FixFont(this.textFont);\n    this.textHeight *= 1;\n    this.imageRadius = this.imageRadius.toString();\n    this.pulsateTo = Clamp(this.pulsateTo, 0, 1);\n    this.minBrightness = Clamp(this.minBrightness, 0, 1);\n    this.maxBrightness = Clamp(this.maxBrightness, this.minBrightness, 1);\n    this.ctxt.textBaseline = 'top';\n    this.lx = (this.lock + '').indexOf('x') + 1;\n    this.ly = (this.lock + '').indexOf('y') + 1;\n    this.frozen = this.dx = this.dy = this.fixedAnim = this.touchState = 0;\n    this.fixedAlpha = 1;\n    this.source = lctr || cid;\n    this.repeatTags = min(64, ~~this.repeatTags);\n    this.minTags = min(200, ~~this.minTags);\n    if (~~this.scrollPause > 0) TagCanvas.scrollPause = ~~this.scrollPause;else this.scrollPause = 0;\n    if (this.minTags > 0 && this.repeatTags < 1 && (i = this.GetTags().length)) this.repeatTags = ceil(this.minTags / i) - 1;\n    this.transform = Matrix.Identity();\n    this.startTime = this.time = TimeNow();\n    this.mx = this.my = -1;\n    this.centreImage && CentreImage(this);\n    this.Animate = this.dragControl ? this.AnimateDrag : this.AnimatePosition;\n    this.animTiming = typeof TagCanvas[this.animTiming] == 'function' ? TagCanvas[this.animTiming] : TagCanvas.Smooth;\n    if (this.shadowBlur || this.shadowOffset[0] || this.shadowOffset[1]) {\n      // let the browser translate \"red\" into \"#ff0000\"\n      this.ctxt.shadowColor = this.shadow;\n      this.shadow = this.ctxt.shadowColor;\n      this.shadowAlpha = ShadowAlphaBroken();\n    } else {\n      delete this.shadow;\n    }\n    if (this.activeAudio === false) {\n      audio = 'off';\n    } else {\n      this.activeAudio && this.LoadAudio();\n    }\n    this.Load();\n    if (lctr && this.hideTags) {\n      (function (t) {\n        if (TagCanvas.loaded) t.HideTags();else AddHandler('load', function () {\n          t.HideTags();\n        }, window);\n      })(this);\n    }\n    this.yaw = this.initial ? this.initial[0] * this.maxSpeed : 0;\n    this.pitch = this.initial ? this.initial[1] * this.maxSpeed : 0;\n    if (this.tooltip) {\n      this.ctitle = c.title;\n      c.title = '';\n      if (this.tooltip == 'native') {\n        this.Tooltip = this.TooltipNative;\n      } else {\n        this.Tooltip = this.TooltipDiv;\n        if (!this.ttdiv) {\n          this.ttdiv = doc.createElement('div');\n          this.ttdiv.className = this.tooltipClass;\n          this.ttdiv.style.position = 'absolute';\n          this.ttdiv.style.zIndex = c.style.zIndex + 1;\n          AddHandler('mouseover', function (e) {\n            e.target.style.display = 'none';\n          }, this.ttdiv);\n          doc.body.appendChild(this.ttdiv);\n        }\n      }\n    } else {\n      this.Tooltip = this.TooltipNone;\n    }\n    if (!this.noMouse && !handlers[cid]) {\n      handlers[cid] = [['mousemove', MouseMove], ['mouseout', MouseOut], ['mouseup', MouseUp], ['touchstart', TouchDown], ['touchend', TouchUp], ['touchcancel', TouchUp], ['touchmove', TouchMove]];\n      if (this.dragControl) {\n        handlers[cid].push(['mousedown', MouseDown]);\n        handlers[cid].push(['selectstart', Nop]);\n      }\n      if (this.wheelZoom) {\n        handlers[cid].push(['mousewheel', MouseWheel]);\n        handlers[cid].push(['DOMMouseScroll', MouseWheel]);\n      }\n      if (this.scrollPause) {\n        handlers[cid].push(['scroll', Scroll, window]);\n      }\n      for (i = 0; i < handlers[cid].length; ++i) {\n        p = handlers[cid][i];\n        AddHandler(p[0], p[1], p[2] ? p[2] : c);\n      }\n    }\n    if (!TagCanvas.started) {\n      TagCanvas.NextFrame = window.requestAnimationFrame ? NextFrameRAF : NextFrameTimeout;\n      TagCanvas.interval = this.interval;\n      TagCanvas.NextFrame(this.interval);\n      TagCanvas.started = 1;\n    }\n  }\n  TCproto = TagCanvas.prototype;\n  TCproto.SourceElements = function () {\n    if (doc.querySelectorAll) return doc.querySelectorAll('#' + this.source);\n    return [doc.getElementById(this.source)];\n  };\n  TCproto.HideTags = function () {\n    var el = this.SourceElements(),\n      i;\n    for (i = 0; i < el.length; ++i) el[i].style.display = 'none';\n  };\n  TCproto.GetTags = function () {\n    var el = this.SourceElements(),\n      etl,\n      tl = [],\n      i,\n      j,\n      k;\n    for (k = 0; k <= this.repeatTags; ++k) {\n      for (i = 0; i < el.length; ++i) {\n        etl = el[i].getElementsByTagName('a');\n        for (j = 0; j < etl.length; ++j) {\n          tl.push(etl[j]);\n        }\n      }\n    }\n    return tl;\n  };\n  TCproto.Message = function (text) {\n    var tl = [],\n      i,\n      p,\n      tc = text.split(''),\n      a,\n      t,\n      x,\n      z;\n    for (i = 0; i < tc.length; ++i) {\n      if (tc[i] != ' ') {\n        p = i - tc.length / 2;\n        a = doc.createElement('A');\n        a.href = '#';\n        a.innerText = tc[i];\n        x = 100 * sin(p / 9);\n        z = -100 * cos(p / 9);\n        t = new Tag(this, tc[i], a, [x, 0, z], 2, 18, '#000', '#fff', 0, 0, 0, 'monospace', 2, tc[i]);\n        t.Init();\n        tl.push(t);\n      }\n    }\n    return tl;\n  };\n  TCproto.AddAudio = function (e, t) {\n    if (audio === 'off') return;\n    var au = e.getElementsByTagName('audio');\n    if (au.length) {\n      t.SetAudio(au[0]);\n      this.hasAudio = 1;\n    }\n  };\n  TCproto.CreateTag = function (e) {\n    var im,\n      i,\n      t,\n      txt,\n      ts,\n      font,\n      bc,\n      boc,\n      p = [0, 0, 0],\n      au;\n    if ('text' != this.imageMode) {\n      im = e.getElementsByTagName('img');\n      if (im.length) {\n        i = new Image();\n        i.src = im[0].src;\n        if (!this.imageMode) {\n          t = new Tag(this, \"\", e, p, 0, 0);\n          t.SetImage(i);\n          //t.Init();\n          AddImage(i, im[0], im[1], t, this);\n          this.AddAudio(e, t);\n          return t;\n        }\n      }\n    }\n    if ('image' != this.imageMode) {\n      ts = new TextSplitter(e);\n      txt = ts.Lines();\n      if (!ts.Empty()) {\n        font = this.textFont || FixFont(GetProperty(e, 'font-family'));\n        if (this.splitWidth) txt = ts.SplitWidth(this.splitWidth, this.ctxt, font, this.textHeight);\n        bc = this.bgColour == 'tag' ? GetProperty(e, 'background-color') : this.bgColour;\n        boc = this.bgOutline == 'tag' ? GetProperty(e, 'color') : this.bgOutline;\n      } else {\n        ts = null;\n      }\n    }\n    if (ts || i) {\n      t = new Tag(this, txt, e, p, 2, this.textHeight + 2, this.textColour || GetProperty(e, 'color'), bc, this.bgRadius, boc, this.bgOutlineThickness, font, this.padding, ts && ts.original);\n      if (i) {\n        t.SetImage(i);\n        AddImage(i, im[0], im[1], t, this);\n      } else {\n        t.Init();\n      }\n      this.AddAudio(e, t);\n      return t;\n    }\n  };\n  TCproto.UpdateTag = function (t, a) {\n    var colour = this.textColour || GetProperty(a, 'color'),\n      font = this.textFont || FixFont(GetProperty(a, 'font-family')),\n      bc = this.bgColour == 'tag' ? GetProperty(a, 'background-color') : this.bgColour,\n      boc = this.bgOutline == 'tag' ? GetProperty(a, 'color') : this.bgOutline;\n    t.a = a;\n    t.title = a.title;\n    if (t.colour != colour || t.textFont != font || t.bgColour != bc || t.bgOutline != boc) t.SetFont(font, colour, bc, boc);\n  };\n  TCproto.Weight = function (tl) {\n    var ll = tl.length,\n      w,\n      i,\n      s,\n      weights = [],\n      valid,\n      wfrom = this.weightFrom ? this.weightFrom.split(/[, ]/) : [null],\n      wl = wfrom.length;\n    for (i = 0; i < ll; ++i) {\n      weights[i] = [];\n      for (s = 0; s < wl; ++s) {\n        w = FindWeight(tl[i].a, wfrom[s], this.textHeight);\n        if (!this.max_weight[s] || w > this.max_weight[s]) this.max_weight[s] = w;\n        if (!this.min_weight[s] || w < this.min_weight[s]) this.min_weight[s] = w;\n        weights[i][s] = w;\n      }\n    }\n    for (s = 0; s < wl; ++s) {\n      if (this.max_weight[s] > this.min_weight[s]) valid = 1;\n    }\n    if (valid) {\n      for (i = 0; i < ll; ++i) {\n        tl[i].SetWeight(weights[i]);\n      }\n    }\n  };\n  TCproto.Load = function () {\n    var tl = this.GetTags(),\n      taglist = [],\n      shape,\n      t,\n      shapeArgs,\n      rx,\n      ry,\n      rz,\n      vl,\n      i,\n      tagmap = [],\n      pfuncs = {\n        sphere: PointsOnSphere,\n        vcylinder: PointsOnCylinderV,\n        hcylinder: PointsOnCylinderH,\n        vring: PointsOnRingV,\n        hring: PointsOnRingH\n      };\n    if (tl.length) {\n      tagmap.length = tl.length;\n      for (i = 0; i < tl.length; ++i) tagmap[i] = i;\n      this.shuffleTags && Shuffle(tagmap);\n      rx = 100 * this.radiusX;\n      ry = 100 * this.radiusY;\n      rz = 100 * this.radiusZ;\n      this.max_radius = max(rx, max(ry, rz));\n      for (i = 0; i < tl.length; ++i) {\n        t = this.CreateTag(tl[tagmap[i]]);\n        if (t) taglist.push(t);\n      }\n      this.weight && this.Weight(taglist, true);\n      if (this.shapeArgs) {\n        this.shapeArgs[0] = taglist.length;\n      } else {\n        shapeArgs = this.shape.toString().split(/[(),]/);\n        shape = shapeArgs.shift();\n        if (typeof window[shape] === 'function') this.shape = window[shape];else this.shape = pfuncs[shape] || pfuncs.sphere;\n        this.shapeArgs = [taglist.length, rx, ry, rz].concat(shapeArgs);\n      }\n      vl = this.shape.apply(this, this.shapeArgs);\n      this.listLength = taglist.length;\n      for (i = 0; i < taglist.length; ++i) taglist[i].position = new Vector(vl[i][0], vl[i][1], vl[i][2]);\n    }\n    if (this.noTagsMessage && !taglist.length) {\n      i = this.imageMode && this.imageMode != 'both' ? this.imageMode + ' ' : '';\n      taglist = this.Message('No ' + i + 'tags');\n    }\n    this.taglist = taglist;\n  };\n  TCproto.Update = function () {\n    var tl = this.GetTags(),\n      newlist = [],\n      taglist = this.taglist,\n      found,\n      added = [],\n      removed = [],\n      vl,\n      ol,\n      nl,\n      i,\n      j;\n    if (!this.shapeArgs) return this.Load();\n    if (tl.length) {\n      nl = this.listLength = tl.length;\n      ol = taglist.length;\n\n      // copy existing list, populate \"removed\"\n      for (i = 0; i < ol; ++i) {\n        newlist.push(taglist[i]);\n        removed.push(i);\n      }\n\n      // find added and removed tags\n      for (i = 0; i < nl; ++i) {\n        for (j = 0, found = 0; j < ol; ++j) {\n          if (taglist[j].EqualTo(tl[i])) {\n            this.UpdateTag(newlist[j], tl[i]);\n            found = removed[j] = -1;\n          }\n        }\n        if (!found) added.push(i);\n      }\n\n      // clean out found tags from removed list\n      for (i = 0, j = 0; i < ol; ++i) {\n        if (removed[j] == -1) removed.splice(j, 1);else ++j;\n      }\n\n      // insert new tags in gaps where old tags removed\n      if (removed.length) {\n        Shuffle(removed);\n        while (removed.length && added.length) {\n          i = removed.shift();\n          j = added.shift();\n          newlist[i] = this.CreateTag(tl[j]);\n        }\n\n        // remove any more (in reverse order)\n        removed.sort(function (a, b) {\n          return a - b;\n        });\n        while (removed.length) {\n          newlist.splice(removed.pop(), 1);\n        }\n      }\n\n      // add any extra tags\n      j = newlist.length / (added.length + 1);\n      i = 0;\n      while (added.length) {\n        newlist.splice(ceil(++i * j), 0, this.CreateTag(tl[added.shift()]));\n      }\n\n      // assign correct positions to tags\n      this.shapeArgs[0] = nl = newlist.length;\n      vl = this.shape.apply(this, this.shapeArgs);\n      for (i = 0; i < nl; ++i) newlist[i].position = new Vector(vl[i][0], vl[i][1], vl[i][2]);\n\n      // reweight tags\n      this.weight && this.Weight(newlist);\n    }\n    this.taglist = newlist;\n  };\n  TCproto.SetShadow = function (c) {\n    c.shadowBlur = this.shadowBlur;\n    c.shadowOffsetX = this.shadowOffset[0];\n    c.shadowOffsetY = this.shadowOffset[1];\n  };\n  TCproto.LoadAudio = function () {\n    if (!audio && !SetupAudio()) return;\n    this.audio = doc.createElement('audio');\n    this.audio.src = this.activeAudio;\n    this.track = audio.createMediaElementSource(this.audio);\n    this.gain = audio.createGain();\n    this.track.connect(this.gain);\n    this.gain.connect(audio.destination);\n    this.hasAudio = 1;\n    audioClick = function (e) {\n      audio.resume();\n      doc.removeEventListener('click', audioClick);\n    };\n    doc.addEventListener('click', audioClick);\n  };\n  TCproto.ShowAudioIcon = function () {\n    var s = this.audioIconSize,\n      cv = this.canvas,\n      c = this.ctxt,\n      x = cv.width - s - 3,\n      y = cv.height - s - 3,\n      t = this.audioIconThickness,\n      c1 = '#000',\n      c2 = '#fff',\n      d = this.audioIconDark,\n      muted = this.audioOff,\n      sus = 'suspended';\n    if (!audio) return;\n    if (!muted) muted = audio.state === sus;\n    if (this.audioIcon && this.hasAudio) {\n      AudioIcon(muted, c, s, x, y, t + 1, d ? c2 : c1);\n      AudioIcon(muted, c, s, x, y, t, d ? c1 : c2);\n    }\n  };\n  TCproto.CheckAudioIcon = function () {\n    var s = this.audioIconSize,\n      cv = this.canvas,\n      t = this.audioIconThickness / 2,\n      x = cv.width - s - 3 - t,\n      y = cv.height - s - 3 - t;\n    if (this.audioIcon && this.mx >= x && this.my >= y) return true;\n  };\n  TCproto.ToggleAudio = function () {\n    var on = this.audioOff || audio && audio.state === 'suspended';\n    on || this.currentAudio && this.currentAudio.StopAudio();\n    this.audioOff = !on;\n  };\n  TCproto.Draw = function (t) {\n    if (this.paused) return;\n    var cv = this.canvas,\n      cw = cv.width,\n      ch = cv.height,\n      max_sc = 0,\n      tdelta = (t - this.time) * TagCanvas.interval / 1000,\n      x = cw / 2 + this.offsetX,\n      y = ch / 2 + this.offsetY,\n      c = this.ctxt,\n      active,\n      a,\n      i,\n      aindex = -1,\n      tl = this.taglist,\n      l = tl.length,\n      last = this.active && this.active.tag,\n      cursor = '',\n      frontsel = this.frontSelect,\n      centreDrawn = this.centreFunc == Nop,\n      fixed;\n    this.time = t;\n    if (this.frozen && this.drawn) return this.Animate(cw, ch, tdelta);\n    fixed = this.AnimateFixed();\n    c.setTransform(1, 0, 0, 1, 0, 0);\n    for (i = 0; i < l; ++i) tl[i].Calc(this.transform, this.fixedAlpha);\n    tl = SortList(tl, function (a, b) {\n      return b.z - a.z;\n    });\n    if (fixed && this.fixedAnim.active) {\n      active = this.fixedAnim.tag.UpdateActive(c, x, y);\n    } else {\n      this.active = null;\n      if (this.CheckAudioIcon()) {\n        cursor = 'pointer';\n      } else {\n        for (i = 0; i < l; ++i) {\n          a = this.mx >= 0 && this.my >= 0 && this.taglist[i].CheckActive(c, x, y);\n          if (a && a.sc > max_sc && (!frontsel || a.z <= 0)) {\n            active = a;\n            aindex = i;\n            active.tag = this.taglist[i];\n            max_sc = a.sc;\n          }\n        }\n        this.active = active;\n      }\n    }\n    this.txtOpt || this.shadow && this.SetShadow(c);\n    c.clearRect(0, 0, cw, ch);\n    for (i = 0; i < l; ++i) {\n      if (!centreDrawn && tl[i].z <= 0) {\n        // run the centreFunc if the next tag is at the front\n        try {\n          this.centreFunc(c, cw, ch, x, y);\n        } catch (e) {\n          alert(e);\n          // don't run it again\n          this.centreFunc = Nop;\n        }\n        centreDrawn = true;\n      }\n      if (!(active && active.tag == tl[i] && active.PreDraw(c, tl[i], x, y))) tl[i].Draw(c, x, y);\n      active && active.tag == tl[i] && active.PostDraw(c);\n    }\n    if (this.freezeActive && active) {\n      this.Freeze();\n    } else {\n      this.UnFreeze();\n      this.drawn = l == this.listLength;\n    }\n    if (this.fixedCallback) {\n      this.fixedCallback(this, this.fixedCallbackTag);\n      this.fixedCallback = null;\n    }\n    fixed || this.Animate(cw, ch, tdelta);\n    if (active) {\n      active.LastDraw(c);\n      if (active.tag != last) {\n        this.currentAudio && this.currentAudio != active.tag && this.currentAudio.StopAudio();\n        if (active.tag.PlayAudio()) this.currentAudio = active.tag;\n      }\n      cursor = this.activeCursor;\n    }\n    cv.style.cursor = cursor;\n    this.Tooltip(active, this.taglist[aindex]);\n    this.audioIcon && this.ShowAudioIcon();\n  };\n  TCproto.TooltipNone = function () {};\n  TCproto.TooltipNative = function (active, tag) {\n    if (active) this.canvas.title = tag && tag.title ? tag.title : '';else this.canvas.title = this.ctitle;\n  };\n  TCproto.SetTTDiv = function (title, tag) {\n    var tc = this,\n      s = tc.ttdiv.style;\n    if (title != tc.ttdiv.innerHTML) s.display = 'none';\n    tc.ttdiv.innerHTML = title;\n    tag && (tag.title = tc.ttdiv.innerHTML);\n    if (s.display == 'none' && !tc.tttimer) {\n      tc.tttimer = setTimeout(function () {\n        var p = AbsPos(tc.canvas.id);\n        s.display = 'block';\n        s.left = p.x + tc.mx + 'px';\n        s.top = p.y + tc.my + 24 + 'px';\n        tc.tttimer = null;\n      }, tc.tooltipDelay);\n    }\n  };\n  TCproto.TooltipDiv = function (active, tag) {\n    if (active && tag && tag.title) {\n      this.SetTTDiv(tag.title, tag);\n    } else if (!active && this.mx != -1 && this.my != -1 && this.ctitle.length) {\n      this.SetTTDiv(this.ctitle);\n    } else {\n      this.ttdiv.style.display = 'none';\n    }\n  };\n  TCproto.Transform = function (tc, p, y) {\n    if (p || y) {\n      var sp = sin(p),\n        cp = cos(p),\n        sy = sin(y),\n        cy = cos(y),\n        ym = new Matrix([cy, 0, sy, 0, 1, 0, -sy, 0, cy]),\n        pm = new Matrix([1, 0, 0, 0, cp, -sp, 0, sp, cp]);\n      tc.transform = tc.transform.mul(ym.mul(pm));\n    }\n  };\n  TCproto.AnimateFixed = function () {\n    var fa, t1, angle, m, d;\n    if (this.fadeIn) {\n      t1 = TimeNow() - this.startTime;\n      if (t1 >= this.fadeIn) {\n        this.fadeIn = 0;\n        this.fixedAlpha = 1;\n      } else {\n        this.fixedAlpha = t1 / this.fadeIn;\n      }\n    }\n    if (this.fixedAnim) {\n      if (!this.fixedAnim.transform) this.fixedAnim.transform = this.transform;\n      fa = this.fixedAnim, t1 = TimeNow() - fa.t0, angle = fa.angle, m, d = this.animTiming(fa.t, t1);\n      this.transform = fa.transform;\n      if (t1 >= fa.t) {\n        this.fixedCallbackTag = fa.tag;\n        this.fixedCallback = fa.cb;\n        this.fixedAnim = this.yaw = this.pitch = 0;\n      } else {\n        angle *= d;\n      }\n      m = Matrix.Rotation(angle, fa.axis);\n      this.transform = this.transform.mul(m);\n      return this.fixedAnim != 0;\n    }\n    return false;\n  };\n  TCproto.AnimatePosition = function (w, h, t) {\n    var tc = this,\n      x = tc.mx,\n      y = tc.my,\n      s,\n      r;\n    if (!tc.frozen && x >= 0 && y >= 0 && x < w && y < h) {\n      s = tc.maxSpeed, r = tc.reverse ? -1 : 1;\n      tc.lx || (tc.yaw = (x * 2 * s / w - s) * r * t);\n      tc.ly || (tc.pitch = (y * 2 * s / h - s) * -r * t);\n      tc.initial = null;\n    } else if (!tc.initial) {\n      if (tc.frozen && !tc.freezeDecel) tc.yaw = tc.pitch = 0;else tc.Decel(tc);\n    }\n    this.Transform(tc, tc.pitch, tc.yaw);\n  };\n  TCproto.AnimateDrag = function (w, h, t) {\n    var tc = this,\n      rs = 100 * t * tc.maxSpeed / tc.max_radius / tc.zoom;\n    if (tc.dx || tc.dy) {\n      tc.lx || (tc.yaw = tc.dx * rs / tc.stretchX);\n      tc.ly || (tc.pitch = tc.dy * -rs / tc.stretchY);\n      tc.dx = tc.dy = 0;\n      tc.initial = null;\n    } else if (!tc.initial) {\n      tc.Decel(tc);\n    }\n    this.Transform(tc, tc.pitch, tc.yaw);\n  };\n  TCproto.Freeze = function () {\n    if (!this.frozen) {\n      this.preFreeze = [this.yaw, this.pitch];\n      this.frozen = 1;\n      this.drawn = 0;\n    }\n  };\n  TCproto.UnFreeze = function () {\n    if (this.frozen) {\n      this.yaw = this.preFreeze[0];\n      this.pitch = this.preFreeze[1];\n      this.frozen = 0;\n    }\n  };\n  TCproto.Decel = function (tc) {\n    var s = tc.minSpeed,\n      ay = abs(tc.yaw),\n      ap = abs(tc.pitch);\n    if (!tc.lx && ay > s) tc.yaw = ay > tc.z0 ? tc.yaw * tc.decel : 0;\n    if (!tc.ly && ap > s) tc.pitch = ap > tc.z0 ? tc.pitch * tc.decel : 0;\n  };\n  TCproto.Zoom = function (r) {\n    this.z2 = this.z1 * (1 / r);\n    this.drawn = 0;\n  };\n  TCproto.Clicked = function (e) {\n    if (this.CheckAudioIcon()) {\n      this.ToggleAudio();\n      return;\n    }\n    var a = this.active;\n    try {\n      if (a && a.tag) if (this.clickToFront === false || this.clickToFront === null) a.tag.Clicked(e);else this.TagToFront(a.tag, this.clickToFront, function () {\n        a.tag.Clicked(e);\n      }, true);\n    } catch (ex) {}\n  };\n  TCproto.Wheel = function (i) {\n    var z = this.zoom + this.zoomStep * (i ? 1 : -1);\n    this.zoom = min(this.zoomMax, max(this.zoomMin, z));\n    this.Zoom(this.zoom);\n  };\n  TCproto.BeginDrag = function (e) {\n    this.down = EventXY(e, this.canvas);\n    e.cancelBubble = true;\n    e.returnValue = false;\n    e.preventDefault && e.preventDefault();\n  };\n  TCproto.Drag = function (e, p) {\n    if (this.dragControl && this.down) {\n      var t2 = this.dragThreshold * this.dragThreshold,\n        dx = p.x - this.down.x,\n        dy = p.y - this.down.y;\n      if (this.dragging || dx * dx + dy * dy > t2) {\n        this.dx = dx;\n        this.dy = dy;\n        this.dragging = 1;\n        this.down = p;\n      }\n    }\n    return this.dragging;\n  };\n  TCproto.EndDrag = function () {\n    var res = this.dragging;\n    this.dragging = this.down = null;\n    return res;\n  };\n  function PinchDistance(e) {\n    var t1 = e.targetTouches[0],\n      t2 = e.targetTouches[1];\n    return sqrt(pow(t2.pageX - t1.pageX, 2) + pow(t2.pageY - t1.pageY, 2));\n  }\n  TCproto.BeginPinch = function (e) {\n    this.pinched = [PinchDistance(e), this.zoom];\n    e.preventDefault && e.preventDefault();\n  };\n  TCproto.Pinch = function (e) {\n    var z,\n      d,\n      p = this.pinched;\n    if (!p) return;\n    d = PinchDistance(e);\n    z = p[1] * d / p[0];\n    this.zoom = min(this.zoomMax, max(this.zoomMin, z));\n    this.Zoom(this.zoom);\n  };\n  TCproto.EndPinch = function (e) {\n    this.pinched = null;\n  };\n  TCproto.Pause = function () {\n    this.paused = true;\n  };\n  TCproto.Resume = function () {\n    this.paused = false;\n  };\n  TCproto.SetSpeed = function (i) {\n    this.initial = i;\n    this.yaw = i[0] * this.maxSpeed;\n    this.pitch = i[1] * this.maxSpeed;\n  };\n  TCproto.FindTag = function (t) {\n    if (!Defined(t)) return null;\n    Defined(t.index) && (t = t.index);\n    if (!IsObject(t)) return this.taglist[t];\n    var srch, tgt, i;\n    if (Defined(t.id)) srch = 'id', tgt = t.id;else if (Defined(t.text)) srch = 'innerText', tgt = t.text;\n    for (i = 0; i < this.taglist.length; ++i) if (this.taglist[i].a[srch] == tgt) return this.taglist[i];\n  };\n  TCproto.RotateTag = function (tag, lt, lg, time, callback, active) {\n    var t = tag.Calc(this.transform, 1),\n      v1 = new Vector(t.x, t.y, t.z),\n      v2 = MakeVector(lg, lt),\n      angle = v1.angle(v2),\n      u = v1.cross(v2).unit();\n    if (angle == 0) {\n      this.fixedCallbackTag = tag;\n      this.fixedCallback = callback;\n    } else {\n      this.fixedAnim = {\n        angle: -angle,\n        axis: u,\n        t: time,\n        t0: TimeNow(),\n        cb: callback,\n        tag: tag,\n        active: active\n      };\n    }\n  };\n  TCproto.TagToFront = function (tag, time, callback, active) {\n    this.RotateTag(tag, 0, 0, time, callback, active);\n  };\n  TCproto.Volume = function (vol) {\n    this.audioVolume = vol * 1;\n  };\n  TagCanvas.Start = function (id, l, o) {\n    TagCanvas.Delete(id);\n    TagCanvas.tc[id] = new TagCanvas(id, l, o);\n  };\n  function tccall(f, id) {\n    TagCanvas.tc[id] && TagCanvas.tc[id][f]();\n  }\n  TagCanvas.Linear = function (t, t0) {\n    return t0 / t;\n  };\n  TagCanvas.Smooth = function (t, t0) {\n    return 0.5 - cos(t0 * Math.PI / t) / 2;\n  };\n  TagCanvas.Pause = function (id) {\n    tccall('Pause', id);\n  };\n  TagCanvas.Resume = function (id) {\n    tccall('Resume', id);\n  };\n  TagCanvas.Reload = function (id) {\n    tccall('Load', id);\n  };\n  TagCanvas.Update = function (id) {\n    tccall('Update', id);\n  };\n  TagCanvas.SetSpeed = function (id, speed) {\n    if (IsObject(speed) && TagCanvas.tc[id] && !isNaN(speed[0]) && !isNaN(speed[1])) {\n      TagCanvas.tc[id].SetSpeed(speed);\n      return true;\n    }\n    return false;\n  };\n  TagCanvas.TagToFront = function (id, options) {\n    if (!IsObject(options)) return false;\n    options.lat = options.lng = 0;\n    return TagCanvas.RotateTag(id, options);\n  };\n  TagCanvas.RotateTag = function (id, options) {\n    if (IsObject(options) && TagCanvas.tc[id]) {\n      if (isNaN(options.time)) options.time = 500;\n      var tt = TagCanvas.tc[id].FindTag(options);\n      if (tt) {\n        TagCanvas.tc[id].RotateTag(tt, options.lat, options.lng, options.time, options.callback, options.active);\n        return true;\n      }\n    }\n    return false;\n  };\n  TagCanvas.Delete = function (id) {\n    var i, c;\n    if (handlers[id]) {\n      c = doc.getElementById(id);\n      if (c) {\n        for (i = 0; i < handlers[id].length; ++i) RemoveHandler(handlers[id][i][0], handlers[id][i][1], c);\n      }\n    }\n    delete handlers[id];\n    delete TagCanvas.tc[id];\n  };\n  TagCanvas.tc = {};\n  TagCanvas.options = {\n    z1: 20000,\n    z2: 20000,\n    z0: 0.0002,\n    freezeActive: false,\n    freezeDecel: false,\n    activeCursor: 'pointer',\n    pulsateTo: 1,\n    pulsateTime: 3,\n    reverse: false,\n    depth: 0.5,\n    maxSpeed: 0.05,\n    minSpeed: 0,\n    decel: 0.95,\n    interval: 20,\n    minBrightness: 0.1,\n    maxBrightness: 1,\n    outlineColour: '#ffff99',\n    outlineThickness: 2,\n    outlineOffset: 5,\n    outlineMethod: 'outline',\n    outlineRadius: 0,\n    textColour: '#ff99ff',\n    textHeight: 15,\n    textFont: 'Helvetica, Arial, sans-serif',\n    shadow: '#000',\n    shadowBlur: 0,\n    shadowOffset: [0, 0],\n    initial: null,\n    hideTags: true,\n    zoom: 1,\n    weight: false,\n    weightMode: 'size',\n    weightFrom: null,\n    weightSize: 1,\n    weightSizeMin: null,\n    weightSizeMax: null,\n    weightGradient: {\n      0: '#f00',\n      0.33: '#ff0',\n      0.66: '#0f0',\n      1: '#00f'\n    },\n    txtOpt: true,\n    txtScale: 2,\n    frontSelect: false,\n    wheelZoom: true,\n    zoomMin: 0.3,\n    zoomMax: 3,\n    zoomStep: 0.05,\n    shape: 'sphere',\n    lock: null,\n    tooltip: null,\n    tooltipDelay: 300,\n    tooltipClass: 'tctooltip',\n    radiusX: 1,\n    radiusY: 1,\n    radiusZ: 1,\n    stretchX: 1,\n    stretchY: 1,\n    offsetX: 0,\n    offsetY: 0,\n    shuffleTags: false,\n    noSelect: false,\n    noMouse: false,\n    imageScale: 1,\n    paused: false,\n    dragControl: false,\n    dragThreshold: 4,\n    centreFunc: Nop,\n    splitWidth: 0,\n    animTiming: 'Smooth',\n    clickToFront: false,\n    fadeIn: 0,\n    padding: 0,\n    bgColour: null,\n    bgRadius: 0,\n    bgOutline: null,\n    bgOutlineThickness: 0,\n    outlineIncrease: 4,\n    textAlign: 'centre',\n    textVAlign: 'middle',\n    imageMode: null,\n    imagePosition: null,\n    imagePadding: 2,\n    imageAlign: 'centre',\n    imageVAlign: 'middle',\n    noTagsMessage: true,\n    centreImage: null,\n    pinchZoom: false,\n    repeatTags: 0,\n    minTags: 0,\n    imageRadius: 0,\n    scrollPause: false,\n    outlineDash: 0,\n    outlineDashSpace: 0,\n    outlineDashSpeed: 1,\n    activeAudio: '',\n    audioVolume: 1,\n    audioIcon: 1,\n    audioIconSize: 20,\n    audioIconThickness: 2,\n    audioIconDark: 0,\n    altImage: 0\n  };\n  for (i in TagCanvas.options) TagCanvas[i] = TagCanvas.options[i];\n  window.TagCanvas = TagCanvas;\n  jQuery.fn.tagcanvas = function (options, lctr) {\n    var fn = {\n      pause: function () {\n        $(this).each(function () {\n          tccall('Pause', $(this)[0].id);\n        });\n      },\n      resume: function () {\n        $(this).each(function () {\n          tccall('Resume', $(this)[0].id);\n        });\n      },\n      reload: function () {\n        $(this).each(function () {\n          tccall('Load', $(this)[0].id);\n        });\n      },\n      update: function () {\n        $(this).each(function () {\n          tccall('Update', $(this)[0].id);\n        });\n      },\n      tagtofront: function () {\n        $(this).each(function () {\n          TagCanvas.TagToFront($(this)[0].id, lctr);\n        });\n      },\n      rotatetag: function () {\n        $(this).each(function () {\n          TagCanvas.RotateTag($(this)[0].id, lctr);\n        });\n      },\n      'delete': function () {\n        $(this).each(function () {\n          TagCanvas.Delete($(this)[0].id);\n        });\n      },\n      setspeed: function () {\n        $(this).each(function () {\n          TagCanvas.SetSpeed($(this)[0].id, lctr);\n        });\n      }\n    };\n    if (typeof options == 'string' && fn[options]) {\n      fn[options].apply(this);\n      return this;\n    } else {\n      TagCanvas.jquery = 1;\n      $(this).each(function () {\n        TagCanvas.Start($(this)[0].id, lctr, options);\n      });\n      return TagCanvas.started;\n    }\n  };\n\n  // set a flag for when the window has loaded\n  AddHandler('load', function () {\n    TagCanvas.loaded = 1;\n  }, window);\n})(jQuery);","map":{"version":3,"names":["$","i","j","abs","Math","sin","cos","max","min","ceil","sqrt","pow","hexlookup3","hexlookup2","hexlookup1","a","A","b","B","c","C","d","D","e","E","f","F","Oproto","Tproto","TCproto","Mproto","Vproto","TSproto","TCVproto","doc","document","ocanvas","audio","audioClick","handlers","toString","toUpperCase","Defined","IsObject","o","Clamp","v","mn","mx","isNaN","Nop","TimeNow","Date","valueOf","SortList","l","nl","tl","length","push","sort","Shuffle","t","p","random","SetupAudio","ac","window","AudioContext","webkitAudioContext","AudioIcon","mute","size","offsetx","offsety","stroke","colour","x","y","s","w","h","x2","x1","y3","y2","y1","y4","setTransform","setLineDash","globalAlpha","strokeStyle","lineWidth","lineJoin","beginPath","moveTo","lineTo","closePath","Vector","z","prototype","dot","cross","angle","PI","acos","unit","MakeVector","lg","lt","Matrix","Identity","Rotation","u","sina","cosa","mcos","mul","m","mmatrix","xform","PointsOnSphere","n","xr","yr","zr","magic","r","phi","pts","off","inc","parseFloat","Cylinder","k","Ring","PointsOnCylinderV","PointsOnCylinderH","PointsOnRingV","offset","PointsOnRingH","CentreImage","Image","onload","dx","width","dy","height","centreFunc","cx","cy","drawImage","src","centreImage","SetAlpha","p1","p2","ae","toPrecision","substr","replace","lastIndexOf","indexOf","substring","NewCanvas","G_vmlCanvasManager","createElement","ShadowAlphaBroken","cv","getContext","shadowColor","shadowBlur","strokeRect","getImageData","data","SetGradient","g","gd","createLinearGradient","addColorStop","fillStyle","fillRect","FindGradientColour","tc","gl","weightGradient","gCanvas","TextSet","ctxt","font","strings","padx","pady","shadowColour","shadowOffsets","maxWidth","widths","align","xo","yo","xc","textBaseline","shadowOffsetX","shadowOffsetY","fillText","parseInt","RRect","arcTo","TextCanvas","stringWidths","valign","scale","SetImage","image","position","padding","iwidth","iheight","ipos","ipad","iscale","ialign","ivalign","Align","space","pos","Create","bgColour","bgOutline","bgOutlineThickness","radius","cw","ch","offx","offy","ix","iy","iw","ih","rr","sox","soy","shadowcv","shadowc","ExpandImage","ScaleImage","AddBackgroundToImage","othickness","ocolour","ofill","cc","globalCompositeOperation","RoundImage","r1","arc","fill","AddShadowToImage","sc","sb","so","sw","sh","FindTextBoundingBox","ht","idata","w1","h1","ex","FixFont","AddHandler","addEventListener","attachEvent","RemoveHandler","removeEventListener","detachEvent","AddImage","alt","imageScale","mscale","ic","bc","oc","complete","txtOpt","zoomMax","txtScale","naturalWidth","naturalHeight","fimage","imageRadius","HasText","shadow","shadowOffset","GetProperty","textColour","outlineMethod","outline","bgRadius","oimage","outlineIncrease","Init","dv","defaultView","pc","charAt","getComputedStyle","getPropertyValue","currentStyle","FindWeight","wFrom","tHeight","getAttribute","EventToCanvasId","target","id","srcElement","parentNode","EventXY","xy","xmul","ymul","offsetX","offsetY","AbsPos","changedTouches","pageX","pageY","MouseOut","fromElement","TagCanvas","my","UnFreeze","EndDrag","MouseMove","tg","tttimer","clearTimeout","canvas","Drag","drawn","MouseDown","cb","button","BeginDrag","MouseUp","touchState","Clicked","TouchDown","touches","targetTouches","pinchZoom","BeginPinch","EndPinch","TouchUp","Draw","TouchMove","Pinch","MouseWheel","cancelBubble","returnValue","preventDefault","Wheel","wheelDelta","detail","Scroll","scrollTimer","Pause","setTimeout","Resume","scrollPause","DrawCanvas","DrawCanvasRAF","NextFrame","interval","NextFrameRAF","requestAnimationFrame","NextFrameTimeout","iv","getElementById","getBoundingClientRect","dd","documentElement","body","xs","pageXOffset","scrollLeft","ys","pageYOffset","scrollTop","clientLeft","clientTop","left","top","Project","sx","sy","z1","z2","TextSplitter","br","line","text","original","innerText","textContent","Empty","Lines","cn","cl","childNodes","nodeName","join","nodeType","nodeValue","SplitWidth","words","split","measureText","Outline","ts","tag","pulse","pulsate","pulsateTo","outlineColour","adash","outlineDash","agap","outlineDashSpace","aspeed","outlineDashSpeed","DrawPulsate","DrawSimple","outlineRadius","SetMethod","altImage","om","methods","block","classic","none","funcs","drawFunc","RealPreDraw","PreDraw","DrawAlt","Update","outlineOffset","o2","Ants","l1","l2","g1","g2","seq","ants","DrawOutline","DrawSize","tw","th","oscale","alpha","DrawColour","DrawColourText","normal","DrawColourImage","ccanvas","fx","fy","fw","fh","clearRect","save","rect","clip","restore","ga","useGa","DrawImage","DrawBlock","outlineThickness","diff","pulsateTime","Smooth","Active","PostDraw","LastDraw","Tag","col","bcol","bradius","boutline","bothickness","text_original","line_widths","title","textFont","weighted","weight","textHeight","Measure","SetShadowColour","shadowAlpha","SetShadowColourAlpha","SetShadowColourFixed","SetDraw","EqualTo","getElementsByTagName","href","SetAudio","load","ie","DrawImageIE","DrawText","noSelect","CheckActive","MeasureText","wl","extents","soff","twidth","theight","img","tcv","textAlign","textVAlign","imagePosition","imagePadding","imageAlign","imageVAlign","SetFont","boc","SetWeight","modes","weightMode","Weight","min_weight","max_weight","wmin","wmax","wnum","nweight","weightSizeMin","weightSizeMax","weightSize","xoff","yoff","xl","im","Calc","pp","mnb","minBrightness","mxb","maxBrightness","max_radius","xformed","stretchX","stretchY","UpdateActive","evt","self","frames","location","err","open","createEvent","initMouseEvent","dispatchEvent","fireEvent","StopAudio","playing","pause","stopped","PlayAudio","audioOff","gain","sus","track","createMediaElementSource","createGain","connect","destination","paused","state","resume","value","audioVolume","currentTime","play","undefined","then","cid","lctr","opt","cp","initElement","navigator","appVersion","insertBefore","removeChild","options","depth","zoom","lx","lock","ly","frozen","fixedAnim","fixedAlpha","source","repeatTags","minTags","GetTags","transform","startTime","time","Animate","dragControl","AnimateDrag","AnimatePosition","animTiming","activeAudio","LoadAudio","Load","hideTags","loaded","HideTags","yaw","initial","maxSpeed","pitch","tooltip","ctitle","Tooltip","TooltipNative","TooltipDiv","ttdiv","className","tooltipClass","style","zIndex","display","appendChild","TooltipNone","noMouse","wheelZoom","started","SourceElements","querySelectorAll","el","etl","Message","AddAudio","au","hasAudio","CreateTag","txt","imageMode","splitWidth","UpdateTag","ll","weights","valid","wfrom","weightFrom","taglist","shape","shapeArgs","rx","ry","rz","vl","tagmap","pfuncs","sphere","vcylinder","hcylinder","vring","hring","shuffleTags","radiusX","radiusY","radiusZ","shift","concat","apply","listLength","noTagsMessage","newlist","found","added","removed","ol","splice","pop","SetShadow","ShowAudioIcon","audioIconSize","audioIconThickness","c1","c2","audioIconDark","muted","audioIcon","CheckAudioIcon","ToggleAudio","on","currentAudio","max_sc","tdelta","active","aindex","last","cursor","frontsel","frontSelect","centreDrawn","fixed","AnimateFixed","alert","freezeActive","Freeze","fixedCallback","fixedCallbackTag","activeCursor","SetTTDiv","innerHTML","tooltipDelay","Transform","sp","ym","pm","fa","t1","fadeIn","t0","axis","reverse","freezeDecel","Decel","rs","preFreeze","minSpeed","ay","ap","z0","decel","Zoom","clickToFront","TagToFront","zoomStep","zoomMin","down","t2","dragThreshold","dragging","res","PinchDistance","pinched","SetSpeed","FindTag","index","srch","tgt","RotateTag","callback","v1","v2","Volume","vol","Start","Delete","tccall","Linear","Reload","speed","lat","lng","tt","jQuery","fn","tagcanvas","each","reload","update","tagtofront","rotatetag","delete","setspeed","jquery"],"sources":["C:/Users/VARSHIL/Desktop/varshil_portfolio/src/components/technology/jquery.tagcanvas.js"],"sourcesContent":["/**\r\n * Copyright (C) 2010-2021 Graham Breach\r\n *\r\n * This program is free software: you can redistribute it and/or modify\r\n * it under the terms of the GNU Lesser General Public License as published by\r\n * the Free Software Foundation, either version 3 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU Lesser General Public License for more details.\r\n * \r\n * You should have received a copy of the GNU Lesser General Public License\r\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n */\r\n/**\r\n * jQuery.tagcanvas 2.11\r\n * For more information, please contact <graham@goat1000.com>\r\n */\r\n(function($){\r\n  \"use strict\";\r\n  var i, j, abs = Math.abs, sin = Math.sin, cos = Math.cos, max = Math.max,\r\n    min = Math.min, ceil = Math.ceil, sqrt = Math.sqrt, pow = Math.pow,\r\n    hexlookup3 = {}, hexlookup2 = {}, hexlookup1 = {\r\n    0:\"0,\",   1:\"17,\",  2:\"34,\",  3:\"51,\",  4:\"68,\",  5:\"85,\",\r\n    6:\"102,\", 7:\"119,\", 8:\"136,\", 9:\"153,\", a:\"170,\", A:\"170,\",\r\n    b:\"187,\", B:\"187,\", c:\"204,\", C:\"204,\", d:\"221,\", D:\"221,\",\r\n    e:\"238,\", E:\"238,\", f:\"255,\", F:\"255,\"  \r\n    }, Oproto, Tproto, TCproto, Mproto, Vproto, TSproto, TCVproto,\r\n    doc = document, ocanvas, audio, audioClick, handlers = {};\r\n  for(i = 0; i < 256; ++i) {\r\n    j = i.toString(16);\r\n    if(i < 16)\r\n      j = '0' + j;\r\n    hexlookup2[j] = hexlookup2[j.toUpperCase()] = i.toString() + ',';\r\n  }\r\n  function Defined(d) {\r\n    return typeof d != 'undefined';\r\n  }\r\n  function IsObject(o) {\r\n    return typeof o == 'object' && o != null;\r\n  }\r\n  function Clamp(v, mn, mx) {\r\n    return isNaN(v) ? mx : min(mx, max(mn, v));\r\n  }\r\n  function Nop() {\r\n    return false;\r\n  }\r\n  function TimeNow() {\r\n    return new Date().valueOf();\r\n  }\r\n  function SortList(l, f) {\r\n    var nl = [], tl = l.length, i;\r\n    for(i = 0; i < tl; ++i)\r\n      nl.push(l[i]);\r\n    nl.sort(f);\r\n    return nl;\r\n  }\r\n  function Shuffle(a) {\r\n    var i = a.length-1, t, p;\r\n    while(i) {\r\n      p = ~~(Math.random()*i);\r\n      t = a[i];\r\n      a[i] = a[p];\r\n      a[p] = t;\r\n      --i;\r\n    }\r\n  }\r\n  function SetupAudio() {\r\n    var ac = window.AudioContext || window.webkitAudioContext;\r\n    audio = new ac();\r\n    if(!audio) {\r\n      audio = 'off';\r\n      return;\r\n    }\r\n    return audio;\r\n  }\r\n  function AudioIcon(mute,c,size,offsetx,offsety,stroke,colour) {\r\n    var x = offsetx, y = offsety, s = size * 0.01, w = 80 * s, h = 100 * s, d = 40 * s, e = 30 * s;\r\n    var f = e / 2;\r\n    var x2 = x + w, x1 = x2 - d;\r\n    var y3 = y + h, y2 = y3 - e, y1 = y + e, y4 = y + h / 2;\r\n    c.setTransform(1, 0, 0, 1, 0, 0);\r\n    c.setLineDash([]);\r\n    c.globalAlpha = 1;\r\n    c.strokeStyle = colour;\r\n    c.lineWidth = stroke;\r\n    c.lineJoin = 'round';\r\n    c.beginPath();\r\n    c.moveTo(x1, y1);\r\n    c.lineTo(x1, y2);\r\n    c.moveTo(x2, y3);\r\n    c.lineTo(x1, y2);\r\n    c.lineTo(x, y2);\r\n    c.lineTo(x, y1);\r\n    c.lineTo(x1, y1);\r\n    c.lineTo(x2, y);\r\n    if(mute) {\r\n      c.lineTo(x2, y1);\r\n      c.moveTo(x2, y2);\r\n      c.lineTo(x2, y3);\r\n      c.moveTo(x2 - f, y4 - f);\r\n      c.lineTo(x2 + f, y4 + f);\r\n      c.moveTo(x2 + f, y4 - f);\r\n      c.lineTo(x2 - f, y4 + f);\r\n      c.stroke();\r\n      return;\r\n    }\r\n    c.closePath();\r\n    c.stroke();\r\n  }\r\n  function Vector(x, y, z) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.z = z;\r\n  }\r\n  Vproto = Vector.prototype;\r\n  Vproto.length = function() {\r\n    return sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n  };\r\n  Vproto.dot = function(v) {\r\n    return this.x * v.x + this.y * v.y + this.z * v.z;\r\n  };\r\n  Vproto.cross = function(v) {\r\n    var x = this.y * v.z - this.z * v.y,\r\n      y = this.z * v.x - this.x * v.z,\r\n      z = this.x * v.y - this.y * v.x;\r\n    return new Vector(x, y, z);\r\n  };\r\n  Vproto.angle = function(v) {\r\n    var dot = this.dot(v), ac;\r\n    if(dot == 0)\r\n      return Math.PI / 2.0;\r\n    ac = dot / (this.length() * v.length());\r\n    if(ac >= 1)\r\n      return 0;\r\n    if(ac <= -1)\r\n      return Math.PI;\r\n    return Math.acos(ac);\r\n  };\r\n  Vproto.unit = function() {\r\n    var l = this.length();\r\n    return new Vector(this.x / l, this.y / l, this.z / l);\r\n  };\r\n  function MakeVector(lg, lt) {\r\n    lt = lt * Math.PI / 180;\r\n    lg = lg * Math.PI / 180;\r\n    var x = sin(lg) * cos(lt), y = -sin(lt), z = -cos(lg) * cos(lt);\r\n    return new Vector(x, y, z);\r\n  }\r\n  function Matrix(a) {\r\n    this[1] = {1: a[0],  2: a[1],  3: a[2]};\r\n    this[2] = {1: a[3],  2: a[4],  3: a[5]};\r\n    this[3] = {1: a[6],  2: a[7],  3: a[8]};\r\n  }\r\n  Mproto = Matrix.prototype;\r\n  Matrix.Identity = function() {\r\n    return new Matrix([1,0,0, 0,1,0, 0,0,1]);\r\n  };\r\n  Matrix.Rotation = function(angle, u) {\r\n    var sina = sin(angle), cosa = cos(angle), mcos = 1 - cosa;\r\n    return new Matrix([\r\n      cosa + pow(u.x, 2) * mcos, u.x * u.y * mcos - u.z * sina, u.x * u.z * mcos + u.y * sina,\r\n      u.y * u.x * mcos + u.z * sina, cosa + pow(u.y, 2) * mcos, u.y * u.z * mcos - u.x * sina,\r\n      u.z * u.x * mcos - u.y * sina, u.z * u.y * mcos + u.x * sina, cosa + pow(u.z, 2) * mcos\r\n    ]);\r\n  }\r\n  Mproto.mul = function(m) {\r\n    var a = [], i, j, mmatrix = (m.xform ? 1 : 0);\r\n    for(i = 1; i <= 3; ++i)\r\n      for(j = 1; j <= 3; ++j) {\r\n        if(mmatrix)\r\n          a.push(this[i][1] * m[1][j] +\r\n            this[i][2] * m[2][j] +\r\n            this[i][3] * m[3][j]);\r\n        else\r\n          a.push(this[i][j] * m);\r\n      }\r\n    return new Matrix(a);\r\n  };\r\n  Mproto.xform = function(p) {\r\n    var a = {}, x = p.x, y = p.y, z = p.z;\r\n    a.x = x * this[1][1] + y * this[2][1] + z * this[3][1];\r\n    a.y = x * this[1][2] + y * this[2][2] + z * this[3][2];\r\n    a.z = x * this[1][3] + y * this[2][3] + z * this[3][3];\r\n    return a;\r\n  };\r\n  function PointsOnSphere(n,xr,yr,zr,magic) {\r\n    var i, y, r, phi, pts = [], off = 2/n, inc;\r\n    inc = Math.PI * (3 - sqrt(5) + (parseFloat(magic) ? parseFloat(magic) : 0));\r\n    for(i = 0; i < n; ++i) {\r\n      y = i * off - 1 + (off / 2);\r\n      r = sqrt(1 - y*y);\r\n      phi = i * inc;\r\n      pts.push([cos(phi) * r * xr, y * yr, sin(phi) * r * zr]);\r\n    }\r\n    return pts;\r\n  }\r\n  function Cylinder(n,o,xr,yr,zr,magic) {\r\n    var phi, pts = [], off = 2/n, inc, i, j, k, l;\r\n    inc = Math.PI * (3 - sqrt(5) + (parseFloat(magic) ? parseFloat(magic) : 0));\r\n    for(i = 0; i < n; ++i) {\r\n      j = i * off - 1 + (off / 2);\r\n      phi = i * inc;\r\n      k = cos(phi);\r\n      l = sin(phi);\r\n      pts.push(o ? [j * xr, k * yr, l * zr] : [k * xr, j * yr, l * zr]);\r\n    }\r\n    return pts;\r\n  }\r\n  function Ring(o, n, xr, yr, zr, j) {\r\n    var phi, pts = [], inc = Math.PI * 2 / n, i, k, l;\r\n    for(i = 0; i < n; ++i) {\r\n      phi = i * inc;\r\n      k = cos(phi);\r\n      l = sin(phi);\r\n      pts.push(o ? [j * xr, k * yr, l * zr] : [k * xr, j * yr, l * zr]);\r\n    }\r\n    return pts;\r\n  }\r\n  function PointsOnCylinderV(n,xr,yr,zr,m) { return Cylinder(n, 0, xr, yr, zr, m) }\r\n  function PointsOnCylinderH(n,xr,yr,zr,m) { return Cylinder(n, 1, xr, yr, zr, m) }\r\n  function PointsOnRingV(n, xr, yr, zr, offset) {\r\n    offset = isNaN(offset) ? 0 : offset * 1;\r\n    return Ring(0, n, xr, yr, zr, offset);\r\n  }\r\n  function PointsOnRingH(n, xr, yr, zr, offset) {\r\n    offset = isNaN(offset) ? 0 : offset * 1;\r\n    return Ring(1, n, xr, yr, zr, offset);\r\n  }\r\n  function CentreImage(t) {\r\n    var i = new Image;\r\n    i.onload = function() {\r\n      var dx = i.width / 2, dy = i.height / 2;\r\n      t.centreFunc = function(c, w, h, cx, cy) {\r\n        c.setTransform(1, 0, 0, 1, 0, 0);\r\n        c.globalAlpha = 1;\r\n        c.drawImage(i, cx - dx, cy - dy);\r\n      };\r\n    };\r\n    i.src = t.centreImage;\r\n  }\r\n  function SetAlpha(c,a) {\r\n    var d = c, p1, p2, ae = (a*1).toPrecision(3) + ')';\r\n    if(c[0] === '#') {\r\n      if(!hexlookup3[c])\r\n        if(c.length === 4)\r\n          hexlookup3[c] = 'rgba(' + hexlookup1[c[1]] + hexlookup1[c[2]] + hexlookup1[c[3]];\r\n        else\r\n          hexlookup3[c] = 'rgba(' + hexlookup2[c.substr(1,2)] + hexlookup2[c.substr(3,2)] + hexlookup2[c.substr(5,2)];\r\n      d = hexlookup3[c] + ae;\r\n    } else if(c.substr(0,4) === 'rgb(' || c.substr(0,4) === 'hsl(') {\r\n      d = (c.replace('(','a(').replace(')', ',' + ae));\r\n    } else if(c.substr(0,5) === 'rgba(' || c.substr(0,5) === 'hsla(') {\r\n      p1 = c.lastIndexOf(',') + 1, p2 = c.indexOf(')');\r\n      a *= parseFloat(c.substring(p1,p2));\r\n      d = c.substr(0,p1) + a.toPrecision(3) + ')';\r\n    }\r\n    return d;\r\n  }\r\n  function NewCanvas(w,h) {\r\n    // if using excanvas, give up now\r\n    if(window.G_vmlCanvasManager)\r\n      return null;\r\n    var c = doc.createElement('canvas');\r\n    c.width = w;\r\n    c.height = h;\r\n    return c;\r\n  }\r\n  // I think all browsers pass this test now...\r\n  function ShadowAlphaBroken() {\r\n    var cv = NewCanvas(3,3), c, i;\r\n    if(!cv)\r\n      return false;\r\n    c = cv.getContext('2d');\r\n    c.strokeStyle = '#000';\r\n    c.shadowColor = '#fff';\r\n    c.shadowBlur = 3;\r\n    c.globalAlpha = 0;\r\n    c.strokeRect(2,2,2,2);\r\n    c.globalAlpha = 1;\r\n    i = c.getImageData(2,2,1,1);\r\n    cv = null;\r\n    return (i.data[0] > 0);\r\n  }\r\n  function SetGradient(c, l, o, g) {\r\n    var gd = c.createLinearGradient(0, 0, l, 0), i;\r\n    for(i in g)\r\n      gd.addColorStop(1 - i, g[i]);\r\n    c.fillStyle = gd;\r\n    c.fillRect(0, o, l, 1);\r\n  }\r\n  function FindGradientColour(tc, p, r) {\r\n    var l = 1024, h = 1, gl = tc.weightGradient, cv, c, i, d;\r\n    if(tc.gCanvas) {\r\n      c = tc.gCanvas.getContext('2d');\r\n      h = tc.gCanvas.height;\r\n    } else {\r\n      if(IsObject(gl[0]))\r\n        h = gl.length;\r\n      else\r\n        gl = [gl];\r\n      tc.gCanvas = cv = NewCanvas(l, h);\r\n      if(!cv)\r\n        return null;\r\n      c = cv.getContext('2d');\r\n      for(i = 0; i < h; ++i)\r\n        SetGradient(c, l, i, gl[i]);\r\n    }\r\n    r = max(min(r || 0, h - 1), 0);\r\n    d = c.getImageData(~~((l - 1) * p), r, 1, 1).data;\r\n    return 'rgba(' + d[0] + ',' + d[1] + ',' + d[2] + ',' + (d[3]/255) + ')';\r\n  }\r\n  function TextSet(ctxt, font, colour, strings, padx, pady, shadowColour,\r\n    shadowBlur, shadowOffsets, maxWidth, widths, align) {\r\n    var xo = padx + (shadowBlur || 0) + \r\n      (shadowOffsets.length && shadowOffsets[0] < 0 ? abs(shadowOffsets[0]) : 0),\r\n      yo = pady + (shadowBlur || 0) + \r\n      (shadowOffsets.length && shadowOffsets[1] < 0 ? abs(shadowOffsets[1]) : 0), i, xc;\r\n    ctxt.font = font;\r\n    ctxt.textBaseline = 'top';\r\n    ctxt.fillStyle = colour;\r\n    shadowColour && (ctxt.shadowColor = shadowColour);\r\n    shadowBlur && (ctxt.shadowBlur = shadowBlur);\r\n    shadowOffsets.length && (ctxt.shadowOffsetX = shadowOffsets[0],\r\n      ctxt.shadowOffsetY = shadowOffsets[1]);\r\n    for(i = 0; i < strings.length; ++i) {\r\n      xc = 0;\r\n      if(widths) {\r\n        if('right' == align) {\r\n          xc = maxWidth - widths[i];\r\n        } else if('centre' == align) {\r\n          xc = (maxWidth - widths[i]) / 2;\r\n        }\r\n      }\r\n      ctxt.fillText(strings[i], xo + xc, yo);\r\n      yo += parseInt(font);\r\n    }\r\n  }\r\n  function RRect(c, x, y, w, h, r, s) {\r\n    if(r) {\r\n      c.beginPath();\r\n      c.moveTo(x, y + h - r);\r\n      c.arcTo(x, y, x + r, y, r);\r\n      c.arcTo(x + w, y, x + w, y + r, r);\r\n      c.arcTo(x + w, y + h, x + w - r, y + h, r);\r\n      c.arcTo(x, y + h, x, y + h - r, r);\r\n      c.closePath();\r\n      c[s ? 'stroke' : 'fill']();\r\n    } else {\r\n      c[s ? 'strokeRect' : 'fillRect'](x, y, w, h);\r\n    }\r\n  }\r\n  function TextCanvas(strings, font, w, h, maxWidth, stringWidths, align, valign,\r\n    scale) {\r\n    this.strings = strings;\r\n    this.font = font;\r\n    this.width = w;\r\n    this.height = h;\r\n    this.maxWidth = maxWidth;\r\n    this.stringWidths = stringWidths;\r\n    this.align = align;\r\n    this.valign = valign;\r\n    this.scale = scale;\r\n  }\r\n  TCVproto = TextCanvas.prototype;\r\n  TCVproto.SetImage = function(image, w, h, position, padding, align, valign,\r\n    scale) {\r\n    this.image = image;\r\n    this.iwidth = w * this.scale;\r\n    this.iheight = h * this.scale;\r\n    this.ipos = position;\r\n    this.ipad = padding * this.scale;\r\n    this.iscale = scale;\r\n    this.ialign = align;\r\n    this.ivalign = valign;\r\n  };\r\n  TCVproto.Align = function(size, space, a) {\r\n    var pos = 0;\r\n    if(a == 'right' || a == 'bottom')\r\n      pos = space - size;\r\n    else if(a != 'left' && a != 'top')\r\n      pos = (space - size) / 2;\r\n    return pos;\r\n  };\r\n  TCVproto.Create = function(colour, bgColour, bgOutline, bgOutlineThickness,\r\n    shadowColour, shadowBlur, shadowOffsets, padding, radius) {\r\n    var cv, cw, ch, c, x1, x2, y1, y2, offx, offy, ix, iy, iw, ih, rr,\r\n      sox = abs(shadowOffsets[0]), soy = abs(shadowOffsets[1]), shadowcv, shadowc;\r\n    padding = max(padding, sox + shadowBlur, soy + shadowBlur);\r\n    x1 = 2 * (padding + bgOutlineThickness);\r\n    y1 = 2 * (padding + bgOutlineThickness);\r\n    cw = this.width + x1;\r\n    ch = this.height + y1;\r\n    offx = offy = padding + bgOutlineThickness;\r\n  \r\n    if(this.image) {\r\n      ix = iy = padding + bgOutlineThickness;\r\n      iw = this.iwidth;\r\n      ih = this.iheight;\r\n      if(this.ipos == 'top' || this.ipos == 'bottom') {\r\n        if(iw < this.width)\r\n          ix += this.Align(iw, this.width, this.ialign);\r\n        else\r\n          offx += this.Align(this.width, iw, this.align);\r\n        if(this.ipos == 'top')\r\n          offy += ih + this.ipad;\r\n        else\r\n          iy += this.height + this.ipad;\r\n        cw = max(cw, iw + x1);\r\n        ch += ih + this.ipad;\r\n      } else {\r\n        if(ih < this.height)\r\n          iy += this.Align(ih, this.height, this.ivalign);\r\n        else\r\n          offy += this.Align(this.height, ih, this.valign);\r\n        if(this.ipos == 'right')\r\n          ix += this.width + this.ipad;\r\n        else\r\n          offx += iw + this.ipad;\r\n        cw += iw + this.ipad;\r\n        ch = max(ch, ih + y1);\r\n      }\r\n    }\r\n  \r\n    cv = NewCanvas(cw, ch);\r\n    if(!cv)\r\n      return null;\r\n    x1 = y1 = bgOutlineThickness / 2;\r\n    x2 = cw - bgOutlineThickness;\r\n    y2 = ch - bgOutlineThickness;\r\n    rr = min(radius, x2 / 2, y2 / 2);\r\n    c = cv.getContext('2d');\r\n    if(bgColour) {\r\n      c.fillStyle = bgColour;\r\n      RRect(c, x1, y1, x2, y2, rr);\r\n    }\r\n    if(bgOutlineThickness) {\r\n      c.strokeStyle = bgOutline;\r\n      c.lineWidth = bgOutlineThickness;\r\n      RRect(c, x1, y1, x2, y2, rr, true);\r\n    }\r\n    if(shadowBlur || sox || soy) {\r\n      // use a transparent canvas to draw on\r\n      shadowcv = NewCanvas(cw, ch);\r\n      if(shadowcv) {\r\n        shadowc = c;\r\n        c = shadowcv.getContext('2d');\r\n      }\r\n    }\r\n  \r\n    // don't use TextSet shadow support because it adds space for shadow\r\n    TextSet(c, this.font, colour, this.strings, offx, offy, 0, 0, [],\r\n      this.maxWidth, this.stringWidths, this.align);\r\n        \r\n    if(this.image)\r\n      c.drawImage(this.image, ix, iy, iw, ih);\r\n  \r\n    if(shadowc) {\r\n      // draw the text and image with the added shadow\r\n      c = shadowc;\r\n      shadowColour && (c.shadowColor = shadowColour);\r\n      shadowBlur && (c.shadowBlur = shadowBlur);\r\n      c.shadowOffsetX = shadowOffsets[0];\r\n      c.shadowOffsetY = shadowOffsets[1];\r\n      c.drawImage(shadowcv, 0, 0);\r\n    }\r\n    return cv;\r\n  };\r\n  function ExpandImage(i, w, h) {\r\n    var cv = NewCanvas(w, h), c;\r\n    if(!cv)\r\n      return null;\r\n    c = cv.getContext('2d');\r\n    c.drawImage(i, (w - i.width) / 2, (h - i.height) / 2);\r\n    return cv;\r\n  }\r\n  function ScaleImage(i, w, h) {\r\n    var cv = NewCanvas(w, h), c;\r\n    if(!cv)\r\n      return null;\r\n    c = cv.getContext('2d');\r\n    c.drawImage(i, 0, 0, w, h);\r\n    return cv;\r\n  }\r\n  function AddBackgroundToImage(i, w, h, scale, colour, othickness, ocolour,\r\n    padding, radius, ofill) {\r\n    var cw = w + ((2 * padding) + othickness) * scale,\r\n      ch = h + ((2 * padding) + othickness) * scale,\r\n      cv = NewCanvas(cw, ch), c, x1, y1, x2, y2, ocanvas, cc, rr;\r\n    if(!cv)\r\n      return null;\r\n    othickness *= scale;\r\n    radius *= scale;\r\n    x1 = y1 = othickness / 2;\r\n    x2 = cw - othickness;\r\n    y2 = ch - othickness;\r\n    padding = (padding * scale) + x1; // add space for outline\r\n    c = cv.getContext('2d');\r\n    rr = min(radius, x2 / 2, y2 / 2);\r\n    if(colour) {\r\n      c.fillStyle = colour;\r\n      RRect(c, x1, y1, x2, y2, rr);\r\n    }\r\n    if(othickness) {\r\n      c.strokeStyle = ocolour;\r\n      c.lineWidth = othickness;\r\n      RRect(c, x1, y1, x2, y2, rr, true);\r\n    }\r\n    \r\n    if(ofill) {\r\n      // use compositing to colour in the image and border\r\n      ocanvas = NewCanvas(cw, ch);\r\n      cc = ocanvas.getContext('2d');\r\n      cc.drawImage(i, padding, padding, w, h);\r\n      cc.globalCompositeOperation = 'source-in';\r\n      cc.fillStyle = ocolour;\r\n      cc.fillRect(0, 0, cw, ch);\r\n      cc.globalCompositeOperation = 'destination-over';\r\n      cc.drawImage(cv, 0, 0);\r\n      cc.globalCompositeOperation = 'source-over';\r\n      c.drawImage(ocanvas, 0, 0);\r\n    } else {\r\n      c.drawImage(i, padding, padding, i.width, i.height);\r\n    }\r\n    return {image: cv, width: cw / scale, height: ch / scale};\r\n  }\r\n  /**\r\n   * Rounds off the corners of an image\r\n   */\r\n  function RoundImage(i, r, iw, ih, s) {\r\n    var cv, c, r1 = parseFloat(r), l = max(iw, ih);\r\n    cv = NewCanvas(iw, ih);\r\n    if(!cv)\r\n      return null;\r\n    if(r.indexOf('%') > 0)\r\n      r1 = l * r1 / 100;\r\n    else\r\n      r1 = r1 * s;\r\n    c = cv.getContext('2d');\r\n    c.globalCompositeOperation = 'source-over';\r\n    c.fillStyle = '#fff';\r\n    if(r1 >= l/2) {\r\n      r1 = min(iw,ih) / 2;\r\n      c.beginPath();\r\n      c.moveTo(iw/2,ih/2);\r\n      c.arc(iw/2,ih/2,r1,0,2*Math.PI,false);\r\n      c.fill();\r\n      c.closePath();\r\n    } else {\r\n      r1 = min(iw/2,ih/2,r1);\r\n      RRect(c, 0, 0, iw, ih, r1, true);\r\n      c.fill();\r\n    }\r\n    c.globalCompositeOperation = 'source-in';\r\n    c.drawImage(i, 0, 0, iw, ih);\r\n    return cv;\r\n  }\r\n  /**\r\n   * Creates a new canvas containing the image and its shadow\r\n   * Returns an object containing the image and its dimensions at z=0\r\n   */\r\n  function AddShadowToImage(i, w, h, scale, sc, sb, so) {\r\n    var sw = abs(so[0]), sh = abs(so[1]), \r\n      cw = w + (sw > sb ? sw + sb : sb * 2) * scale,\r\n      ch = h + (sh > sb ? sh + sb : sb * 2) * scale,\r\n      xo = scale * ((sb || 0) + (so[0] < 0 ? sw : 0)),\r\n      yo = scale * ((sb || 0) + (so[1] < 0 ? sh : 0)), cv, c;\r\n    cv = NewCanvas(cw, ch);\r\n    if(!cv)\r\n      return null;\r\n    c = cv.getContext('2d');\r\n    sc && (c.shadowColor = sc);\r\n    sb && (c.shadowBlur = sb * scale);\r\n    so && (c.shadowOffsetX = so[0] * scale, c.shadowOffsetY = so[1] * scale);\r\n    c.drawImage(i, xo, yo, w, h);\r\n    return {image: cv, width: cw / scale, height: ch / scale};\r\n  }\r\n  function FindTextBoundingBox(s,f,ht) {\r\n    var w = parseInt(s.toString().length * ht), h = parseInt(ht * 2 * s.length),\r\n      cv = NewCanvas(w,h), c, idata, w1, h1, x, y, i, ex;\r\n    if(!cv)\r\n      return null;\r\n    c = cv.getContext('2d');\r\n    c.fillStyle = '#000';\r\n    c.fillRect(0,0,w,h);\r\n    TextSet(c,ht + 'px ' + f,'#fff',s,0,0,0,0,[],'centre')\r\n  \r\n    idata = c.getImageData(0,0,w,h);\r\n    w1 = idata.width; h1 = idata.height;\r\n    ex = {\r\n      min: { x: w1, y: h1 },\r\n      max: { x: -1, y: -1 }\r\n    };\r\n    for(y = 0; y < h1; ++y) {\r\n      for(x = 0; x < w1; ++x) {\r\n        i = (y * w1 + x) * 4;\r\n        if(idata.data[i+1] > 0) {\r\n          if(x < ex.min.x) ex.min.x = x;\r\n          if(x > ex.max.x) ex.max.x = x;\r\n          if(y < ex.min.y) ex.min.y = y;\r\n          if(y > ex.max.y) ex.max.y = y;\r\n        }\r\n      }\r\n    }\r\n    // device pixels might not be css pixels\r\n    if(w1 != w) {\r\n      ex.min.x *= (w / w1);\r\n      ex.max.x *= (w / w1);\r\n    }\r\n    if(h1 != h) {\r\n      ex.min.y *= (w / h1);\r\n      ex.max.y *= (w / h1);\r\n    }\r\n  \r\n    cv = null;\r\n    return ex;\r\n  }\r\n  function FixFont(f) {\r\n    return \"'\" + f.replace(/(\\'|\\\")/g,'').replace(/\\s*,\\s*/g, \"', '\") + \"'\";\r\n  }\r\n  function AddHandler(h,f,e) {\r\n    e = e || doc;\r\n    if(e.addEventListener)\r\n      e.addEventListener(h,f,false);\r\n    else\r\n      e.attachEvent('on' + h, f);\r\n  }\r\n  function RemoveHandler(h,f,e) {\r\n    e = e || doc;\r\n    if(e.removeEventListener)\r\n      e.removeEventListener(h, f);\r\n    else\r\n      e.detachEvent('on' + h, f);\r\n  }\r\n  function AddImage(i, o, alt, t, tc) {\r\n    var s = tc.imageScale, mscale, ic, bc, oc, iw, ih;\r\n    // image not loaded, wait for image onload\r\n    if(!o.complete)\r\n      return AddHandler('load',function() { AddImage(i,o,alt,t,tc); }, o);\r\n    if(!i.complete)\r\n      return AddHandler('load',function() { AddImage(i,o,alt,t,tc); }, i);\r\n    if(alt && !alt.complete)\r\n      return AddHandler('load',function() { AddImage(i,o,alt,t,tc); }, alt);\r\n  \r\n    // Yes, this does look like nonsense, but it makes sure that both the\r\n    // width and height are actually set and not just calculated. This is\r\n    // required to keep proportional sizes when the images are hidden, so\r\n    // the images can be used again for another cloud.\r\n    o.width = o.width;\r\n    o.height = o.height;\r\n  \r\n    if(s) {\r\n      i.width = o.width * s;\r\n      i.height = o.height * s;\r\n    }\r\n    // the standard width of the image, with imageScale applied\r\n    t.iw = i.width;\r\n    t.ih = i.height;\r\n    if(tc.txtOpt) {\r\n      ic = i;\r\n      mscale = tc.zoomMax * tc.txtScale;\r\n      iw = t.iw * mscale;\r\n      ih = t.ih * mscale;\r\n      if(iw < o.naturalWidth || ih < o.naturalHeight) {\r\n        ic = ScaleImage(i, iw, ih);\r\n        if(ic)\r\n          t.fimage = ic;\r\n      } else {\r\n        iw = t.iw;\r\n        ih = t.ih;\r\n        mscale = 1;\r\n      }\r\n      if(parseFloat(tc.imageRadius))\r\n        t.image = t.fimage = i = RoundImage(t.image, tc.imageRadius, iw, ih, mscale);\r\n      if(!t.HasText()) {\r\n        if(tc.shadow) {\r\n          ic = AddShadowToImage(t.image, iw, ih, mscale, tc.shadow, tc.shadowBlur,\r\n            tc.shadowOffset);\r\n          if(ic) {\r\n            t.fimage = ic.image;\r\n            t.w = ic.width;\r\n            t.h = ic.height;\r\n          }\r\n        }\r\n        if(tc.bgColour || tc.bgOutlineThickness) {\r\n          bc = tc.bgColour == 'tag' ? GetProperty(t.a, 'background-color') :\r\n            tc.bgColour;\r\n          oc = tc.bgOutline == 'tag' ? GetProperty(t.a, 'color') : \r\n            (tc.bgOutline || tc.textColour);\r\n          iw = t.fimage.width;\r\n          ih = t.fimage.height;\r\n          if(tc.outlineMethod == 'colour') {\r\n            // create the outline version first, using the current image state\r\n            ic = AddBackgroundToImage(t.fimage, iw, ih, mscale, bc,\r\n              tc.bgOutlineThickness, t.outline.colour, tc.padding, tc.bgRadius, 1);\r\n            if(ic)\r\n              t.oimage = ic.image;\r\n          }\r\n          ic = AddBackgroundToImage(t.fimage, iw, ih, mscale, bc, \r\n            tc.bgOutlineThickness, oc, tc.padding, tc.bgRadius);\r\n          if(ic) {\r\n            t.fimage = ic.image;\r\n            t.w = ic.width;\r\n            t.h = ic.height;\r\n          }\r\n        }\r\n        if(tc.outlineMethod == 'size') {\r\n          if(tc.outlineIncrease > 0) {\r\n            t.iw += 2 * tc.outlineIncrease;\r\n            t.ih += 2 * tc.outlineIncrease;\r\n            iw = mscale * t.iw;\r\n            ih = mscale * t.ih;\r\n            ic = ScaleImage(t.fimage, iw, ih);\r\n            t.oimage = ic;\r\n            t.fimage = ExpandImage(t.fimage, t.oimage.width, t.oimage.height);\r\n          } else {\r\n            iw = mscale * (t.iw + (2 * tc.outlineIncrease));\r\n            ih = mscale * (t.ih + (2 * tc.outlineIncrease));\r\n            ic = ScaleImage(t.fimage, iw, ih);\r\n            t.oimage = ExpandImage(ic, t.fimage.width, t.fimage.height);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    t.alt = alt;\r\n    t.Init();\r\n  }\r\n  function GetProperty(e,p) {\r\n    var dv = doc.defaultView, pc = p.replace(/\\-([a-z])/g,function(a){return a.charAt(1).toUpperCase()});\r\n    return (dv && dv.getComputedStyle && dv.getComputedStyle(e,null).getPropertyValue(p)) ||\r\n      (e.currentStyle && e.currentStyle[pc]);\r\n  }\r\n  function FindWeight(a, wFrom, tHeight) {\r\n    var w = 1, p;\r\n    if(wFrom) {\r\n      w = 1 * (a.getAttribute(wFrom) || tHeight);\r\n    } else if(p = GetProperty(a,'font-size')) {\r\n      w = (p.indexOf('px') > -1 && p.replace('px','') * 1) ||\r\n        (p.indexOf('pt') > -1 && p.replace('pt','') * 1.25) ||\r\n        p * 3.3;\r\n    }\r\n    return w;\r\n  }\r\n  function EventToCanvasId(e) {\r\n    return e.target && Defined(e.target.id) ? e.target.id :\r\n      e.srcElement.parentNode.id;\r\n  }\r\n  function EventXY(e, c) {\r\n    var xy, p, xmul = parseInt(GetProperty(c, 'width')) / c.width,\r\n      ymul = parseInt(GetProperty(c, 'height')) / c.height;\r\n    if(Defined(e.offsetX)) {\r\n      xy = {x: e.offsetX, y: e.offsetY};\r\n    } else {\r\n      p = AbsPos(c.id);\r\n      if(Defined(e.changedTouches))\r\n        e = e.changedTouches[0];\r\n      if(e.pageX)\r\n        xy = {x: e.pageX - p.x, y: e.pageY - p.y};\r\n    }\r\n    if(xy && xmul && ymul) {\r\n      xy.x /= xmul;\r\n      xy.y /= ymul;\r\n    }\r\n    return xy;\r\n  }\r\n  function MouseOut(e) {\r\n    var cv = e.target || e.fromElement.parentNode, tc = TagCanvas.tc[cv.id];\r\n    if(tc) {\r\n     tc.mx = tc.my = -1;\r\n     tc.UnFreeze();\r\n     tc.EndDrag();\r\n    }\r\n  }\r\n  function MouseMove(e) {\r\n    var i, t = TagCanvas, tc, p, tg = EventToCanvasId(e);\r\n    for(i in t.tc) {\r\n      tc = t.tc[i];\r\n      if(tc.tttimer) {\r\n        clearTimeout(tc.tttimer);\r\n        tc.tttimer = null;\r\n      }\r\n    }\r\n    if(tg && t.tc[tg]) {\r\n      tc = t.tc[tg];\r\n      if(p = EventXY(e, tc.canvas)) {\r\n        tc.mx = p.x;\r\n        tc.my = p.y;\r\n        tc.Drag(e, p);\r\n      }\r\n      tc.drawn = 0;\r\n    }\r\n  }\r\n  function MouseDown(e) {\r\n    var t = TagCanvas, cb = doc.addEventListener ? 0 : 1,\r\n      tg = EventToCanvasId(e);\r\n    if(tg && e.button == cb && t.tc[tg]) {\r\n      t.tc[tg].BeginDrag(e);\r\n    }\r\n  }\r\n  function MouseUp(e) {\r\n    var t = TagCanvas, cb = doc.addEventListener ? 0 : 1,\r\n      tg = EventToCanvasId(e), tc;\r\n    if(tg && e.button == cb && t.tc[tg]) {\r\n      tc = t.tc[tg];\r\n      MouseMove(e);\r\n      if(!tc.EndDrag() && !tc.touchState)\r\n        tc.Clicked(e);\r\n    }\r\n  }\r\n  function TouchDown(e) {\r\n    var tg = EventToCanvasId(e), tc = (tg && TagCanvas.tc[tg]), p;\r\n    if(tc && e.changedTouches) {\r\n      if(e.touches.length == 1 && tc.touchState == 0) {\r\n        tc.touchState = 1;\r\n        tc.BeginDrag(e);\r\n        if(p = EventXY(e, tc.canvas)) {\r\n          tc.mx = p.x;\r\n          tc.my = p.y;\r\n          tc.drawn = 0;\r\n        }\r\n      } else if(e.targetTouches.length == 2 && tc.pinchZoom) {\r\n        tc.touchState = 3;\r\n        tc.EndDrag();\r\n        tc.BeginPinch(e);\r\n      } else {\r\n        tc.EndDrag();\r\n        tc.EndPinch();\r\n        tc.touchState = 0;\r\n      }\r\n    }\r\n  }\r\n  function TouchUp(e) {\r\n    var tg = EventToCanvasId(e), tc = (tg && TagCanvas.tc[tg]);\r\n    if(tc && e.changedTouches) {\r\n      switch(tc.touchState) {\r\n      case 1:\r\n        tc.Draw();\r\n        tc.Clicked();\r\n        break;\r\n      case 2:\r\n        tc.EndDrag();\r\n        break;\r\n      case 3:\r\n        tc.EndPinch();\r\n      }\r\n      tc.touchState = 0;\r\n    }\r\n  }\r\n  function TouchMove(e) {\r\n    var i, t = TagCanvas, tc, p, tg = EventToCanvasId(e);\r\n    for(i in t.tc) {\r\n      tc = t.tc[i];\r\n      if(tc.tttimer) {\r\n        clearTimeout(tc.tttimer);\r\n        tc.tttimer = null;\r\n      }\r\n    }\r\n    tc = (tg && t.tc[tg]);\r\n    if(tc && e.changedTouches && tc.touchState) {\r\n      switch(tc.touchState) {\r\n      case 1:\r\n      case 2:\r\n        if(p = EventXY(e, tc.canvas)) {\r\n          tc.mx = p.x;\r\n          tc.my = p.y;\r\n          if(tc.Drag(e, p))\r\n            tc.touchState = 2;\r\n        }\r\n        break;\r\n      case 3:\r\n        tc.Pinch(e);\r\n      }\r\n      tc.drawn = 0;\r\n    }\r\n  }\r\n  function MouseWheel(e) {\r\n    var t = TagCanvas, tg = EventToCanvasId(e);\r\n    if(tg && t.tc[tg]) {\r\n      e.cancelBubble = true;\r\n      e.returnValue = false;\r\n      e.preventDefault && e.preventDefault();\r\n      t.tc[tg].Wheel((e.wheelDelta || e.detail) > 0);\r\n    }\r\n  }\r\n  function Scroll(e) {\r\n    var i, t = TagCanvas;\r\n    clearTimeout(t.scrollTimer);\r\n    for(i in t.tc) {\r\n      t.tc[i].Pause();\r\n    }\r\n    t.scrollTimer = setTimeout(function() {\r\n      var i, t = TagCanvas;\r\n      for(i in t.tc) {\r\n        t.tc[i].Resume();\r\n      }\r\n    }, t.scrollPause);\r\n  }\r\n  function DrawCanvas() {\r\n    DrawCanvasRAF(TimeNow());\r\n  }\r\n  function DrawCanvasRAF(t) {\r\n    var tc = TagCanvas.tc, i;\r\n    TagCanvas.NextFrame(TagCanvas.interval);\r\n    t = t || TimeNow();\r\n    for(i in tc)\r\n      tc[i].Draw(t);\r\n  }\r\n  function NextFrameRAF() {\r\n    requestAnimationFrame(DrawCanvasRAF);\r\n  };\r\n  function NextFrameTimeout(iv) {\r\n    setTimeout(DrawCanvas, iv);\r\n  };\r\n  function AbsPos(id) {\r\n    var e = doc.getElementById(id), r = e.getBoundingClientRect(),\r\n      dd = doc.documentElement, b = doc.body, w = window,\r\n      xs = w.pageXOffset || dd.scrollLeft,\r\n      ys = w.pageYOffset || dd.scrollTop,\r\n      xo = dd.clientLeft || b.clientLeft,\r\n      yo = dd.clientTop || b.clientTop;\r\n    return { x: r.left + xs - xo, y: r.top + ys - yo };\r\n  }\r\n  function Project(tc,p1,sx,sy) {\r\n    var m = tc.radius * tc.z1 / (tc.z1 + tc.z2 + p1.z);\r\n    return {\r\n      x: p1.x * m * sx,\r\n      y: p1.y * m * sy,\r\n      z: p1.z,\r\n      w: (tc.z1 - p1.z) / tc.z2\r\n    };\r\n  }\r\n  /**\r\n   * @constructor\r\n   * for recursively splitting tag contents on <br> tags\r\n   */\r\n  function TextSplitter(e) {\r\n    this.e = e;\r\n    this.br = 0;\r\n    this.line = [];\r\n    this.text = [];\r\n    this.original = e.innerText || e.textContent;\r\n  }\r\n  TSproto = TextSplitter.prototype;\r\n  TSproto.Empty = function() {\r\n    for(var i = 0; i < this.text.length; ++i)\r\n      if(this.text[i].length)\r\n        return false;\r\n    return true;\r\n  };\r\n  TSproto.Lines = function(e) {\r\n    var r = e ? 1 : 0, cn, cl, i;\r\n    e = e || this.e;\r\n    cn = e.childNodes;\r\n    cl = cn.length;\r\n  \r\n    for(i = 0; i < cl; ++i) {\r\n      if(cn[i].nodeName == 'BR') {\r\n        this.text.push(this.line.join(' '));\r\n        this.br = 1;\r\n      } else if(cn[i].nodeType == 3) {\r\n        if(this.br) {\r\n          this.line = [cn[i].nodeValue];\r\n          this.br = 0;\r\n        } else {\r\n          this.line.push(cn[i].nodeValue);\r\n        }\r\n      } else {\r\n        this.Lines(cn[i]);\r\n      }\r\n    }\r\n    r || this.br || this.text.push(this.line.join(' '));\r\n    return this.text;\r\n  };\r\n  TSproto.SplitWidth = function(w, c, f, h) {\r\n    var i, j, words, text = [];\r\n    c.font = h + 'px ' + f;\r\n    for(i = 0; i < this.text.length; ++i) {\r\n      words = this.text[i].split(/\\s+/);\r\n      this.line = [words[0]];\r\n      for(j = 1; j < words.length; ++j) {\r\n        if(c.measureText(this.line.join(' ') + ' ' + words[j]).width > w) {\r\n          text.push(this.line.join(' '));\r\n          this.line = [words[j]];\r\n        } else {\r\n          this.line.push(words[j]);\r\n        }\r\n      }\r\n      text.push(this.line.join(' '));\r\n    }\r\n    return this.text = text;\r\n  };\r\n  /**\r\n   * @constructor\r\n   */\r\n  function Outline(tc,t) {\r\n    this.ts = null;\r\n    this.tc = tc;\r\n    this.tag = t;\r\n    this.x = this.y = this.w = this.h = this.sc = 1;\r\n    this.z = 0;\r\n    this.pulse = 1;\r\n    this.pulsate = tc.pulsateTo < 1;\r\n    this.colour = tc.outlineColour;\r\n    this.adash = ~~tc.outlineDash;\r\n    this.agap = ~~tc.outlineDashSpace || this.adash;\r\n    this.aspeed = tc.outlineDashSpeed * 1;\r\n    if(this.colour == 'tag')\r\n      this.colour = GetProperty(t.a, 'color');\r\n    else if(this.colour == 'tagbg')\r\n      this.colour = GetProperty(t.a, 'background-color');\r\n    this.Draw = this.pulsate ? this.DrawPulsate : this.DrawSimple;\r\n    this.radius = tc.outlineRadius | 0;\r\n    this.SetMethod(tc.outlineMethod,tc.altImage);\r\n  }\r\n  Oproto = Outline.prototype;\r\n  Oproto.SetMethod = function(om,alt) {\r\n    var methods = {\r\n      block: ['PreDraw','DrawBlock'],\r\n      colour: ['PreDraw','DrawColour'],\r\n      outline: ['PostDraw','DrawOutline'],\r\n      classic: ['LastDraw','DrawOutline'],\r\n      size: ['PreDraw','DrawSize'],\r\n      none: ['LastDraw']\r\n    }, funcs = methods[om] || methods.outline;\r\n    if(om == 'none') {\r\n      this.Draw = function() { return 1; }\r\n    } else {\r\n      this.drawFunc = this[funcs[1]];\r\n    }\r\n    this[funcs[0]] = this.Draw;\r\n    if(alt) {\r\n      this.RealPreDraw = this.PreDraw;\r\n      this.PreDraw = this.DrawAlt;\r\n    }\r\n  };\r\n  Oproto.Update = function(x,y,w,h,sc,z,xo,yo) {\r\n    var o = this.tc.outlineOffset, o2 = 2 * o;\r\n    this.x = sc * x + xo - o;\r\n    this.y = sc * y + yo - o;\r\n    this.w = sc * w + o2;\r\n    this.h = sc * h + o2;\r\n    this.sc = sc; // used to determine frontmost\r\n    this.z = z;\r\n  };\r\n  Oproto.Ants = function(c) {\r\n    if(!this.adash)\r\n      return;\r\n    var l = this.adash, g = this.agap, s = this.aspeed, length = l + g,\r\n      l1 = 0, l2 = l, g1 = g, g2 = 0, seq = 0, ants;\r\n    if(s) {\r\n      seq = abs(s) * (TimeNow() - this.ts) / 50;\r\n      if(s < 0)\r\n        seq = 8.64e6 - seq;\r\n      s = ~~seq % length;\r\n    }\r\n    if(s) {\r\n      if(l >= s) {\r\n        l1 = l - s;\r\n        l2 = s;\r\n      } else {\r\n        g1 = length - s;\r\n        g2 = g - g1;\r\n      }\r\n      ants = [l1, g1, l2, g2];\r\n    } else {\r\n      ants = [l,g];\r\n    }\r\n    c.setLineDash(ants);\r\n  }\r\n  Oproto.DrawOutline = function(c,x,y,w,h,colour) {\r\n    var r = min(this.radius, h/2, w/2);\r\n    c.strokeStyle = colour;\r\n    this.Ants(c);\r\n    RRect(c, x, y, w, h, r, true);\r\n  };\r\n  Oproto.DrawSize = function(c,x,y,w,h,colour,tag,x1,y1) {\r\n    var tw = tag.w, th = tag.h, m, i, sc;\r\n    if(this.pulsate) {\r\n      if(tag.image)\r\n        sc = (tag.image.height + this.tc.outlineIncrease) / tag.image.height;\r\n      else\r\n        sc = tag.oscale;\r\n      i = tag.fimage || tag.image;\r\n      m = 1 + ((sc - 1) * (1-this.pulse));\r\n      tag.h *= m;\r\n      tag.w *= m;\r\n    } else {\r\n      i = tag.oimage;\r\n    }\r\n    tag.alpha = 1;\r\n    tag.Draw(c, x1, y1, i);\r\n    tag.h = th;\r\n    tag.w = tw;\r\n    return 1;\r\n  };\r\n  Oproto.DrawColour = function(c,x,y,w,h,colour,tag,x1,y1) {\r\n    if(tag.oimage) {\r\n      if(this.pulse < 1) {\r\n        tag.alpha = 1 - pow(this.pulse, 2);\r\n        tag.Draw(c, x1, y1, tag.fimage);\r\n        tag.alpha = this.pulse;\r\n      } else {\r\n        tag.alpha = 1;\r\n      }\r\n      tag.Draw(c, x1, y1, tag.oimage);\r\n      return 1;\r\n    }\r\n    return this[tag.image ? 'DrawColourImage' : 'DrawColourText'](c,x,y,w,h,colour,tag,x1,y1);\r\n  };\r\n  Oproto.DrawColourText = function(c,x,y,w,h,colour,tag,x1,y1) {\r\n    var normal = tag.colour;\r\n    tag.colour = colour;\r\n    tag.alpha = 1;\r\n    tag.Draw(c,x1,y1);\r\n    tag.colour = normal;\r\n    return 1;\r\n  };\r\n  Oproto.DrawColourImage = function(c,x,y,w,h,colour,tag,x1,y1) {\r\n    var ccanvas = c.canvas, fx = ~~max(x,0), fy = ~~max(y,0), \r\n      fw = min(ccanvas.width - fx, w) + .5|0, fh = min(ccanvas.height - fy,h) + .5|0, cc;\r\n    if(ocanvas)\r\n      ocanvas.width = fw, ocanvas.height = fh;\r\n    else\r\n      ocanvas = NewCanvas(fw, fh);\r\n    if(!ocanvas)\r\n      return this.SetMethod('outline'); // if using IE and images, give up!\r\n    cc = ocanvas.getContext('2d');\r\n  \r\n    cc.drawImage(ccanvas,fx,fy,fw,fh,0,0,fw,fh);\r\n    c.clearRect(fx,fy,fw,fh);\r\n    if(this.pulsate) {\r\n      tag.alpha = 1 - pow(this.pulse, 2);\r\n    } else {\r\n      tag.alpha = 1;\r\n    }\r\n    tag.Draw(c,x1,y1);\r\n    c.setTransform(1,0,0,1,0,0);\r\n    c.save();\r\n    c.beginPath();\r\n    c.rect(fx,fy,fw,fh);\r\n    c.clip();\r\n    c.globalCompositeOperation = 'source-in';\r\n    c.fillStyle = colour;\r\n    c.fillRect(fx,fy,fw,fh);\r\n    c.restore();\r\n    c.globalAlpha = 1;\r\n    c.globalCompositeOperation = 'destination-over';\r\n    c.drawImage(ocanvas,0,0,fw,fh,fx,fy,fw,fh);\r\n    c.globalCompositeOperation = 'source-over';\r\n    return 1;\r\n  };\r\n  Oproto.DrawAlt = function(c,tag,x1,y1,ga,useGa) {\r\n    var r = this.RealPreDraw(c,tag,x1,y1,ga,useGa);\r\n    if(tag.alt) {\r\n      tag.DrawImage(c, x1, y1, tag.alt);\r\n      r = 1;\r\n    }\r\n    return r;\r\n  };\r\n  Oproto.DrawBlock = function(c,x,y,w,h,colour) {\r\n    var r = min(this.radius, h/2, w/2);\r\n    c.fillStyle = colour;\r\n    RRect(c, x, y, w, h, r);\r\n  };\r\n  Oproto.DrawSimple = function(c, tag, x1, y1, ga, useGa) {\r\n    var t = this.tc;\r\n    c.setTransform(1,0,0,1,0,0);\r\n    c.strokeStyle = this.colour;\r\n    c.lineWidth = t.outlineThickness;\r\n    c.shadowBlur = c.shadowOffsetX = c.shadowOffsetY = 0;\r\n    c.globalAlpha = useGa ? ga : 1;\r\n    return this.drawFunc(c,this.x,this.y,this.w,this.h,this.colour,tag,x1,y1);\r\n  };\r\n  Oproto.DrawPulsate = function(c, tag, x1, y1) {\r\n    var diff = TimeNow() - this.ts, t = this.tc,\r\n      ga = t.pulsateTo + ((1 - t.pulsateTo) * \r\n      (0.5 + (cos(2 * Math.PI * diff / (1000 * t.pulsateTime)) / 2)));\r\n    this.pulse = ga = TagCanvas.Smooth(1,ga);\r\n    return this.DrawSimple(c, tag, x1, y1, ga, 1);\r\n  };\r\n  Oproto.Active = function(c,x,y) {\r\n    var a = (x >= this.x && y >= this.y &&\r\n      x <= this.x + this.w && y <= this.y + this.h);\r\n    if(a) {\r\n      this.ts = this.ts || TimeNow();\r\n    } else {\r\n      this.ts = null;\r\n    }\r\n    return a;\r\n  };\r\n  Oproto.PreDraw = Oproto.PostDraw = Oproto.LastDraw = Nop;\r\n  /**\r\n   * @constructor\r\n   */\r\n  function Tag(tc, text, a, v, w, h, col, bcol, bradius, boutline, bothickness,\r\n    font, padding, original) {\r\n    this.tc = tc;\r\n    this.image = null;\r\n    this.text = text;\r\n    this.text_original = original;\r\n    this.line_widths = [];\r\n    this.title = a.title || null;\r\n    this.a = a;\r\n    this.position = new Vector(v[0], v[1], v[2]);\r\n    this.x = this.y = this.z = 0;\r\n    this.w = w;\r\n    this.h = h;\r\n    this.colour = col || tc.textColour;\r\n    this.bgColour = bcol || tc.bgColour;\r\n    this.bgRadius = bradius | 0;\r\n    this.bgOutline = boutline || this.colour;\r\n    this.bgOutlineThickness = bothickness | 0;\r\n    this.textFont = font || tc.textFont;\r\n    this.padding = padding | 0;\r\n    this.sc = this.alpha = 1;\r\n    this.weighted = !tc.weight;\r\n    this.outline = new Outline(tc,this);\r\n    this.audio = null;\r\n  }\r\n  Tproto = Tag.prototype;\r\n  Tproto.Init = function(e) {\r\n    var tc = this.tc;\r\n    this.textHeight = tc.textHeight;\r\n    if(this.HasText()) {\r\n      this.Measure(tc.ctxt,tc);\r\n    } else {\r\n      this.w = this.iw;\r\n      this.h = this.ih;\r\n    }\r\n  \r\n    this.SetShadowColour = tc.shadowAlpha ? this.SetShadowColourAlpha : this.SetShadowColourFixed;\r\n    this.SetDraw(tc);\r\n  };\r\n  Tproto.Draw = Nop;\r\n  Tproto.HasText = function() {\r\n    return this.text && this.text[0].length > 0;\r\n  };\r\n  Tproto.EqualTo = function(e) {\r\n    var i = e.getElementsByTagName('img');\r\n    if(this.a.href != e.href)\r\n      return 0;\r\n    if(i.length)\r\n      return this.image.src == i[0].src;\r\n    return (e.innerText || e.textContent) == this.text_original;\r\n  };\r\n  Tproto.SetImage = function(i) {\r\n    this.image = this.fimage = i;\r\n  };\r\n  Tproto.SetAudio = function(a) {\r\n    this.audio = a;\r\n    this.audio.load();\r\n  };\r\n  Tproto.SetDraw = function(t) {\r\n    this.Draw = this.fimage ? (t.ie > 7 ? this.DrawImageIE : this.DrawImage) : this.DrawText;\r\n    t.noSelect && (this.CheckActive = Nop);\r\n  };\r\n  Tproto.MeasureText = function(c) {\r\n    var i, l = this.text.length, w = 0, wl;\r\n    for(i = 0; i < l; ++i) {\r\n      this.line_widths[i] = wl = c.measureText(this.text[i]).width;\r\n      w = max(w, wl);\r\n    }\r\n    return w;\r\n  };\r\n  Tproto.Measure = function(c,t) {\r\n    var extents = FindTextBoundingBox(this.text, this.textFont, this.textHeight),\r\n      s, th, f, soff, cw, twidth, theight, img, tcv;\r\n    // add the gap at the top to the height to make equal gap at bottom\r\n    theight = extents ? extents.max.y + extents.min.y : this.textHeight;\r\n    c.font = this.font = this.textHeight + 'px ' + this.textFont;\r\n    twidth = this.MeasureText(c);\r\n    if(t.txtOpt) {\r\n      s = t.txtScale;\r\n      th = s * this.textHeight;\r\n      f = th + 'px ' + this.textFont;\r\n      soff = [s * t.shadowOffset[0], s * t.shadowOffset[1]];\r\n      c.font = f;\r\n      cw = this.MeasureText(c);\r\n      tcv = new TextCanvas(this.text, f, cw + s, (s * theight) + s, cw,\r\n        this.line_widths, t.textAlign, t.textVAlign, s);\r\n  \r\n      if(this.image)\r\n        tcv.SetImage(this.image, this.iw, this.ih, t.imagePosition, t.imagePadding,\r\n          t.imageAlign, t.imageVAlign, t.imageScale);\r\n  \r\n      img = tcv.Create(this.colour, this.bgColour, this.bgOutline,\r\n        s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff,\r\n        s * this.padding, s * this.bgRadius);\r\n  \r\n      // add outline image using highlight colour\r\n      if(t.outlineMethod == 'colour') {\r\n        this.oimage = tcv.Create(this.outline.colour, this.bgColour, this.outline.colour,\r\n          s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff,\r\n          s * this.padding, s * this.bgRadius);\r\n  \r\n      } else if(t.outlineMethod == 'size') {\r\n        extents = FindTextBoundingBox(this.text, this.textFont,\r\n          this.textHeight + t.outlineIncrease);\r\n        th = extents.max.y + extents.min.y;\r\n        f = (s * (this.textHeight + t.outlineIncrease)) + 'px ' + this.textFont;\r\n        c.font = f;\r\n        cw = this.MeasureText(c);\r\n  \r\n        tcv = new TextCanvas(this.text, f, cw + s, (s * th) + s, cw,\r\n          this.line_widths, t.textAlign, t.textVAlign, s);\r\n        if(this.image)\r\n          tcv.SetImage(this.image, this.iw + t.outlineIncrease,\r\n            this.ih + t.outlineIncrease, t.imagePosition, t.imagePadding,\r\n            t.imageAlign, t.imageVAlign, t.imageScale);\r\n            \r\n        this.oimage = tcv.Create(this.colour, this.bgColour, this.bgOutline,\r\n          s * this.bgOutlineThickness, t.shadow, s * t.shadowBlur, soff,\r\n          s * this.padding, s * this.bgRadius);\r\n  \r\n        this.oscale = this.oimage.width / img.width;\r\n        if(t.outlineIncrease > 0)\r\n          img = ExpandImage(img, this.oimage.width, this.oimage.height);\r\n        else\r\n          this.oimage = ExpandImage(this.oimage, img.width, img.height);\r\n      }\r\n      if(img) {\r\n        this.fimage = img;\r\n        twidth = this.fimage.width / s;\r\n        theight = this.fimage.height / s;\r\n      }\r\n      this.SetDraw(t);\r\n      t.txtOpt = !!this.fimage;\r\n    }\r\n    this.h = theight;\r\n    this.w = twidth;\r\n  };\r\n  Tproto.SetFont = function(f, c, bc, boc) {\r\n    this.textFont = f;\r\n    this.colour = c;\r\n    this.bgColour = bc;\r\n    this.bgOutline = boc;\r\n    this.Measure(this.tc.ctxt, this.tc);\r\n  };\r\n  Tproto.SetWeight = function(w) {\r\n    var tc = this.tc, modes = tc.weightMode.split(/[, ]/), m, s, wl = w.length;\r\n    if(!this.HasText())\r\n      return;\r\n    this.weighted = true;\r\n    for(s = 0; s < wl; ++s) {\r\n      m = modes[s] || 'size';\r\n      if('both' == m) {\r\n        this.Weight(w[s], tc.ctxt, tc, 'size', tc.min_weight[s], \r\n          tc.max_weight[s], s);\r\n        this.Weight(w[s], tc.ctxt, tc, 'colour', tc.min_weight[s],\r\n          tc.max_weight[s], s);\r\n      } else {\r\n        this.Weight(w[s], tc.ctxt, tc, m, tc.min_weight[s], tc.max_weight[s], s);\r\n      }\r\n    }\r\n    this.Measure(tc.ctxt, tc);\r\n  };\r\n  Tproto.Weight = function(w, c, t, m, wmin, wmax, wnum) {\r\n    w = isNaN(w) ? 1 : w;\r\n    var nweight = (w - wmin) / (wmax - wmin);\r\n    if('colour' == m)\r\n      this.colour = FindGradientColour(t, nweight, wnum);\r\n    else if('bgcolour' == m)\r\n      this.bgColour = FindGradientColour(t, nweight, wnum);\r\n    else if('bgoutline' == m)\r\n      this.bgOutline = FindGradientColour(t, nweight, wnum);\r\n    else if('outline' == m)\r\n      this.outline.colour = FindGradientColour(t, nweight, wnum);\r\n    else if('size' == m) {\r\n      if(t.weightSizeMin > 0 && t.weightSizeMax > t.weightSizeMin) {\r\n        this.textHeight = t.weightSize * \r\n          (t.weightSizeMin + (t.weightSizeMax - t.weightSizeMin) * nweight);\r\n      } else {\r\n        // min textHeight of 1\r\n        this.textHeight = max(1, w * t.weightSize);\r\n      }\r\n    }\r\n  };\r\n  Tproto.SetShadowColourFixed = function(c,s,a) {\r\n    c.shadowColor = s;\r\n  };\r\n  Tproto.SetShadowColourAlpha = function(c,s,a) {\r\n    c.shadowColor = SetAlpha(s, a);\r\n  };\r\n  Tproto.DrawText = function(c,xoff,yoff) {\r\n    var t = this.tc, x = this.x, y = this.y, s = this.sc, i, xl;\r\n    c.globalAlpha = this.alpha;\r\n    c.fillStyle = this.colour;\r\n    t.shadow && this.SetShadowColour(c,t.shadow,this.alpha);\r\n    c.font = this.font;\r\n    x += xoff / s;\r\n    y += (yoff / s) - (this.h / 2);\r\n    for(i = 0; i < this.text.length; ++i) {\r\n      xl = x;\r\n      if('right' == t.textAlign) {\r\n        xl += this.w / 2 - this.line_widths[i];\r\n      } else if('centre' == t.textAlign) {\r\n        xl -= this.line_widths[i] / 2;\r\n      } else {\r\n        xl -= this.w / 2;\r\n      }\r\n      c.setTransform(s, 0, 0, s, s * xl, s * y);\r\n      c.fillText(this.text[i], 0, 0);\r\n      y += this.textHeight;\r\n    }\r\n  };\r\n  Tproto.DrawImage = function(c,xoff,yoff,im) {\r\n    var x = this.x, y = this.y, s = this.sc,\r\n      i = im || this.fimage, w = this.w, h = this.h, a = this.alpha,\r\n      shadow = this.shadow;\r\n    c.globalAlpha = a;\r\n    shadow && this.SetShadowColour(c,shadow,a);\r\n    x += (xoff / s) - (w / 2);\r\n    y += (yoff / s) - (h / 2);\r\n    c.setTransform(s, 0, 0, s, s * x, s * y);\r\n    c.drawImage(i, 0, 0, w, h);\r\n  };\r\n  Tproto.DrawImageIE = function(c,xoff,yoff) {\r\n    var i = this.fimage, s = this.sc,\r\n      w = i.width = this.w*s, h = i.height = this.h * s,\r\n      x = (this.x*s) + xoff - (w/2), y = (this.y*s) + yoff - (h/2);\r\n    c.setTransform(1,0,0,1,0,0);\r\n    c.globalAlpha = this.alpha;\r\n    c.drawImage(i, x, y);\r\n  };\r\n  Tproto.Calc = function(m,a) {\r\n    var pp, t = this.tc, mnb = t.minBrightness,\r\n      mxb = t.maxBrightness, r = t.max_radius;\r\n    pp = m.xform(this.position);\r\n    this.xformed = pp;\r\n    pp = Project(t, pp, t.stretchX, t.stretchY);\r\n    this.x = pp.x;\r\n    this.y = pp.y;\r\n    this.z = pp.z;\r\n    this.sc = pp.w;\r\n    this.alpha = a * Clamp(mnb + (mxb - mnb) * (r - this.z) / (2 * r), 0, 1);\r\n    return this.xformed;\r\n  };\r\n  Tproto.UpdateActive = function(c, xoff, yoff) {\r\n    var o = this.outline, w = this.w, h = this.h,\r\n      x = this.x - w/2, y = this.y - h/2;\r\n    o.Update(x, y, w, h, this.sc, this.z, xoff, yoff);\r\n    return o;\r\n  };\r\n  Tproto.CheckActive = function(c,xoff,yoff) {\r\n    var t = this.tc, o = this.UpdateActive(c, xoff, yoff);\r\n    return o.Active(c, t.mx, t.my) ? o : null;\r\n  };\r\n  Tproto.Clicked = function(e) {\r\n    var a = this.a, t = a.target, h = a.href, evt;\r\n    if(t != '' && t != '_self') {\r\n      if(self.frames[t]) {\r\n        self.frames[t].document.location = h;\r\n      } else{\r\n        try {\r\n          if(top.frames[t]) {\r\n            top.frames[t].document.location = h;\r\n            return;\r\n          }\r\n        } catch(err) {\r\n          // different domain/port/protocol?\r\n        }\r\n        window.open(h, t);\r\n      }\r\n      return;\r\n    }\r\n    if(doc.createEvent) {\r\n      evt = doc.createEvent('MouseEvents');\r\n      evt.initMouseEvent('click', 1, 1, window, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, null);\r\n      if(!a.dispatchEvent(evt))\r\n        return;\r\n    } else if(a.fireEvent) {\r\n      if(!a.fireEvent('onclick'))\r\n        return;\r\n    }\r\n    doc.location = h;\r\n  };\r\n  Tproto.StopAudio = function() {\r\n    this.audio && this.playing && this.audio.pause();\r\n    this.stopped = 1;\r\n    this.playing = 0;\r\n  };\r\n  Tproto.PlayAudio = function() {\r\n    if(audio === 'off' || this.tc.audioOff)\r\n      return;\r\n    if(!audio && !SetupAudio())\r\n      return;\r\n  \r\n    var a = this.tc.audio, g = this.tc.gain, sus = 'suspended', p;\r\n    if(this.audio) {\r\n      if(!this.track) {\r\n        this.track = audio.createMediaElementSource(this.audio);\r\n        this.gain = audio.createGain();\r\n        this.track.connect(this.gain);\r\n        this.gain.connect(audio.destination);\r\n      }\r\n      a = this.audio;\r\n      g = this.gain;\r\n      if(!a.paused)\r\n        return 1;\r\n    }\r\n  \r\n    if(a) {\r\n      if(audio.state == sus)\r\n        audio.resume();\r\n      if(audio.state == sus)\r\n        return;\r\n  \r\n      g.gain.value = min(2, max(0, this.tc.audioVolume * 1));\r\n      a.currentTime = 0;\r\n      this.stopped = 0;\r\n      p = a.play();\r\n      if(p !== undefined) {\r\n        p.then(r => {\r\n          this.stopped ? this.audio.pause() : this.playing = 1;\r\n        });\r\n      }\r\n      return 1;\r\n    }\r\n  };\r\n  /**\r\n   * @constructor\r\n   */\r\n  function TagCanvas(cid,lctr,opt) {\r\n    var i, p, c = doc.getElementById(cid), cp = ['id','class','innerHTML'];\r\n  \r\n    if(!c) throw 0;\r\n    if(Defined(window.G_vmlCanvasManager)) {\r\n      c = window.G_vmlCanvasManager.initElement(c);\r\n      this.ie = parseFloat(navigator.appVersion.split('MSIE')[1]);\r\n    }\r\n    if(c && (!c.getContext || !c.getContext('2d').fillText)) {\r\n      p = doc.createElement('DIV');\r\n      for(i = 0; i < cp.length; ++i)\r\n        p[cp[i]] = c[cp[i]];\r\n      c.parentNode.insertBefore(p,c);\r\n      c.parentNode.removeChild(c);\r\n      throw 0;\r\n    }\r\n    for(i in TagCanvas.options)\r\n      this[i] = opt && Defined(opt[i]) ? opt[i] : \r\n        (Defined(TagCanvas[i]) ? TagCanvas[i] : TagCanvas.options[i]);\r\n  \r\n    this.canvas = c;\r\n    this.ctxt = c.getContext('2d');\r\n    this.z1 = 250 / max(this.depth, 0.001);\r\n    this.z2 = this.z1 / this.zoom;\r\n    this.radius = min(c.height, c.width) * 0.0075; // fits radius of 100 in canvas\r\n    this.max_radius = 100;\r\n    this.max_weight = [];\r\n    this.min_weight = [];\r\n    this.textFont = this.textFont && FixFont(this.textFont);\r\n    this.textHeight *= 1;\r\n    this.imageRadius = this.imageRadius.toString();\r\n    this.pulsateTo = Clamp(this.pulsateTo, 0, 1);\r\n    this.minBrightness = Clamp(this.minBrightness, 0, 1);\r\n    this.maxBrightness = Clamp(this.maxBrightness, this.minBrightness, 1);\r\n    this.ctxt.textBaseline = 'top';\r\n    this.lx = (this.lock + '').indexOf('x') + 1;\r\n    this.ly = (this.lock + '').indexOf('y') + 1;\r\n    this.frozen = this.dx = this.dy = this.fixedAnim = this.touchState = 0;\r\n    this.fixedAlpha = 1;\r\n    this.source = lctr || cid;\r\n    this.repeatTags = min(64, ~~this.repeatTags);\r\n    this.minTags = min(200, ~~this.minTags);\r\n    if(~~this.scrollPause > 0)\r\n      TagCanvas.scrollPause = ~~this.scrollPause;\r\n    else\r\n      this.scrollPause = 0;\r\n    if(this.minTags > 0 && this.repeatTags < 1 && (i = this.GetTags().length))\r\n      this.repeatTags = ceil(this.minTags / i) - 1;\r\n    this.transform = Matrix.Identity();\r\n    this.startTime = this.time = TimeNow();\r\n    this.mx = this.my = -1;\r\n    this.centreImage && CentreImage(this);\r\n    this.Animate = this.dragControl ? this.AnimateDrag : this.AnimatePosition;\r\n    this.animTiming = (typeof TagCanvas[this.animTiming] == 'function' ?\r\n      TagCanvas[this.animTiming] : TagCanvas.Smooth);\r\n    if(this.shadowBlur || this.shadowOffset[0] || this.shadowOffset[1]) {\r\n      // let the browser translate \"red\" into \"#ff0000\"\r\n      this.ctxt.shadowColor = this.shadow;\r\n      this.shadow = this.ctxt.shadowColor;\r\n      this.shadowAlpha = ShadowAlphaBroken();\r\n    } else {\r\n      delete this.shadow;\r\n    }\r\n    if(this.activeAudio === false) {\r\n      audio = 'off';\r\n    } else {\r\n      this.activeAudio && this.LoadAudio();\r\n    }\r\n    this.Load();\r\n    if(lctr && this.hideTags) {\r\n      (function(t) {\r\n      if(TagCanvas.loaded)\r\n        t.HideTags();\r\n      else\r\n        AddHandler('load', function() { t.HideTags(); }, window);\r\n      })(this);\r\n    }\r\n  \r\n    this.yaw = this.initial ? this.initial[0] * this.maxSpeed : 0;\r\n    this.pitch = this.initial ? this.initial[1] * this.maxSpeed : 0;\r\n    if(this.tooltip) {\r\n      this.ctitle = c.title;\r\n      c.title = '';\r\n      if(this.tooltip == 'native') {\r\n        this.Tooltip = this.TooltipNative;\r\n      } else {\r\n        this.Tooltip = this.TooltipDiv;\r\n        if(!this.ttdiv) {\r\n          this.ttdiv = doc.createElement('div');\r\n          this.ttdiv.className = this.tooltipClass;\r\n          this.ttdiv.style.position = 'absolute';\r\n          this.ttdiv.style.zIndex = c.style.zIndex + 1;\r\n          AddHandler('mouseover',function(e){e.target.style.display='none';},this.ttdiv);\r\n          doc.body.appendChild(this.ttdiv);\r\n        }\r\n      }\r\n    } else {\r\n      this.Tooltip = this.TooltipNone;\r\n    }\r\n    if(!this.noMouse && !handlers[cid]) {\r\n      handlers[cid] = [\r\n        ['mousemove', MouseMove],\r\n        ['mouseout', MouseOut],\r\n        ['mouseup', MouseUp],\r\n        ['touchstart', TouchDown],\r\n        ['touchend', TouchUp],\r\n        ['touchcancel', TouchUp],\r\n        ['touchmove', TouchMove]\r\n      ];\r\n      if(this.dragControl) {\r\n        handlers[cid].push(['mousedown', MouseDown]);\r\n        handlers[cid].push(['selectstart', Nop]);\r\n      }\r\n      if(this.wheelZoom) {\r\n        handlers[cid].push(['mousewheel', MouseWheel]);\r\n        handlers[cid].push(['DOMMouseScroll', MouseWheel]);\r\n      }\r\n      if(this.scrollPause) {\r\n        handlers[cid].push(['scroll', Scroll, window]);\r\n      }\r\n      for(i = 0; i < handlers[cid].length; ++i) {\r\n        p = handlers[cid][i];\r\n        AddHandler(p[0], p[1], p[2] ? p[2] : c);\r\n      }\r\n    }\r\n    if(!TagCanvas.started) {\r\n      TagCanvas.NextFrame = window.requestAnimationFrame ? NextFrameRAF :\r\n        NextFrameTimeout;\r\n      TagCanvas.interval = this.interval;\r\n      TagCanvas.NextFrame(this.interval);\r\n      TagCanvas.started = 1;\r\n    }\r\n  }\r\n  TCproto = TagCanvas.prototype;\r\n  TCproto.SourceElements = function() {\r\n    if(doc.querySelectorAll)\r\n      return doc.querySelectorAll('#' + this.source);\r\n    return [doc.getElementById(this.source)];\r\n  };\r\n  TCproto.HideTags = function() {\r\n    var el = this.SourceElements(), i;\r\n    for(i = 0; i < el.length; ++i)\r\n      el[i].style.display = 'none';\r\n  };\r\n  TCproto.GetTags = function() {\r\n    var el = this.SourceElements(), etl, tl = [], i, j, k;\r\n    for(k = 0; k <= this.repeatTags; ++k) {\r\n      for(i = 0; i < el.length; ++i) {\r\n        etl = el[i].getElementsByTagName('a');\r\n        for(j = 0; j < etl.length; ++j) {\r\n          tl.push(etl[j]);\r\n        }\r\n      }\r\n    }\r\n    return tl;\r\n  };\r\n  TCproto.Message = function(text) {\r\n    var tl = [], i, p, tc = text.split(''), a, t, x, z;\r\n    for(i = 0; i < tc.length; ++i) {\r\n      if(tc[i] != ' ') {\r\n        p = i - tc.length / 2;\r\n        a = doc.createElement('A');\r\n        a.href = '#';\r\n        a.innerText = tc[i];\r\n        x = 100 * sin(p / 9);\r\n        z = -100 * cos(p / 9);\r\n        t = new Tag(this, tc[i], a, [x,0,z], 2, 18, '#000', '#fff', 0, 0, 0,\r\n          'monospace', 2, tc[i]);\r\n        t.Init();\r\n        tl.push(t);\r\n      }\r\n    }\r\n    return tl;\r\n  };\r\n  TCproto.AddAudio = function(e, t) {\r\n    if(audio === 'off')\r\n      return;\r\n    var au = e.getElementsByTagName('audio');\r\n    if(au.length) {\r\n      t.SetAudio(au[0]);\r\n      this.hasAudio = 1;\r\n    }\r\n  };\r\n  TCproto.CreateTag = function(e) {\r\n    var im, i, t, txt, ts, font, bc, boc, p = [0, 0, 0], au;\r\n    if('text' != this.imageMode) {\r\n      im = e.getElementsByTagName('img');\r\n      if(im.length) {\r\n        i = new Image;\r\n        i.src = im[0].src;\r\n  \r\n        if(!this.imageMode) {\r\n          t = new Tag(this, \"\", e, p, 0, 0);\r\n          t.SetImage(i);\r\n          //t.Init();\r\n          AddImage(i, im[0], im[1], t, this);\r\n          this.AddAudio(e, t);\r\n          return t;\r\n        }\r\n      }\r\n    }\r\n    if('image' != this.imageMode) {\r\n      ts = new TextSplitter(e);\r\n      txt = ts.Lines();\r\n      if(!ts.Empty()) {\r\n        font = this.textFont || FixFont(GetProperty(e,'font-family'));\r\n        if(this.splitWidth)\r\n          txt = ts.SplitWidth(this.splitWidth, this.ctxt, font, this.textHeight);\r\n  \r\n        bc = this.bgColour == 'tag' ? GetProperty(e, 'background-color') :\r\n          this.bgColour;\r\n        boc = this.bgOutline == 'tag' ? GetProperty(e, 'color') : this.bgOutline;\r\n      } else {\r\n        ts = null;\r\n      }\r\n    }\r\n    if(ts || i) {\r\n      t = new Tag(this, txt, e, p, 2, this.textHeight + 2,\r\n        this.textColour || GetProperty(e,'color'), bc, this.bgRadius,\r\n        boc, this.bgOutlineThickness, font, this.padding, ts && ts.original);\r\n      if(i) {\r\n        t.SetImage(i);\r\n        AddImage(i, im[0], im[1], t, this);\r\n      } else {\r\n        t.Init();\r\n      }\r\n      this.AddAudio(e, t);\r\n      return t;\r\n    }\r\n  };\r\n  TCproto.UpdateTag = function(t, a) {\r\n    var colour = this.textColour || GetProperty(a, 'color'),\r\n      font = this.textFont || FixFont(GetProperty(a, 'font-family')),\r\n      bc = this.bgColour == 'tag' ? GetProperty(a, 'background-color') :\r\n        this.bgColour, boc = this.bgOutline == 'tag' ? GetProperty(a, 'color') :\r\n        this.bgOutline;\r\n    t.a = a;\r\n    t.title = a.title;\r\n    if(t.colour != colour || t.textFont != font || t.bgColour != bc ||\r\n      t.bgOutline != boc)\r\n      t.SetFont(font, colour, bc, boc);\r\n  };\r\n  TCproto.Weight = function(tl) {\r\n    var ll = tl.length, w, i, s, weights = [], valid,\r\n      wfrom = this.weightFrom ? this.weightFrom.split(/[, ]/) : [null],\r\n      wl = wfrom.length;\r\n    for(i = 0; i < ll; ++i) {\r\n      weights[i] = [];\r\n      for(s = 0; s < wl; ++s) {\r\n        w = FindWeight(tl[i].a, wfrom[s], this.textHeight);\r\n        if(!this.max_weight[s] || w > this.max_weight[s])\r\n          this.max_weight[s] = w;\r\n        if(!this.min_weight[s] || w < this.min_weight[s])\r\n          this.min_weight[s] = w;\r\n        weights[i][s] = w;\r\n      }\r\n    }\r\n    for(s = 0; s < wl; ++s) {\r\n      if(this.max_weight[s] > this.min_weight[s])\r\n        valid = 1;\r\n    }\r\n    if(valid) {\r\n      for(i = 0; i < ll; ++i) {\r\n        tl[i].SetWeight(weights[i]);\r\n      }\r\n    }\r\n  };\r\n  TCproto.Load = function() {\r\n    var tl = this.GetTags(), taglist = [], shape, t,\r\n      shapeArgs, rx, ry, rz, vl, i, tagmap = [], pfuncs = {\r\n        sphere: PointsOnSphere,\r\n        vcylinder: PointsOnCylinderV,\r\n        hcylinder: PointsOnCylinderH,\r\n        vring: PointsOnRingV,\r\n        hring: PointsOnRingH\r\n      };\r\n  \r\n    if(tl.length) {\r\n      tagmap.length = tl.length;\r\n      for(i = 0; i < tl.length; ++i)\r\n        tagmap[i] = i;\r\n      this.shuffleTags && Shuffle(tagmap);\r\n      rx = 100 * this.radiusX;\r\n      ry = 100 * this.radiusY;\r\n      rz = 100 * this.radiusZ;\r\n      this.max_radius = max(rx, max(ry, rz));\r\n  \r\n      for(i = 0; i < tl.length; ++i) {\r\n        t = this.CreateTag(tl[tagmap[i]]);\r\n        if(t)\r\n          taglist.push(t);\r\n      }\r\n      this.weight && this.Weight(taglist, true);\r\n    \r\n      if(this.shapeArgs) {\r\n        this.shapeArgs[0] = taglist.length;\r\n      } else {\r\n        shapeArgs = this.shape.toString().split(/[(),]/);\r\n        shape = shapeArgs.shift();\r\n        if(typeof window[shape] === 'function')\r\n          this.shape = window[shape];\r\n        else\r\n          this.shape = pfuncs[shape] || pfuncs.sphere;\r\n        this.shapeArgs = [taglist.length, rx, ry, rz].concat(shapeArgs);\r\n      }\r\n      vl = this.shape.apply(this, this.shapeArgs);\r\n      this.listLength = taglist.length;\r\n      for(i = 0; i < taglist.length; ++i)\r\n        taglist[i].position = new Vector(vl[i][0], vl[i][1], vl[i][2]);\r\n    }\r\n    if(this.noTagsMessage && !taglist.length) {\r\n      i = (this.imageMode && this.imageMode != 'both' ? this.imageMode + ' ': '');\r\n      taglist = this.Message('No ' + i + 'tags');\r\n    }\r\n    this.taglist = taglist;\r\n  };\r\n  TCproto.Update = function() {\r\n    var tl = this.GetTags(), newlist = [],\r\n      taglist = this.taglist, found,\r\n      added = [], removed = [], vl, ol, nl, i, j;\r\n  \r\n    if(!this.shapeArgs)\r\n      return this.Load();\r\n  \r\n    if(tl.length) {\r\n      nl = this.listLength = tl.length;\r\n      ol = taglist.length;\r\n  \r\n      // copy existing list, populate \"removed\"\r\n      for(i = 0; i < ol; ++i) {\r\n        newlist.push(taglist[i]);\r\n        removed.push(i);\r\n      }\r\n  \r\n      // find added and removed tags\r\n      for(i = 0; i < nl; ++i) {\r\n        for(j = 0, found = 0; j < ol; ++j) {\r\n          if(taglist[j].EqualTo(tl[i])) {\r\n            this.UpdateTag(newlist[j], tl[i]);\r\n            found = removed[j] = -1;\r\n          }\r\n        }\r\n        if(!found)\r\n          added.push(i);\r\n      }\r\n  \r\n      // clean out found tags from removed list\r\n      for(i = 0, j = 0; i < ol; ++i) {\r\n        if(removed[j] == -1)\r\n          removed.splice(j,1);\r\n        else\r\n          ++j;\r\n      }\r\n  \r\n      // insert new tags in gaps where old tags removed\r\n      if(removed.length) {\r\n        Shuffle(removed);\r\n        while(removed.length && added.length) {\r\n          i = removed.shift();\r\n          j = added.shift();\r\n          newlist[i] = this.CreateTag(tl[j]);\r\n        }\r\n  \r\n        // remove any more (in reverse order)\r\n        removed.sort(function(a,b) {return a-b});\r\n        while(removed.length) {\r\n          newlist.splice(removed.pop(), 1);\r\n        }\r\n      }\r\n  \r\n      // add any extra tags\r\n      j = newlist.length / (added.length + 1);\r\n      i = 0;\r\n      while(added.length) {\r\n        newlist.splice(ceil(++i * j), 0, this.CreateTag(tl[added.shift()]));\r\n      }\r\n  \r\n      // assign correct positions to tags\r\n      this.shapeArgs[0] = nl = newlist.length;\r\n      vl = this.shape.apply(this, this.shapeArgs);\r\n      for(i = 0; i < nl; ++i)\r\n        newlist[i].position = new Vector(vl[i][0], vl[i][1], vl[i][2]);\r\n  \r\n      // reweight tags\r\n      this.weight && this.Weight(newlist);\r\n    }\r\n    this.taglist = newlist;\r\n  };\r\n  TCproto.SetShadow = function(c) {\r\n    c.shadowBlur = this.shadowBlur;\r\n    c.shadowOffsetX = this.shadowOffset[0];\r\n    c.shadowOffsetY = this.shadowOffset[1];\r\n  };\r\n  TCproto.LoadAudio = function() {\r\n    if(!audio && !SetupAudio())\r\n      return;\r\n    this.audio = doc.createElement('audio');\r\n    this.audio.src = this.activeAudio;\r\n    this.track = audio.createMediaElementSource(this.audio);\r\n    this.gain = audio.createGain();\r\n    this.track.connect(this.gain);\r\n    this.gain.connect(audio.destination);\r\n    this.hasAudio = 1;\r\n    audioClick = function(e) {\r\n      audio.resume();\r\n      doc.removeEventListener('click', audioClick);\r\n    };\r\n    doc.addEventListener('click', audioClick);\r\n  };\r\n  TCproto.ShowAudioIcon = function() {\r\n    var s = this.audioIconSize, cv = this.canvas, c = this.ctxt,\r\n      x = cv.width - s - 3, y = cv.height - s - 3, t = this.audioIconThickness,\r\n      c1 = '#000', c2 = '#fff', d = this.audioIconDark, muted = this.audioOff,\r\n      sus = 'suspended';\r\n    if(!audio)\r\n      return;\r\n    if(!muted)\r\n      muted = (audio.state === sus);\r\n  \r\n    if(this.audioIcon && this.hasAudio) {\r\n      AudioIcon(muted,c,s,x,y,t+1,d ? c2 : c1);\r\n      AudioIcon(muted,c,s,x,y,t,d ? c1 : c2);\r\n    }\r\n  };\r\n  TCproto.CheckAudioIcon = function() {\r\n    var s = this.audioIconSize, cv = this.canvas, t = this.audioIconThickness / 2,\r\n      x = cv.width - s - 3 - t, y = cv.height - s - 3 - t;\r\n    if(this.audioIcon && this.mx >= x && this.my >= y)\r\n      return true;\r\n  };\r\n  TCproto.ToggleAudio = function() {\r\n    var on = this.audioOff || (audio && audio.state === 'suspended');\r\n    on || this.currentAudio && this.currentAudio.StopAudio();\r\n    this.audioOff = !on;\r\n  };\r\n  TCproto.Draw = function(t) {\r\n    if(this.paused)\r\n      return;\r\n    var cv = this.canvas, cw = cv.width, ch = cv.height, max_sc = 0,\r\n      tdelta = (t - this.time) * TagCanvas.interval / 1000,\r\n      x = cw / 2 + this.offsetX, y = ch / 2 + this.offsetY, c = this.ctxt,\r\n      active, a, i, aindex = -1, tl = this.taglist, l = tl.length,\r\n      last = this.active && this.active.tag, cursor = '',\r\n      frontsel = this.frontSelect, centreDrawn = (this.centreFunc == Nop), fixed;\r\n    this.time = t;\r\n    if(this.frozen && this.drawn)\r\n      return this.Animate(cw,ch,tdelta);\r\n    fixed = this.AnimateFixed();\r\n    c.setTransform(1,0,0,1,0,0);\r\n    for(i = 0; i < l; ++i)\r\n      tl[i].Calc(this.transform, this.fixedAlpha);\r\n    tl = SortList(tl, function(a,b) {return b.z-a.z});\r\n    \r\n    if(fixed && this.fixedAnim.active) {\r\n      active = this.fixedAnim.tag.UpdateActive(c, x, y);\r\n    } else {\r\n      this.active = null;\r\n      if(this.CheckAudioIcon()) {\r\n        cursor = 'pointer';\r\n      } else {\r\n        for(i = 0; i < l; ++i) {\r\n          a = this.mx >= 0 && this.my >= 0 && this.taglist[i].CheckActive(c, x, y);\r\n          if(a && a.sc > max_sc && (!frontsel || a.z <= 0)) {\r\n            active = a;\r\n            aindex = i;\r\n            active.tag = this.taglist[i];\r\n            max_sc = a.sc;\r\n          }\r\n        }\r\n        this.active = active;\r\n      }\r\n    }\r\n  \r\n    this.txtOpt || (this.shadow && this.SetShadow(c));\r\n    c.clearRect(0,0,cw,ch);\r\n    for(i = 0; i < l; ++i) {\r\n      if(!centreDrawn && tl[i].z <= 0) {\r\n        // run the centreFunc if the next tag is at the front\r\n        try { this.centreFunc(c, cw, ch, x, y); }\r\n        catch(e) {\r\n          alert(e);\r\n          // don't run it again\r\n          this.centreFunc = Nop;\r\n        }\r\n        centreDrawn = true;\r\n      }\r\n  \r\n      if(!(active && active.tag == tl[i] && active.PreDraw(c, tl[i], x, y)))\r\n        tl[i].Draw(c, x, y);\r\n      active && active.tag == tl[i] && active.PostDraw(c);\r\n    }\r\n    if(this.freezeActive && active) {\r\n      this.Freeze();\r\n    } else {\r\n      this.UnFreeze();\r\n      this.drawn = (l == this.listLength);\r\n    }\r\n    if(this.fixedCallback) {\r\n      this.fixedCallback(this,this.fixedCallbackTag);\r\n      this.fixedCallback = null;\r\n    }\r\n    fixed || this.Animate(cw, ch, tdelta);\r\n    if(active) {\r\n      active.LastDraw(c);\r\n      if(active.tag != last) {\r\n        this.currentAudio && this.currentAudio != active.tag && this.currentAudio.StopAudio();\r\n        if(active.tag.PlayAudio())\r\n          this.currentAudio = active.tag;\r\n      }\r\n      cursor = this.activeCursor;\r\n    }\r\n    cv.style.cursor = cursor;\r\n    this.Tooltip(active,this.taglist[aindex]);\r\n    this.audioIcon && this.ShowAudioIcon();\r\n  };\r\n  TCproto.TooltipNone = function() { };\r\n  TCproto.TooltipNative = function(active,tag) {\r\n    if(active)\r\n      this.canvas.title = tag && tag.title ? tag.title : '';\r\n    else\r\n      this.canvas.title = this.ctitle;\r\n  };\r\n  TCproto.SetTTDiv = function(title, tag) {\r\n    var tc = this, s = tc.ttdiv.style;\r\n    if(title != tc.ttdiv.innerHTML)\r\n      s.display = 'none';\r\n    tc.ttdiv.innerHTML = title;\r\n    tag && (tag.title = tc.ttdiv.innerHTML);\r\n    if(s.display == 'none' && ! tc.tttimer) {\r\n      tc.tttimer = setTimeout(function() {\r\n        var p = AbsPos(tc.canvas.id);\r\n        s.display = 'block';\r\n        s.left = p.x + tc.mx + 'px';\r\n        s.top = p.y + tc.my + 24 + 'px';\r\n        tc.tttimer = null;\r\n      }, tc.tooltipDelay);\r\n    }\r\n  };\r\n  TCproto.TooltipDiv = function(active,tag) {\r\n    if(active && tag && tag.title) {\r\n      this.SetTTDiv(tag.title, tag);\r\n    } else if(!active && this.mx != -1 && this.my != -1 && this.ctitle.length) {\r\n      this.SetTTDiv(this.ctitle);\r\n    } else {\r\n      this.ttdiv.style.display = 'none';\r\n    }\r\n  };\r\n  TCproto.Transform = function(tc, p, y) {\r\n    if(p || y) {\r\n      var sp = sin(p), cp = cos(p), sy = sin(y), cy = cos(y),\r\n        ym = new Matrix([cy,0,sy, 0,1,0, -sy,0,cy]),\r\n        pm = new Matrix([1,0,0, 0,cp,-sp, 0,sp,cp]);\r\n      tc.transform = tc.transform.mul(ym.mul(pm));\r\n    }\r\n  };\r\n  TCproto.AnimateFixed = function() {\r\n    var fa, t1, angle, m, d;\r\n    if(this.fadeIn) {\r\n      t1 = TimeNow() - this.startTime;\r\n      if(t1 >= this.fadeIn) {\r\n        this.fadeIn = 0;\r\n        this.fixedAlpha = 1;\r\n      } else {\r\n        this.fixedAlpha = t1 / this.fadeIn;\r\n      }\r\n    }\r\n    if(this.fixedAnim) {\r\n      if(!this.fixedAnim.transform)\r\n        this.fixedAnim.transform = this.transform;\r\n      fa = this.fixedAnim, t1 = TimeNow() - fa.t0, angle = fa.angle,\r\n        m, d = this.animTiming(fa.t, t1);\r\n      this.transform = fa.transform;\r\n      if(t1 >= fa.t) {\r\n        this.fixedCallbackTag = fa.tag;\r\n        this.fixedCallback = fa.cb;\r\n        this.fixedAnim = this.yaw = this.pitch = 0;\r\n      } else {\r\n        angle *= d;\r\n      }\r\n      m = Matrix.Rotation(angle, fa.axis);\r\n      this.transform = this.transform.mul(m);\r\n      return (this.fixedAnim != 0);\r\n    }\r\n    return false;\r\n  };\r\n  TCproto.AnimatePosition = function(w, h, t) {\r\n    var tc = this, x = tc.mx, y = tc.my, s, r;\r\n    if(!tc.frozen && x >= 0 && y >= 0 && x < w && y < h) {\r\n      s = tc.maxSpeed, r = tc.reverse ? -1 : 1;\r\n      tc.lx || (tc.yaw = ((x * 2 * s / w) - s) * r * t);\r\n      tc.ly || (tc.pitch = ((y * 2 * s / h) - s) * -r * t);\r\n      tc.initial = null;\r\n    } else if(!tc.initial) {\r\n      if(tc.frozen && !tc.freezeDecel)\r\n        tc.yaw = tc.pitch = 0;\r\n      else\r\n        tc.Decel(tc);\r\n    }\r\n    this.Transform(tc, tc.pitch, tc.yaw);\r\n  };\r\n  TCproto.AnimateDrag = function(w, h, t) {\r\n    var tc = this, rs = 100 * t * tc.maxSpeed / tc.max_radius / tc.zoom;\r\n    if(tc.dx || tc.dy) {\r\n      tc.lx || (tc.yaw = tc.dx * rs / tc.stretchX);\r\n      tc.ly || (tc.pitch = tc.dy * -rs / tc.stretchY);\r\n      tc.dx = tc.dy = 0;\r\n      tc.initial = null;\r\n    } else if(!tc.initial) {\r\n      tc.Decel(tc);\r\n    }\r\n    this.Transform(tc, tc.pitch, tc.yaw);\r\n  };\r\n  TCproto.Freeze = function() {\r\n    if(!this.frozen) {\r\n      this.preFreeze = [this.yaw, this.pitch];\r\n      this.frozen = 1;\r\n      this.drawn = 0;\r\n    }\r\n  };\r\n  TCproto.UnFreeze = function() {\r\n    if(this.frozen) {\r\n      this.yaw = this.preFreeze[0];\r\n      this.pitch = this.preFreeze[1];\r\n      this.frozen = 0;\r\n    }\r\n  };\r\n  TCproto.Decel = function(tc) {\r\n    var s = tc.minSpeed, ay = abs(tc.yaw), ap = abs(tc.pitch);\r\n    if(!tc.lx && ay > s)\r\n      tc.yaw = ay > tc.z0 ? tc.yaw * tc.decel : 0;\r\n    if(!tc.ly && ap > s)\r\n      tc.pitch = ap > tc.z0 ? tc.pitch * tc.decel : 0;\r\n  };\r\n  TCproto.Zoom = function(r) {\r\n    this.z2 = this.z1 * (1/r);\r\n    this.drawn = 0;\r\n  };\r\n  TCproto.Clicked = function(e) {\r\n    if(this.CheckAudioIcon()) {\r\n      this.ToggleAudio();\r\n      return;\r\n    }\r\n    var a = this.active;\r\n    try {\r\n      if(a && a.tag)\r\n        if(this.clickToFront === false || this.clickToFront === null)\r\n          a.tag.Clicked(e);\r\n        else\r\n          this.TagToFront(a.tag, this.clickToFront, function() {\r\n            a.tag.Clicked(e);\r\n          }, true);\r\n    } catch(ex) {\r\n    }\r\n  };\r\n  TCproto.Wheel = function(i) {\r\n    var z = this.zoom + this.zoomStep * (i ? 1 : -1);\r\n    this.zoom = min(this.zoomMax,max(this.zoomMin,z));\r\n    this.Zoom(this.zoom);\r\n  };\r\n  TCproto.BeginDrag = function(e) {\r\n    this.down = EventXY(e, this.canvas);\r\n    e.cancelBubble = true;\r\n    e.returnValue = false;\r\n    e.preventDefault && e.preventDefault();\r\n  };\r\n  TCproto.Drag = function(e, p) {\r\n    if(this.dragControl && this.down) {\r\n      var t2 = this.dragThreshold * this.dragThreshold,\r\n        dx = p.x - this.down.x, dy = p.y - this.down.y;\r\n      if(this.dragging || dx * dx + dy * dy > t2) {\r\n        this.dx = dx;\r\n        this.dy = dy;\r\n        this.dragging = 1;\r\n        this.down = p;\r\n      }\r\n    }\r\n    return this.dragging;\r\n  };\r\n  TCproto.EndDrag = function() {\r\n    var res = this.dragging;\r\n    this.dragging = this.down = null;\r\n    return res;\r\n  };\r\n  function PinchDistance(e) {\r\n    var t1 = e.targetTouches[0], t2 = e.targetTouches[1];\r\n    return sqrt(pow(t2.pageX - t1.pageX, 2) + pow(t2.pageY - t1.pageY, 2));\r\n  }\r\n  TCproto.BeginPinch = function(e) {\r\n    this.pinched = [PinchDistance(e), this.zoom];\r\n    e.preventDefault && e.preventDefault();\r\n  };\r\n  TCproto.Pinch = function(e) {\r\n    var z, d, p = this.pinched;\r\n    if(!p)\r\n      return;\r\n    d = PinchDistance(e);\r\n    z = p[1] * d / p[0];\r\n    this.zoom = min(this.zoomMax,max(this.zoomMin,z));\r\n    this.Zoom(this.zoom);\r\n  };\r\n  TCproto.EndPinch = function(e) {\r\n    this.pinched = null;\r\n  };\r\n  TCproto.Pause = function() { this.paused = true; };\r\n  TCproto.Resume = function() { this.paused = false; };\r\n  TCproto.SetSpeed = function(i) {\r\n    this.initial = i;\r\n    this.yaw = i[0] * this.maxSpeed;\r\n    this.pitch = i[1] * this.maxSpeed;\r\n  };\r\n  TCproto.FindTag = function(t) {\r\n    if(!Defined(t))\r\n      return null;\r\n    Defined(t.index) && (t = t.index);\r\n    if(!IsObject(t))\r\n      return this.taglist[t];\r\n    var srch, tgt, i;\r\n    if(Defined(t.id))\r\n      srch = 'id', tgt = t.id;\r\n    else if(Defined(t.text))\r\n      srch = 'innerText', tgt = t.text;\r\n  \r\n    for(i = 0; i < this.taglist.length; ++i)\r\n      if(this.taglist[i].a[srch] == tgt)\r\n        return this.taglist[i];\r\n  };\r\n  TCproto.RotateTag = function(tag, lt, lg, time, callback, active) {\r\n    var t = tag.Calc(this.transform, 1), v1 = new Vector(t.x, t.y, t.z),\r\n      v2 = MakeVector(lg, lt), angle = v1.angle(v2), u = v1.cross(v2).unit();\r\n    if(angle == 0) {\r\n      this.fixedCallbackTag = tag;\r\n      this.fixedCallback = callback;\r\n    } else {\r\n      this.fixedAnim = {\r\n        angle: -angle,\r\n        axis: u,\r\n        t: time,\r\n        t0: TimeNow(),\r\n        cb: callback,\r\n        tag: tag,\r\n        active: active\r\n      };\r\n    }\r\n  };\r\n  TCproto.TagToFront = function(tag, time, callback, active) {\r\n    this.RotateTag(tag, 0, 0, time, callback, active);\r\n  };\r\n  TCproto.Volume = function(vol) {\r\n    this.audioVolume = vol * 1;\r\n  };\r\n  TagCanvas.Start = function(id,l,o) {\r\n    TagCanvas.Delete(id);\r\n    TagCanvas.tc[id] = new TagCanvas(id,l,o);\r\n  };\r\n  function tccall(f,id) {\r\n    TagCanvas.tc[id] && TagCanvas.tc[id][f]();\r\n  }\r\n  TagCanvas.Linear = function(t, t0) { return t0 / t; }\r\n  TagCanvas.Smooth = function(t, t0) { return 0.5 - cos(t0 * Math.PI / t) / 2; }\r\n  TagCanvas.Pause = function(id) { tccall('Pause',id); };\r\n  TagCanvas.Resume = function(id) { tccall('Resume',id); };\r\n  TagCanvas.Reload = function(id) { tccall('Load',id); };\r\n  TagCanvas.Update = function(id) { tccall('Update',id); };\r\n  TagCanvas.SetSpeed = function(id, speed) {\r\n    if(IsObject(speed) && TagCanvas.tc[id] &&\r\n      !isNaN(speed[0]) && !isNaN(speed[1])) {\r\n      TagCanvas.tc[id].SetSpeed(speed);\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n  TagCanvas.TagToFront = function(id, options) {\r\n    if(!IsObject(options))\r\n      return false;\r\n    options.lat = options.lng = 0;\r\n    return TagCanvas.RotateTag(id, options);\r\n  };\r\n  TagCanvas.RotateTag = function(id, options) {\r\n    if(IsObject(options) && TagCanvas.tc[id]) {\r\n      if(isNaN(options.time))\r\n        options.time = 500;\r\n      var tt = TagCanvas.tc[id].FindTag(options);\r\n      if(tt) {\r\n        TagCanvas.tc[id].RotateTag(tt, options.lat, options.lng,\r\n          options.time, options.callback, options.active);\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  };\r\n  TagCanvas.Delete = function(id) {\r\n    var i, c;\r\n    if(handlers[id]) {\r\n      c = doc.getElementById(id);\r\n      if(c) {\r\n        for(i = 0; i < handlers[id].length; ++i)\r\n          RemoveHandler(handlers[id][i][0], handlers[id][i][1], c);\r\n      }\r\n    }\r\n    delete handlers[id];\r\n    delete TagCanvas.tc[id];\r\n  };\r\n  TagCanvas.tc = {};\r\n  TagCanvas.options = {\r\n  z1: 20000,\r\n  z2: 20000,\r\n  z0: 0.0002,\r\n  freezeActive: false,\r\n  freezeDecel: false,\r\n  activeCursor: 'pointer',\r\n  pulsateTo: 1,\r\n  pulsateTime: 3,\r\n  reverse: false,\r\n  depth: 0.5,\r\n  maxSpeed: 0.05,\r\n  minSpeed: 0,\r\n  decel: 0.95,\r\n  interval: 20,\r\n  minBrightness: 0.1,\r\n  maxBrightness: 1,\r\n  outlineColour: '#ffff99',\r\n  outlineThickness: 2,\r\n  outlineOffset: 5,\r\n  outlineMethod: 'outline',\r\n  outlineRadius: 0,\r\n  textColour: '#ff99ff',\r\n  textHeight: 15,\r\n  textFont: 'Helvetica, Arial, sans-serif',\r\n  shadow: '#000',\r\n  shadowBlur: 0,\r\n  shadowOffset: [0,0],\r\n  initial: null,\r\n  hideTags: true,\r\n  zoom: 1,\r\n  weight: false,\r\n  weightMode: 'size',\r\n  weightFrom: null,\r\n  weightSize: 1,\r\n  weightSizeMin: null,\r\n  weightSizeMax: null,\r\n  weightGradient: {0:'#f00', 0.33:'#ff0', 0.66:'#0f0', 1:'#00f'},\r\n  txtOpt: true,\r\n  txtScale: 2,\r\n  frontSelect: false,\r\n  wheelZoom: true,\r\n  zoomMin: 0.3,\r\n  zoomMax: 3,\r\n  zoomStep: 0.05,\r\n  shape: 'sphere',\r\n  lock: null,\r\n  tooltip: null,\r\n  tooltipDelay: 300,\r\n  tooltipClass: 'tctooltip',\r\n  radiusX: 1,\r\n  radiusY: 1,\r\n  radiusZ: 1,\r\n  stretchX: 1,\r\n  stretchY: 1,\r\n  offsetX: 0,\r\n  offsetY: 0,\r\n  shuffleTags: false,\r\n  noSelect: false,\r\n  noMouse: false,\r\n  imageScale: 1,\r\n  paused: false,\r\n  dragControl: false,\r\n  dragThreshold: 4,\r\n  centreFunc: Nop,\r\n  splitWidth: 0,\r\n  animTiming: 'Smooth',\r\n  clickToFront: false,\r\n  fadeIn: 0,\r\n  padding: 0,\r\n  bgColour: null,\r\n  bgRadius: 0,\r\n  bgOutline: null,\r\n  bgOutlineThickness: 0,\r\n  outlineIncrease: 4,\r\n  textAlign: 'centre',\r\n  textVAlign: 'middle',\r\n  imageMode: null,\r\n  imagePosition: null,\r\n  imagePadding: 2,\r\n  imageAlign: 'centre',\r\n  imageVAlign: 'middle',\r\n  noTagsMessage: true,\r\n  centreImage: null,\r\n  pinchZoom: false,\r\n  repeatTags: 0,\r\n  minTags: 0,\r\n  imageRadius: 0,\r\n  scrollPause: false,\r\n  outlineDash: 0,\r\n  outlineDashSpace: 0,\r\n  outlineDashSpeed: 1,\r\n  activeAudio: '',\r\n  audioVolume: 1,\r\n  audioIcon: 1,\r\n  audioIconSize: 20,\r\n  audioIconThickness: 2,\r\n  audioIconDark: 0,\r\n  altImage: 0\r\n  };\r\n  for(i in TagCanvas.options) TagCanvas[i] = TagCanvas.options[i];\r\n  window.TagCanvas = TagCanvas;\r\n  jQuery.fn.tagcanvas = function(options, lctr) {\r\n    var fn = {\r\n      pause: function() {\r\n        $(this).each(function() { tccall('Pause',$(this)[0].id); });\r\n      },\r\n      resume: function() {\r\n        $(this).each(function() { tccall('Resume',$(this)[0].id); });\r\n      },\r\n      reload: function() {\r\n        $(this).each(function() { tccall('Load',$(this)[0].id); });\r\n      },\r\n      update: function() {\r\n        $(this).each(function() { tccall('Update',$(this)[0].id); });\r\n      },\r\n      tagtofront: function() {\r\n        $(this).each(function() { TagCanvas.TagToFront($(this)[0].id, lctr); });\r\n      },\r\n      rotatetag: function() {\r\n        $(this).each(function() { TagCanvas.RotateTag($(this)[0].id, lctr); });\r\n      },\r\n      'delete': function() {\r\n        $(this).each(function() { TagCanvas.Delete($(this)[0].id); });\r\n      },\r\n      setspeed: function() {\r\n        $(this).each(function() { TagCanvas.SetSpeed($(this)[0].id, lctr); });\r\n      }\r\n    };\r\n    if(typeof options == 'string' && fn[options]) {\r\n      fn[options].apply(this);\r\n      return this;\r\n    } else {\r\n      TagCanvas.jquery = 1;\r\n      $(this).each(function() { TagCanvas.Start($(this)[0].id, lctr, options); });\r\n      return TagCanvas.started;\r\n    }\r\n  };\r\n  \r\n  // set a flag for when the window has loaded\r\n  AddHandler('load',function(){TagCanvas.loaded=1},window);\r\n  })(jQuery);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}